import{r as d,b as Xa,a as Ka}from"./vendor-92c95717.js";import{u as be,L as q,a as ts,b as Et,N as zt,B as Za,R as Ya,c as ae}from"./router-905868b9.js";import{Q as S,k as er}from"./notifications-f0f08850.js";import{S as Ee,P as Ne,a as Ge,B as Ye,U as Z,C as na,b as zs,c as we,H as fs,d as Us,L as Ut,X as Se,M as sr,e as Ae,G as ze,T as Fe,F as At,f as Be,g as js,E as bs,h as ue,i as ie,j as ce,k as ge,l as Le,m as Je,n as pe,D as He,o as Ue,p as ys,q as Re,r as Qe,s as Is,t as oa,u as vs,v as ws,w as tr,x as ar,y as la,z as Ms,R as We,A as ye,I as Xs,J as rr,K as Bs,N as ia,O as ca,Q as nr,V as me,W as ht,Y as Ie,Z as lt,_ as or,$ as lr,a0 as da,a1 as gt,a2 as ir,a3 as ma,a4 as cr,a5 as It,a6 as ua,a7 as dr,a8 as xa,a9 as qs,aa as ha,ab as ps,ac as ga,ad as pt,ae as Vs,af as Gs,ag as mr,ah as ur}from"./icons-9c614846.js";import{u as Xe}from"./forms-a90f7306.js";import{l as xr}from"./socket-d9998155.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();var pa={exports:{}},Ks={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hr=d,gr=Symbol.for("react.element"),pr=Symbol.for("react.fragment"),fr=Object.prototype.hasOwnProperty,jr=hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,br={key:!0,ref:!0,__self:!0,__source:!0};function fa(s,t,a){var r,n={},l=null,o=null;a!==void 0&&(l=""+a),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)fr.call(t,r)&&!br.hasOwnProperty(r)&&(n[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:gr,type:s,key:l,ref:o,props:n,_owner:jr.current}}Ks.Fragment=pr;Ks.jsx=fa;Ks.jsxs=fa;pa.exports=Ks;var e=pa.exports,ft={},Mt=Xa;ft.createRoot=Mt.createRoot,ft.hydrateRoot=Mt.hydrateRoot;function ja(s,t){return function(){return s.apply(t,arguments)}}const{toString:yr}=Object.prototype,{getPrototypeOf:Rt}=Object,{iterator:Zs,toStringTag:ba}=Symbol,Ys=(s=>t=>{const a=yr.call(t);return s[a]||(s[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Te=s=>(s=s.toLowerCase(),t=>Ys(t)===s),et=s=>t=>typeof t===s,{isArray:as}=Array,Ns=et("undefined");function Nr(s){return s!==null&&!Ns(s)&&s.constructor!==null&&!Ns(s.constructor)&&je(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const ya=Te("ArrayBuffer");function vr(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&ya(s.buffer),t}const wr=et("string"),je=et("function"),Na=et("number"),st=s=>s!==null&&typeof s=="object",_r=s=>s===!0||s===!1,$s=s=>{if(Ys(s)!=="object")return!1;const t=Rt(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ba in s)&&!(Zs in s)},Sr=Te("Date"),Cr=Te("File"),kr=Te("Blob"),Er=Te("FileList"),Ar=s=>st(s)&&je(s.pipe),Rr=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||je(s.append)&&((t=Ys(s))==="formdata"||t==="object"&&je(s.toString)&&s.toString()==="[object FormData]"))},Tr=Te("URLSearchParams"),[Pr,Dr,$r,Fr]=["ReadableStream","Request","Response","Headers"].map(Te),Lr=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _s(s,t,{allOwnKeys:a=!1}={}){if(s===null||typeof s>"u")return;let r,n;if(typeof s!="object"&&(s=[s]),as(s))for(r=0,n=s.length;r<n;r++)t.call(null,s[r],r,s);else{const l=a?Object.getOwnPropertyNames(s):Object.keys(s),o=l.length;let i;for(r=0;r<o;r++)i=l[r],t.call(null,s[i],i,s)}}function va(s,t){t=t.toLowerCase();const a=Object.keys(s);let r=a.length,n;for(;r-- >0;)if(n=a[r],t===n.toLowerCase())return n;return null}const Ve=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis)(),wa=s=>!Ns(s)&&s!==Ve;function jt(){const{caseless:s}=wa(this)&&this||{},t={},a=(r,n)=>{const l=s&&va(t,n)||n;$s(t[l])&&$s(r)?t[l]=jt(t[l],r):$s(r)?t[l]=jt({},r):as(r)?t[l]=r.slice():t[l]=r};for(let r=0,n=arguments.length;r<n;r++)arguments[r]&&_s(arguments[r],a);return t}const Or=(s,t,a,{allOwnKeys:r}={})=>(_s(t,(n,l)=>{a&&je(n)?s[l]=ja(n,a):s[l]=n},{allOwnKeys:r}),s),zr=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),Ur=(s,t,a,r)=>{s.prototype=Object.create(t.prototype,r),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),a&&Object.assign(s.prototype,a)},Ir=(s,t,a,r)=>{let n,l,o;const i={};if(t=t||{},s==null)return t;do{for(n=Object.getOwnPropertyNames(s),l=n.length;l-- >0;)o=n[l],(!r||r(o,s,t))&&!i[o]&&(t[o]=s[o],i[o]=!0);s=a!==!1&&Rt(s)}while(s&&(!a||a(s,t))&&s!==Object.prototype);return t},Mr=(s,t,a)=>{s=String(s),(a===void 0||a>s.length)&&(a=s.length),a-=t.length;const r=s.indexOf(t,a);return r!==-1&&r===a},Br=s=>{if(!s)return null;if(as(s))return s;let t=s.length;if(!Na(t))return null;const a=new Array(t);for(;t-- >0;)a[t]=s[t];return a},qr=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Rt(Uint8Array)),Vr=(s,t)=>{const r=(s&&s[Zs]).call(s);let n;for(;(n=r.next())&&!n.done;){const l=n.value;t.call(s,l[0],l[1])}},Gr=(s,t)=>{let a;const r=[];for(;(a=s.exec(t))!==null;)r.push(a);return r},Jr=Te("HTMLFormElement"),Hr=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,n){return r.toUpperCase()+n}),Bt=(({hasOwnProperty:s})=>(t,a)=>s.call(t,a))(Object.prototype),Qr=Te("RegExp"),_a=(s,t)=>{const a=Object.getOwnPropertyDescriptors(s),r={};_s(a,(n,l)=>{let o;(o=t(n,l,s))!==!1&&(r[l]=o||n)}),Object.defineProperties(s,r)},Wr=s=>{_a(s,(t,a)=>{if(je(s)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=s[a];if(je(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Xr=(s,t)=>{const a={},r=n=>{n.forEach(l=>{a[l]=!0})};return as(s)?r(s):r(String(s).split(t)),a},Kr=()=>{},Zr=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function Yr(s){return!!(s&&je(s.append)&&s[ba]==="FormData"&&s[Zs])}const en=s=>{const t=new Array(10),a=(r,n)=>{if(st(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[n]=r;const l=as(r)?[]:{};return _s(r,(o,i)=>{const c=a(o,n+1);!Ns(c)&&(l[i]=c)}),t[n]=void 0,l}}return r};return a(s,0)},sn=Te("AsyncFunction"),tn=s=>s&&(st(s)||je(s))&&je(s.then)&&je(s.catch),Sa=((s,t)=>s?setImmediate:t?((a,r)=>(Ve.addEventListener("message",({source:n,data:l})=>{n===Ve&&l===a&&r.length&&r.shift()()},!1),n=>{r.push(n),Ve.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",je(Ve.postMessage)),an=typeof queueMicrotask<"u"?queueMicrotask.bind(Ve):typeof process<"u"&&process.nextTick||Sa,rn=s=>s!=null&&je(s[Zs]),T={isArray:as,isArrayBuffer:ya,isBuffer:Nr,isFormData:Rr,isArrayBufferView:vr,isString:wr,isNumber:Na,isBoolean:_r,isObject:st,isPlainObject:$s,isReadableStream:Pr,isRequest:Dr,isResponse:$r,isHeaders:Fr,isUndefined:Ns,isDate:Sr,isFile:Cr,isBlob:kr,isRegExp:Qr,isFunction:je,isStream:Ar,isURLSearchParams:Tr,isTypedArray:qr,isFileList:Er,forEach:_s,merge:jt,extend:Or,trim:Lr,stripBOM:zr,inherits:Ur,toFlatObject:Ir,kindOf:Ys,kindOfTest:Te,endsWith:Mr,toArray:Br,forEachEntry:Vr,matchAll:Gr,isHTMLForm:Jr,hasOwnProperty:Bt,hasOwnProp:Bt,reduceDescriptors:_a,freezeMethods:Wr,toObjectSet:Xr,toCamelCase:Hr,noop:Kr,toFiniteNumber:Zr,findKey:va,globalThis:Ve,isContextDefined:wa,isSpecCompliantForm:Yr,toJSONObject:en,isAsyncFn:sn,isThenable:tn,setImmediate:Sa,asap:an,isIterable:rn};function J(s,t,a,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),a&&(this.config=a),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}T.inherits(J,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:T.toJSONObject(this.config),code:this.code,status:this.status}}});const Ca=J.prototype,ka={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{ka[s]={value:s}});Object.defineProperties(J,ka);Object.defineProperty(Ca,"isAxiosError",{value:!0});J.from=(s,t,a,r,n,l)=>{const o=Object.create(Ca);return T.toFlatObject(s,o,function(c){return c!==Error.prototype},i=>i!=="isAxiosError"),J.call(o,s.message,t,a,r,n),o.cause=s,o.name=s.name,l&&Object.assign(o,l),o};const nn=null;function bt(s){return T.isPlainObject(s)||T.isArray(s)}function Ea(s){return T.endsWith(s,"[]")?s.slice(0,-2):s}function qt(s,t,a){return s?s.concat(t).map(function(n,l){return n=Ea(n),!a&&l?"["+n+"]":n}).join(a?".":""):t}function on(s){return T.isArray(s)&&!s.some(bt)}const ln=T.toFlatObject(T,{},null,function(t){return/^is[A-Z]/.test(t)});function tt(s,t,a){if(!T.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,a=T.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,m){return!T.isUndefined(m[f])});const r=a.metaTokens,n=a.visitor||u,l=a.dots,o=a.indexes,c=(a.Blob||typeof Blob<"u"&&Blob)&&T.isSpecCompliantForm(t);if(!T.isFunction(n))throw new TypeError("visitor must be a function");function h(x){if(x===null)return"";if(T.isDate(x))return x.toISOString();if(!c&&T.isBlob(x))throw new J("Blob is not supported. Use a Buffer instead.");return T.isArrayBuffer(x)||T.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function u(x,f,m){let k=x;if(x&&!m&&typeof x=="object"){if(T.endsWith(f,"{}"))f=r?f:f.slice(0,-2),x=JSON.stringify(x);else if(T.isArray(x)&&on(x)||(T.isFileList(x)||T.endsWith(f,"[]"))&&(k=T.toArray(x)))return f=Ea(f),k.forEach(function(b,y){!(T.isUndefined(b)||b===null)&&t.append(o===!0?qt([f],y,l):o===null?f:f+"[]",h(b))}),!1}return bt(x)?!0:(t.append(qt(m,f,l),h(x)),!1)}const g=[],p=Object.assign(ln,{defaultVisitor:u,convertValue:h,isVisitable:bt});function R(x,f){if(!T.isUndefined(x)){if(g.indexOf(x)!==-1)throw Error("Circular reference detected in "+f.join("."));g.push(x),T.forEach(x,function(k,v){(!(T.isUndefined(k)||k===null)&&n.call(t,k,T.isString(v)?v.trim():v,f,p))===!0&&R(k,f?f.concat(v):[v])}),g.pop()}}if(!T.isObject(s))throw new TypeError("data must be an object");return R(s),t}function Vt(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Tt(s,t){this._pairs=[],s&&tt(s,this,t)}const Aa=Tt.prototype;Aa.append=function(t,a){this._pairs.push([t,a])};Aa.toString=function(t){const a=t?function(r){return t.call(this,r,Vt)}:Vt;return this._pairs.map(function(n){return a(n[0])+"="+a(n[1])},"").join("&")};function cn(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ra(s,t,a){if(!t)return s;const r=a&&a.encode||cn;T.isFunction(a)&&(a={serialize:a});const n=a&&a.serialize;let l;if(n?l=n(t,a):l=T.isURLSearchParams(t)?t.toString():new Tt(t,a).toString(r),l){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+l}return s}class dn{constructor(){this.handlers=[]}use(t,a,r){return this.handlers.push({fulfilled:t,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){T.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Gt=dn,Ta={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mn=typeof URLSearchParams<"u"?URLSearchParams:Tt,un=typeof FormData<"u"?FormData:null,xn=typeof Blob<"u"?Blob:null,hn={isBrowser:!0,classes:{URLSearchParams:mn,FormData:un,Blob:xn},protocols:["http","https","file","blob","url","data"]},Pt=typeof window<"u"&&typeof document<"u",yt=typeof navigator=="object"&&navigator||void 0,gn=Pt&&(!yt||["ReactNative","NativeScript","NS"].indexOf(yt.product)<0),pn=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),fn=Pt&&window.location.href||"http://localhost",jn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Pt,hasStandardBrowserEnv:gn,hasStandardBrowserWebWorkerEnv:pn,navigator:yt,origin:fn},Symbol.toStringTag,{value:"Module"})),he={...jn,...hn};function bn(s,t){return tt(s,new he.classes.URLSearchParams,Object.assign({visitor:function(a,r,n,l){return he.isNode&&T.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function yn(s){return T.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Nn(s){const t={},a=Object.keys(s);let r;const n=a.length;let l;for(r=0;r<n;r++)l=a[r],t[l]=s[l];return t}function Pa(s){function t(a,r,n,l){let o=a[l++];if(o==="__proto__")return!0;const i=Number.isFinite(+o),c=l>=a.length;return o=!o&&T.isArray(n)?n.length:o,c?(T.hasOwnProp(n,o)?n[o]=[n[o],r]:n[o]=r,!i):((!n[o]||!T.isObject(n[o]))&&(n[o]=[]),t(a,r,n[o],l)&&T.isArray(n[o])&&(n[o]=Nn(n[o])),!i)}if(T.isFormData(s)&&T.isFunction(s.entries)){const a={};return T.forEachEntry(s,(r,n)=>{t(yn(r),n,a,0)}),a}return null}function vn(s,t,a){if(T.isString(s))try{return(t||JSON.parse)(s),T.trim(s)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(s)}const Dt={transitional:Ta,adapter:["xhr","http","fetch"],transformRequest:[function(t,a){const r=a.getContentType()||"",n=r.indexOf("application/json")>-1,l=T.isObject(t);if(l&&T.isHTMLForm(t)&&(t=new FormData(t)),T.isFormData(t))return n?JSON.stringify(Pa(t)):t;if(T.isArrayBuffer(t)||T.isBuffer(t)||T.isStream(t)||T.isFile(t)||T.isBlob(t)||T.isReadableStream(t))return t;if(T.isArrayBufferView(t))return t.buffer;if(T.isURLSearchParams(t))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return bn(t,this.formSerializer).toString();if((i=T.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return tt(i?{"files[]":t}:t,c&&new c,this.formSerializer)}}return l||n?(a.setContentType("application/json",!1),vn(t)):t}],transformResponse:[function(t){const a=this.transitional||Dt.transitional,r=a&&a.forcedJSONParsing,n=this.responseType==="json";if(T.isResponse(t)||T.isReadableStream(t))return t;if(t&&T.isString(t)&&(r&&!this.responseType||n)){const o=!(a&&a.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(i){if(o)throw i.name==="SyntaxError"?J.from(i,J.ERR_BAD_RESPONSE,this,null,this.response):i}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:he.classes.FormData,Blob:he.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};T.forEach(["delete","get","head","post","put","patch"],s=>{Dt.headers[s]={}});const $t=Dt,wn=T.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_n=s=>{const t={};let a,r,n;return s&&s.split(`
`).forEach(function(o){n=o.indexOf(":"),a=o.substring(0,n).trim().toLowerCase(),r=o.substring(n+1).trim(),!(!a||t[a]&&wn[a])&&(a==="set-cookie"?t[a]?t[a].push(r):t[a]=[r]:t[a]=t[a]?t[a]+", "+r:r)}),t},Jt=Symbol("internals");function hs(s){return s&&String(s).trim().toLowerCase()}function Fs(s){return s===!1||s==null?s:T.isArray(s)?s.map(Fs):String(s)}function Sn(s){const t=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(s);)t[r[1]]=r[2];return t}const Cn=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function it(s,t,a,r,n){if(T.isFunction(r))return r.call(this,t,a);if(n&&(t=a),!!T.isString(t)){if(T.isString(r))return t.indexOf(r)!==-1;if(T.isRegExp(r))return r.test(t)}}function kn(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,a,r)=>a.toUpperCase()+r)}function En(s,t){const a=T.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(s,r+a,{value:function(n,l,o){return this[r].call(this,t,n,l,o)},configurable:!0})})}class at{constructor(t){t&&this.set(t)}set(t,a,r){const n=this;function l(i,c,h){const u=hs(c);if(!u)throw new Error("header name must be a non-empty string");const g=T.findKey(n,u);(!g||n[g]===void 0||h===!0||h===void 0&&n[g]!==!1)&&(n[g||c]=Fs(i))}const o=(i,c)=>T.forEach(i,(h,u)=>l(h,u,c));if(T.isPlainObject(t)||t instanceof this.constructor)o(t,a);else if(T.isString(t)&&(t=t.trim())&&!Cn(t))o(_n(t),a);else if(T.isObject(t)&&T.isIterable(t)){let i={},c,h;for(const u of t){if(!T.isArray(u))throw TypeError("Object iterator must return a key-value pair");i[h=u[0]]=(c=i[h])?T.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(i,a)}else t!=null&&l(a,t,r);return this}get(t,a){if(t=hs(t),t){const r=T.findKey(this,t);if(r){const n=this[r];if(!a)return n;if(a===!0)return Sn(n);if(T.isFunction(a))return a.call(this,n,r);if(T.isRegExp(a))return a.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,a){if(t=hs(t),t){const r=T.findKey(this,t);return!!(r&&this[r]!==void 0&&(!a||it(this,this[r],r,a)))}return!1}delete(t,a){const r=this;let n=!1;function l(o){if(o=hs(o),o){const i=T.findKey(r,o);i&&(!a||it(r,r[i],i,a))&&(delete r[i],n=!0)}}return T.isArray(t)?t.forEach(l):l(t),n}clear(t){const a=Object.keys(this);let r=a.length,n=!1;for(;r--;){const l=a[r];(!t||it(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const a=this,r={};return T.forEach(this,(n,l)=>{const o=T.findKey(r,l);if(o){a[o]=Fs(n),delete a[l];return}const i=t?kn(l):String(l).trim();i!==l&&delete a[l],a[i]=Fs(n),r[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const a=Object.create(null);return T.forEach(this,(r,n)=>{r!=null&&r!==!1&&(a[n]=t&&T.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,a])=>t+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...a){const r=new this(t);return a.forEach(n=>r.set(n)),r}static accessor(t){const r=(this[Jt]=this[Jt]={accessors:{}}).accessors,n=this.prototype;function l(o){const i=hs(o);r[i]||(En(n,o),r[i]=!0)}return T.isArray(t)?t.forEach(l):l(t),this}}at.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);T.reduceDescriptors(at.prototype,({value:s},t)=>{let a=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(r){this[a]=r}}});T.freezeMethods(at);const Ce=at;function ct(s,t){const a=this||$t,r=t||a,n=Ce.from(r.headers);let l=r.data;return T.forEach(s,function(i){l=i.call(a,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function Da(s){return!!(s&&s.__CANCEL__)}function rs(s,t,a){J.call(this,s??"canceled",J.ERR_CANCELED,t,a),this.name="CanceledError"}T.inherits(rs,J,{__CANCEL__:!0});function $a(s,t,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?s(a):t(new J("Request failed with status code "+a.status,[J.ERR_BAD_REQUEST,J.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function An(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function Rn(s,t){s=s||10;const a=new Array(s),r=new Array(s);let n=0,l=0,o;return t=t!==void 0?t:1e3,function(c){const h=Date.now(),u=r[l];o||(o=h),a[n]=c,r[n]=h;let g=l,p=0;for(;g!==n;)p+=a[g++],g=g%s;if(n=(n+1)%s,n===l&&(l=(l+1)%s),h-o<t)return;const R=u&&h-u;return R?Math.round(p*1e3/R):void 0}}function Tn(s,t){let a=0,r=1e3/t,n,l;const o=(h,u=Date.now())=>{a=u,n=null,l&&(clearTimeout(l),l=null),s.apply(null,h)};return[(...h)=>{const u=Date.now(),g=u-a;g>=r?o(h,u):(n=h,l||(l=setTimeout(()=>{l=null,o(n)},r-g)))},()=>n&&o(n)]}const Js=(s,t,a=3)=>{let r=0;const n=Rn(50,250);return Tn(l=>{const o=l.loaded,i=l.lengthComputable?l.total:void 0,c=o-r,h=n(c),u=o<=i;r=o;const g={loaded:o,total:i,progress:i?o/i:void 0,bytes:c,rate:h||void 0,estimated:h&&i&&u?(i-o)/h:void 0,event:l,lengthComputable:i!=null,[t?"download":"upload"]:!0};s(g)},a)},Ht=(s,t)=>{const a=s!=null;return[r=>t[0]({lengthComputable:a,total:s,loaded:r}),t[1]]},Qt=s=>(...t)=>T.asap(()=>s(...t)),Pn=he.hasStandardBrowserEnv?((s,t)=>a=>(a=new URL(a,he.origin),s.protocol===a.protocol&&s.host===a.host&&(t||s.port===a.port)))(new URL(he.origin),he.navigator&&/(msie|trident)/i.test(he.navigator.userAgent)):()=>!0,Dn=he.hasStandardBrowserEnv?{write(s,t,a,r,n,l){const o=[s+"="+encodeURIComponent(t)];T.isNumber(a)&&o.push("expires="+new Date(a).toGMTString()),T.isString(r)&&o.push("path="+r),T.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $n(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function Fn(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function Fa(s,t,a){let r=!$n(t);return s&&(r||a==!1)?Fn(s,t):t}const Wt=s=>s instanceof Ce?{...s}:s;function Ke(s,t){t=t||{};const a={};function r(h,u,g,p){return T.isPlainObject(h)&&T.isPlainObject(u)?T.merge.call({caseless:p},h,u):T.isPlainObject(u)?T.merge({},u):T.isArray(u)?u.slice():u}function n(h,u,g,p){if(T.isUndefined(u)){if(!T.isUndefined(h))return r(void 0,h,g,p)}else return r(h,u,g,p)}function l(h,u){if(!T.isUndefined(u))return r(void 0,u)}function o(h,u){if(T.isUndefined(u)){if(!T.isUndefined(h))return r(void 0,h)}else return r(void 0,u)}function i(h,u,g){if(g in t)return r(h,u);if(g in s)return r(void 0,h)}const c={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:i,headers:(h,u,g)=>n(Wt(h),Wt(u),g,!0)};return T.forEach(Object.keys(Object.assign({},s,t)),function(u){const g=c[u]||n,p=g(s[u],t[u],u);T.isUndefined(p)&&g!==i||(a[u]=p)}),a}const La=s=>{const t=Ke({},s);let{data:a,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:i}=t;t.headers=o=Ce.from(o),t.url=Ra(Fa(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),i&&o.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):"")));let c;if(T.isFormData(a)){if(he.hasStandardBrowserEnv||he.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[h,...u]=c?c.split(";").map(g=>g.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...u].join("; "))}}if(he.hasStandardBrowserEnv&&(r&&T.isFunction(r)&&(r=r(t)),r||r!==!1&&Pn(t.url))){const h=n&&l&&Dn.read(l);h&&o.set(n,h)}return t},Ln=typeof XMLHttpRequest<"u",On=Ln&&function(s){return new Promise(function(a,r){const n=La(s);let l=n.data;const o=Ce.from(n.headers).normalize();let{responseType:i,onUploadProgress:c,onDownloadProgress:h}=n,u,g,p,R,x;function f(){R&&R(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let m=new XMLHttpRequest;m.open(n.method.toUpperCase(),n.url,!0),m.timeout=n.timeout;function k(){if(!m)return;const b=Ce.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),A={data:!i||i==="text"||i==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:b,config:s,request:m};$a(function(N){a(N),f()},function(N){r(N),f()},A),m=null}"onloadend"in m?m.onloadend=k:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(k)},m.onabort=function(){m&&(r(new J("Request aborted",J.ECONNABORTED,s,m)),m=null)},m.onerror=function(){r(new J("Network Error",J.ERR_NETWORK,s,m)),m=null},m.ontimeout=function(){let y=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||Ta;n.timeoutErrorMessage&&(y=n.timeoutErrorMessage),r(new J(y,A.clarifyTimeoutError?J.ETIMEDOUT:J.ECONNABORTED,s,m)),m=null},l===void 0&&o.setContentType(null),"setRequestHeader"in m&&T.forEach(o.toJSON(),function(y,A){m.setRequestHeader(A,y)}),T.isUndefined(n.withCredentials)||(m.withCredentials=!!n.withCredentials),i&&i!=="json"&&(m.responseType=n.responseType),h&&([p,x]=Js(h,!0),m.addEventListener("progress",p)),c&&m.upload&&([g,R]=Js(c),m.upload.addEventListener("progress",g),m.upload.addEventListener("loadend",R)),(n.cancelToken||n.signal)&&(u=b=>{m&&(r(!b||b.type?new rs(null,s,m):b),m.abort(),m=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const v=An(n.url);if(v&&he.protocols.indexOf(v)===-1){r(new J("Unsupported protocol "+v+":",J.ERR_BAD_REQUEST,s));return}m.send(l||null)})},zn=(s,t)=>{const{length:a}=s=s?s.filter(Boolean):[];if(t||a){let r=new AbortController,n;const l=function(h){if(!n){n=!0,i();const u=h instanceof Error?h:this.reason;r.abort(u instanceof J?u:new rs(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,l(new J(`timeout ${t} of ms exceeded`,J.ETIMEDOUT))},t);const i=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),s=null)};s.forEach(h=>h.addEventListener("abort",l));const{signal:c}=r;return c.unsubscribe=()=>T.asap(i),c}},Un=zn,In=function*(s,t){let a=s.byteLength;if(!t||a<t){yield s;return}let r=0,n;for(;r<a;)n=r+t,yield s.slice(r,n),r=n},Mn=async function*(s,t){for await(const a of Bn(s))yield*In(a,t)},Bn=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:a,value:r}=await t.read();if(a)break;yield r}}finally{await t.cancel()}},Xt=(s,t,a,r)=>{const n=Mn(s,t);let l=0,o,i=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:h,value:u}=await n.next();if(h){i(),c.close();return}let g=u.byteLength;if(a){let p=l+=g;a(p)}c.enqueue(new Uint8Array(u))}catch(h){throw i(h),h}},cancel(c){return i(c),n.return()}},{highWaterMark:2})},rt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Oa=rt&&typeof ReadableStream=="function",qn=rt&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),za=(s,...t)=>{try{return!!s(...t)}catch{return!1}},Vn=Oa&&za(()=>{let s=!1;const t=new Request(he.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),Kt=64*1024,Nt=Oa&&za(()=>T.isReadableStream(new Response("").body)),Hs={stream:Nt&&(s=>s.body)};rt&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Hs[t]&&(Hs[t]=T.isFunction(s[t])?a=>a[t]():(a,r)=>{throw new J(`Response type '${t}' is not supported`,J.ERR_NOT_SUPPORT,r)})})})(new Response);const Gn=async s=>{if(s==null)return 0;if(T.isBlob(s))return s.size;if(T.isSpecCompliantForm(s))return(await new Request(he.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(T.isArrayBufferView(s)||T.isArrayBuffer(s))return s.byteLength;if(T.isURLSearchParams(s)&&(s=s+""),T.isString(s))return(await qn(s)).byteLength},Jn=async(s,t)=>{const a=T.toFiniteNumber(s.getContentLength());return a??Gn(t)},Hn=rt&&(async s=>{let{url:t,method:a,data:r,signal:n,cancelToken:l,timeout:o,onDownloadProgress:i,onUploadProgress:c,responseType:h,headers:u,withCredentials:g="same-origin",fetchOptions:p}=La(s);h=h?(h+"").toLowerCase():"text";let R=Un([n,l&&l.toAbortSignal()],o),x;const f=R&&R.unsubscribe&&(()=>{R.unsubscribe()});let m;try{if(c&&Vn&&a!=="get"&&a!=="head"&&(m=await Jn(u,r))!==0){let A=new Request(t,{method:"POST",body:r,duplex:"half"}),w;if(T.isFormData(r)&&(w=A.headers.get("content-type"))&&u.setContentType(w),A.body){const[N,C]=Ht(m,Js(Qt(c)));r=Xt(A.body,Kt,N,C)}}T.isString(g)||(g=g?"include":"omit");const k="credentials"in Request.prototype;x=new Request(t,{...p,signal:R,method:a.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:k?g:void 0});let v=await fetch(x);const b=Nt&&(h==="stream"||h==="response");if(Nt&&(i||b&&f)){const A={};["status","statusText","headers"].forEach(E=>{A[E]=v[E]});const w=T.toFiniteNumber(v.headers.get("content-length")),[N,C]=i&&Ht(w,Js(Qt(i),!0))||[];v=new Response(Xt(v.body,Kt,N,()=>{C&&C(),f&&f()}),A)}h=h||"text";let y=await Hs[T.findKey(Hs,h)||"text"](v,s);return!b&&f&&f(),await new Promise((A,w)=>{$a(A,w,{data:y,headers:Ce.from(v.headers),status:v.status,statusText:v.statusText,config:s,request:x})})}catch(k){throw f&&f(),k&&k.name==="TypeError"&&/Load failed|fetch/i.test(k.message)?Object.assign(new J("Network Error",J.ERR_NETWORK,s,x),{cause:k.cause||k}):J.from(k,k&&k.code,s,x)}}),vt={http:nn,xhr:On,fetch:Hn};T.forEach(vt,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const Zt=s=>`- ${s}`,Qn=s=>T.isFunction(s)||s===null||s===!1,Ua={getAdapter:s=>{s=T.isArray(s)?s:[s];const{length:t}=s;let a,r;const n={};for(let l=0;l<t;l++){a=s[l];let o;if(r=a,!Qn(a)&&(r=vt[(o=String(a)).toLowerCase()],r===void 0))throw new J(`Unknown adapter '${o}'`);if(r)break;n[o||"#"+l]=r}if(!r){const l=Object.entries(n).map(([i,c])=>`adapter ${i} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?l.length>1?`since :
`+l.map(Zt).join(`
`):" "+Zt(l[0]):"as no adapter specified";throw new J("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:vt};function dt(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new rs(null,s)}function Yt(s){return dt(s),s.headers=Ce.from(s.headers),s.data=ct.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),Ua.getAdapter(s.adapter||$t.adapter)(s).then(function(r){return dt(s),r.data=ct.call(s,s.transformResponse,r),r.headers=Ce.from(r.headers),r},function(r){return Da(r)||(dt(s),r&&r.response&&(r.response.data=ct.call(s,s.transformResponse,r.response),r.response.headers=Ce.from(r.response.headers))),Promise.reject(r)})}const Ia="1.9.0",nt={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{nt[s]=function(r){return typeof r===s||"a"+(t<1?"n ":" ")+s}});const ea={};nt.transitional=function(t,a,r){function n(l,o){return"[Axios v"+Ia+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,i)=>{if(t===!1)throw new J(n(o," has been removed"+(a?" in "+a:"")),J.ERR_DEPRECATED);return a&&!ea[o]&&(ea[o]=!0,console.warn(n(o," has been deprecated since v"+a+" and will be removed in the near future"))),t?t(l,o,i):!0}};nt.spelling=function(t){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function Wn(s,t,a){if(typeof s!="object")throw new J("options must be an object",J.ERR_BAD_OPTION_VALUE);const r=Object.keys(s);let n=r.length;for(;n-- >0;){const l=r[n],o=t[l];if(o){const i=s[l],c=i===void 0||o(i,l,s);if(c!==!0)throw new J("option "+l+" must be "+c,J.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new J("Unknown option "+l,J.ERR_BAD_OPTION)}}const Ls={assertOptions:Wn,validators:nt},De=Ls.validators;class Qs{constructor(t){this.defaults=t||{},this.interceptors={request:new Gt,response:new Gt}}async request(t,a){try{return await this._request(t,a)}catch(r){if(r instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(t,a){typeof t=="string"?(a=a||{},a.url=t):a=t||{},a=Ke(this.defaults,a);const{transitional:r,paramsSerializer:n,headers:l}=a;r!==void 0&&Ls.assertOptions(r,{silentJSONParsing:De.transitional(De.boolean),forcedJSONParsing:De.transitional(De.boolean),clarifyTimeoutError:De.transitional(De.boolean)},!1),n!=null&&(T.isFunction(n)?a.paramsSerializer={serialize:n}:Ls.assertOptions(n,{encode:De.function,serialize:De.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Ls.assertOptions(a,{baseUrl:De.spelling("baseURL"),withXsrfToken:De.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&T.merge(l.common,l[a.method]);l&&T.forEach(["delete","get","head","post","put","patch","common"],x=>{delete l[x]}),a.headers=Ce.concat(o,l);const i=[];let c=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(a)===!1||(c=c&&f.synchronous,i.unshift(f.fulfilled,f.rejected))});const h=[];this.interceptors.response.forEach(function(f){h.push(f.fulfilled,f.rejected)});let u,g=0,p;if(!c){const x=[Yt.bind(this),void 0];for(x.unshift.apply(x,i),x.push.apply(x,h),p=x.length,u=Promise.resolve(a);g<p;)u=u.then(x[g++],x[g++]);return u}p=i.length;let R=a;for(g=0;g<p;){const x=i[g++],f=i[g++];try{R=x(R)}catch(m){f.call(this,m);break}}try{u=Yt.call(this,R)}catch(x){return Promise.reject(x)}for(g=0,p=h.length;g<p;)u=u.then(h[g++],h[g++]);return u}getUri(t){t=Ke(this.defaults,t);const a=Fa(t.baseURL,t.url,t.allowAbsoluteUrls);return Ra(a,t.params,t.paramsSerializer)}}T.forEach(["delete","get","head","options"],function(t){Qs.prototype[t]=function(a,r){return this.request(Ke(r||{},{method:t,url:a,data:(r||{}).data}))}});T.forEach(["post","put","patch"],function(t){function a(r){return function(l,o,i){return this.request(Ke(i||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Qs.prototype[t]=a(),Qs.prototype[t+"Form"]=a(!0)});const Os=Qs;class Ft{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(n=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](n);r._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(i=>{r.subscribe(i),l=i}).then(n);return o.cancel=function(){r.unsubscribe(l)},o},t(function(l,o,i){r.reason||(r.reason=new rs(l,o,i),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const a=this._listeners.indexOf(t);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const t=new AbortController,a=r=>{t.abort(r)};return this.subscribe(a),t.signal.unsubscribe=()=>this.unsubscribe(a),t.signal}static source(){let t;return{token:new Ft(function(n){t=n}),cancel:t}}}const Xn=Ft;function Kn(s){return function(a){return s.apply(null,a)}}function Zn(s){return T.isObject(s)&&s.isAxiosError===!0}const wt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wt).forEach(([s,t])=>{wt[t]=s});const Yn=wt;function Ma(s){const t=new Os(s),a=ja(Os.prototype.request,t);return T.extend(a,Os.prototype,t,{allOwnKeys:!0}),T.extend(a,t,null,{allOwnKeys:!0}),a.create=function(n){return Ma(Ke(s,n))},a}const oe=Ma($t);oe.Axios=Os;oe.CanceledError=rs;oe.CancelToken=Xn;oe.isCancel=Da;oe.VERSION=Ia;oe.toFormData=tt;oe.AxiosError=J;oe.Cancel=oe.CanceledError;oe.all=function(t){return Promise.all(t)};oe.spread=Kn;oe.isAxiosError=Zn;oe.mergeConfig=Ke;oe.AxiosHeaders=Ce;oe.formToJSON=s=>Pa(T.isHTMLForm(s)?new FormData(s):s);oe.getAdapter=Ua.getAdapter;oe.HttpStatusCode=Yn;oe.default=oe;const Ba=oe;/*! js-cookie v3.0.5 | MIT */function ks(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)s[r]=a[r]}return s}var eo={read:function(s){return s[0]==='"'&&(s=s.slice(1,-1)),s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(s){return encodeURIComponent(s).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function _t(s,t){function a(n,l,o){if(!(typeof document>"u")){o=ks({},t,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var c in o)o[c]&&(i+="; "+c,o[c]!==!0&&(i+="="+o[c].split(";")[0]));return document.cookie=n+"="+s.write(l,n)+i}}function r(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var l=document.cookie?document.cookie.split("; "):[],o={},i=0;i<l.length;i++){var c=l[i].split("="),h=c.slice(1).join("=");try{var u=decodeURIComponent(c[0]);if(o[u]=s.read(h,u),n===u)break}catch{}}return n?o[n]:o}}return Object.create({set:a,get:r,remove:function(n,l){a(n,"",ks({},l,{expires:-1}))},withAttributes:function(n){return _t(this.converter,ks({},this.attributes,n))},withConverter:function(n){return _t(ks({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(s)}})}var le=_t(eo,{path:"/"});const so=()=>{if({}.VITE_API_BASE_URL)return{}.VITE_API_BASE_URL;if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return"http://127.0.0.1:5000/api";if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return"/api";const s=window.location.protocol,t=window.location.hostname;return`${s}//${t}:5000/api`},qa=so(),z=Ba.create({baseURL:qa,timeout:1e4,withCredentials:!1,headers:{"Content-Type":"application/json"}});let mt=!1,St=[];const sa=(s,t=null)=>{St.forEach(a=>{s?a.reject(s):a.resolve(t)}),St=[]},to=()=>{le.remove("access_token"),le.remove("refresh_token");try{localStorage.setItem("auth_event",JSON.stringify({type:"logout",timestamp:Date.now()})),setTimeout(()=>{localStorage.removeItem("auth_event")},100)}catch(s){console.warn("Erro ao comunicar logout para outras abas:",s)}};z.interceptors.request.use(s=>{const t=le.get("access_token");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));z.interceptors.response.use(s=>s,async s=>{var a,r,n,l,o,i,c;const t=s.config;if(((a=s.response)==null?void 0:a.status)===401&&!t._retry){if(mt)return new Promise((h,u)=>{St.push({resolve:h,reject:u})}).then(h=>h?(t.headers.Authorization=`Bearer ${h}`,z(t)):Promise.reject(s)).catch(h=>Promise.reject(h));t._retry=!0,mt=!0;try{const h=le.get("refresh_token");if(!h)throw new Error("No refresh token available");const u=await Ba.post(`${qa}/auth/refresh`,{},{headers:{Authorization:`Bearer ${h}`},timeout:5e3});if(u.data.success){const{access_token:g}=u.data.data;return le.set("access_token",g,{expires:1}),sa(null,g),t.headers.Authorization=`Bearer ${g}`,z(t)}else throw new Error("Refresh failed")}catch(h){return console.warn("Refresh token failed:",h.message),sa(h,null),to(),window.location.pathname.includes("/login")||setTimeout(()=>{window.location.href="/login"},100),Promise.reject(h)}finally{mt=!1}}if(((r=s.response)==null?void 0:r.status)!==401&&!t._retry){const h=((l=(n=s.response)==null?void 0:n.data)==null?void 0:l.message)||"Erro interno do servidor",u=`${(o=s.config)==null?void 0:o.url}-${(i=s.response)==null?void 0:i.status}-${h}`,g=((c=window.lastErrorToast)==null?void 0:c[u])||0,p=Date.now();p-g>3e3&&(S.error(h),window.lastErrorToast||(window.lastErrorToast={}),window.lastErrorToast[u]=p)}return Promise.reject(s)});typeof window<"u"&&window.addEventListener("storage",s=>{if(s.key==="auth_event"&&s.newValue)try{JSON.parse(s.newValue).type==="logout"&&(le.remove("access_token"),le.remove("refresh_token"),window.location.pathname.includes("/login")||(window.location.href="/login"))}catch(t){console.warn("Erro ao processar evento de auth:",t)}});const ta={async login(s,t){var a,r;try{const n=await z.post("/auth/login",{email:s,password:t}),{access_token:l,refresh_token:o,user:i}=n.data.data;return le.set("access_token",l,{expires:1}),le.set("refresh_token",o,{expires:7}),{success:!0,user:i,message:n.data.message}}catch(n){return{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao fazer login"}}},async register(s){var t,a;try{const r=await z.post("/auth/register",s);return{success:!0,user:r.data.data.user,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao registrar usuário"}}},logout(){le.remove("access_token"),le.remove("refresh_token"),window.location.href="/login"},isAuthenticated(){return!!le.get("access_token")},async requestPasswordReset(s){var t,a;try{return{success:!0,message:(await z.post("/auth/password/reset-request",{email:s})).data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao solicitar reset de senha"}}},async resetPassword(s,t){var a,r;try{return{success:!0,message:(await z.post("/auth/password/reset",{token:s,password:t})).data.message}}catch(n){return{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao redefinir senha"}}}},es={async getProfile(){var s,t;try{return{success:!0,data:(await z.get("/users/profile")).data.data}}catch(a){return{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao buscar perfil"}}},async updateProfile(s){var t,a;try{const r=await z.put("/users/profile",s);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao atualizar perfil"}}},async changePassword(s){var t,a;try{return{success:!0,message:(await z.post("/users/change-password",s)).data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao alterar senha"}}},async getDashboardData(){var s,t;try{return{success:!0,data:(await z.get("/users/dashboard")).data.data}}catch(a){return{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao buscar dados do dashboard"}}},async getUserPublicProfile(s){var t,a;try{return{success:!0,data:(await z.get(`/users/${s}`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar perfil público"}}}},Va=d.createContext(),xe=()=>{const s=d.useContext(Va);if(!s)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return s},ao=({children:s})=>{const[t,a]=d.useState(null),[r,n]=d.useState(!0),[l,o]=d.useState(!1),[i,c]=d.useState(0),h=5*60*1e3,u=async(m=!1)=>{const k=Date.now();if(!m&&k-i<h&&t)return;if(!le.get("access_token")){a(null),o(!1),n(!1),c(k);return}try{const b=await es.getProfile();b.success?(a(b.data.user),o(!0),c(k)):(le.remove("access_token"),le.remove("refresh_token"),a(null),o(!1),c(k))}catch(b){console.error("Erro ao verificar autenticação:",b),le.remove("access_token"),le.remove("refresh_token"),a(null),o(!1),c(k)}n(!1)};d.useEffect(()=>{u();const m=b=>{(b.key==="access_token"||b.key==="refresh_token")&&u(!0)},k=()=>{document.hidden||Date.now()-i>h&&u()};window.addEventListener("storage",m),document.addEventListener("visibilitychange",k);const v=setInterval(()=>{l&&u()},10*60*1e3);return()=>{window.removeEventListener("storage",m),document.removeEventListener("visibilitychange",k),clearInterval(v)}},[i,l]);const f={user:t,login:async(m,k)=>{try{const v=await ta.login(m,k);return v.success&&(a(v.user),o(!0),c(Date.now()),window.dispatchEvent(new StorageEvent("storage",{key:"auth_status",newValue:"logged_in",url:window.location.href}))),v}catch(v){return console.error("Erro no login:",v),{success:!1,message:"Erro interno no login"}}},register:async m=>{try{return await ta.register(m)}catch(k){return console.error("Erro no registro:",k),{success:!1,message:"Erro interno no registro"}}},logout:()=>{a(null),o(!1),c(0),le.remove("access_token"),le.remove("refresh_token"),window.dispatchEvent(new StorageEvent("storage",{key:"auth_status",newValue:"logged_out",url:window.location.href})),window.location.href="/login"},updateUser:m=>{a(k=>({...k,...m})),c(Date.now())},loading:r,isAuthenticated:l,checkAuth:()=>u(!0)};return e.jsx(Va.Provider,{value:f,children:s})},Ct={async getGames(s={}){var t,a;try{return{success:!0,data:(await z.get("/games",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar jogos"}}},async getGame(s){var t,a;try{return{success:!0,data:(await z.get(`/games/${s}`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar jogo"}}},async getFeaturedGames(){var s,t;try{return{success:!0,data:(await z.get("/games/featured")).data.data}}catch(a){return{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao buscar jogos em destaque"}}}},Ga=d.createContext(),Ss=()=>{const s=d.useContext(Ga);if(!s)throw new Error("useGames deve ser usado dentro de um GameProvider");return s},ro=({children:s})=>{const[t,a]=d.useState([]),[r,n]=d.useState([]),[l,o]=d.useState(!1),i=async(u={})=>{o(!0);const g=await Ct.getGames(u);return g.success&&a(g.data.games),o(!1),g},c=async()=>{const u=await Ct.getFeaturedGames();return u.success&&n(u.data.featured_games),u};d.useEffect(()=>{i(),c()},[]);const h={games:t,featuredGames:r,loading:l,fetchGames:i,fetchFeaturedGames:c};return e.jsx(Ga.Provider,{value:h,children:s})},Ze={getCart:async()=>{var s,t;try{return(await z.get("/cart")).data}catch(a){return console.error("Erro ao buscar carrinho:",a),{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao buscar carrinho"}}},addToCart:async(s,t=1)=>{var a,r;try{return(await z.post("/cart/add",{ad_id:s,quantity:t})).data}catch(n){return console.error("Erro ao adicionar ao carrinho:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao adicionar ao carrinho"}}},updateCartItem:async(s,t)=>{var a,r;try{return(await z.put(`/cart/update/${s}`,{quantity:t})).data}catch(n){return console.error("Erro ao atualizar item:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao atualizar item"}}},removeFromCart:async s=>{var t,a;try{return(await z.delete(`/cart/remove/${s}`)).data}catch(r){return console.error("Erro ao remover item:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao remover item"}}},clearCart:async()=>{var s,t;try{return(await z.delete("/cart/clear")).data}catch(a){return console.error("Erro ao limpar carrinho:",a),{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao limpar carrinho"}}},validateCart:async()=>{var s,t;try{return(await z.get("/cart/validate")).data}catch(a){return console.error("Erro ao validar carrinho:",a),{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao validar carrinho"}}},getCartCount:async()=>{var s,t;try{return(await z.get("/cart/count")).data}catch(a){return console.error("Erro ao contar itens:",a),{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao contar itens"}}}},Ja=d.createContext(),ot=()=>{const s=d.useContext(Ja);if(!s)throw new Error("useCart deve ser usado dentro de um CartProvider");return s},no=({children:s})=>{const{isAuthenticated:t,user:a}=xe(),[r,n]=d.useState({items:[],total_items:0,total_price:0}),[l,o]=d.useState(!1),[i,c]=d.useState(new Set);d.useEffect(()=>{t?(console.log("🔄 Usuário logado, carregando carrinho..."),h()):(console.log("❌ Usuário não logado, limpando carrinho..."),n({items:[],total_items:0,total_price:0}),c(new Set))},[t]);const h=async()=>{var b;if(!t){console.log("⚠️ Tentativa de carregar carrinho sem autenticação"),n({items:[],total_items:0,total_price:0}),c(new Set);return}o(!0);try{console.log("📡 Fazendo requisição para buscar carrinho...");const y=await Ze.getCart();if(console.log("📦 Resposta do carrinho (raw):",y),y.success){const A=y.data||{};console.log("📋 Dados do carrinho extraídos:",A);let w=[];A.cart&&Array.isArray(A.cart.items)?(w=A.cart.items,console.log("✅ Estrutura encontrada: data.cart.items")):A.items&&Array.isArray(A.items)?(w=A.items,console.log("✅ Estrutura encontrada: data.items")):Array.isArray(A)?(w=A,console.log("✅ Estrutura encontrada: data como array")):(console.log("⚠️ Estrutura não reconhecida, assumindo carrinho vazio"),w=[]),console.log(`📊 Total de itens encontrados: ${w.length}`);const N=w.map((_,L)=>{var O,D,I,G,Q,re,M,X,te,j,U,H,Y,ee,ve,Pe,ns,os,ls,is,cs,ds,ms,us;console.log(`🔍 Processando item ${L+1}:`,_);const V={_id:_._id||_.id||`temp_${L}`,ad_id:_.ad_id||_.adId,quantity:parseInt(_.quantity)||1,price_snapshot:parseFloat(_.price_snapshot||_.price||0),created_at:_.created_at||new Date().toISOString(),updated_at:_.updated_at||new Date().toISOString(),expires_at:_.expires_at,ad_snapshot:{title:((O=_.ad_snapshot)==null?void 0:O.title)||_.title||((D=_.ad)==null?void 0:D.title)||"Item sem título",game_name:((I=_.ad_snapshot)==null?void 0:I.game_name)||_.game_name||((Q=(G=_.ad)==null?void 0:G.game)==null?void 0:Q.name)||((re=_.game)==null?void 0:re.name)||"Jogo não identificado",platform:((M=_.ad_snapshot)==null?void 0:M.platform)||_.platform||((X=_.ad)==null?void 0:X.platform)||"Plataforma não informada",condition:((te=_.ad_snapshot)==null?void 0:te.condition)||_.condition||((j=_.ad)==null?void 0:j.condition)||"usado",image_url:((U=_.ad_snapshot)==null?void 0:U.image_url)||_.image_url||((H=_.ad)==null?void 0:H.image_url)||((ee=(Y=_.ad)==null?void 0:Y.game)==null?void 0:ee.image_url)||null,seller_username:((ve=_.ad_snapshot)==null?void 0:ve.seller_username)||_.seller_username||((ns=(Pe=_.ad)==null?void 0:Pe.user)==null?void 0:ns.username)||((os=_.seller)==null?void 0:os.username)||"Vendedor",seller_id:((ls=_.ad_snapshot)==null?void 0:ls.seller_id)||_.seller_id||((is=_.ad)==null?void 0:is.user_id)||((ds=(cs=_.ad)==null?void 0:cs.user)==null?void 0:ds._id),description:((ms=_.ad_snapshot)==null?void 0:ms.description)||_.description||((us=_.ad)==null?void 0:us.description)||""}};return console.log(`✅ Item ${L+1} normalizado:`,V),V}),C=N.reduce((_,L)=>_+L.quantity,0),E=N.reduce((_,L)=>_+L.price_snapshot*L.quantity,0),$={items:N,total_items:C,total_price:E};console.log("🎯 Carrinho final normalizado:",$),n($);const P=new Set(N.map(_=>_.ad_id));c(P),console.log("💾 Cache do carrinho atualizado:",Array.from(P)),window.dispatchEvent(new CustomEvent("cart-updated",{detail:$}))}else console.error("❌ Erro ao carregar carrinho:",y.message),n({items:[],total_items:0,total_price:0}),c(new Set),(b=y.message)!=null&&b.toLowerCase().includes("vazio")||S.error(y.message)}catch(y){console.error("💥 Erro ao carregar carrinho:",y),n({items:[],total_items:0,total_price:0}),c(new Set),S.error("Erro ao carregar carrinho")}o(!1)},u=async(b,y=1)=>{if(!t)return S.info("Faça login para adicionar itens ao carrinho"),{success:!1,message:"Login necessário"};console.log("➕ Adicionando ao carrinho:",{ad:b._id,quantity:y});try{const A=await Ze.addToCart(b._id,y);return console.log("📥 Resposta de adicionar:",A),A.success?(c(w=>new Set([...w,b._id])),await h(),S.success(A.message||"Item adicionado ao carrinho")):S.error(A.message),A}catch(A){return console.error("💥 Erro ao adicionar ao carrinho:",A),S.error("Erro ao adicionar ao carrinho"),{success:!1,message:"Erro interno"}}},g=async(b,y)=>{console.log("🔄 Atualizando item do carrinho:",{adId:b,quantity:y});try{const A=await Ze.updateCartItem(b,y);return A.success?(y===0&&c(w=>{const N=new Set(w);return N.delete(b),N}),await h(),S.success(A.message||"Quantidade atualizada")):S.error(A.message),A}catch(A){return console.error("💥 Erro ao atualizar item:",A),S.error("Erro ao atualizar item"),{success:!1,message:"Erro interno"}}},p=async b=>{console.log("➖ Removendo do carrinho:",b);try{const y=await Ze.removeFromCart(b);return y.success?(c(A=>{const w=new Set(A);return w.delete(b),w}),await h(),S.success(y.message||"Item removido")):S.error(y.message),y}catch(y){return console.error("💥 Erro ao remover item:",y),S.error("Erro ao remover item"),{success:!1,message:"Erro interno"}}},R=async()=>{console.log("🧹 Limpando carrinho...");try{const b=await Ze.clearCart();return b.success?(n({items:[],total_items:0,total_price:0}),c(new Set),S.success(b.message||"Carrinho limpo"),window.dispatchEvent(new CustomEvent("cart-updated",{detail:{items:[],total_items:0,total_price:0}}))):S.error(b.message),b}catch(b){return console.error("💥 Erro ao limpar carrinho:",b),S.error("Erro ao limpar carrinho"),{success:!1,message:"Erro interno"}}},x=async()=>{var b;console.log("🔍 Validando carrinho...");try{const y=await Ze.validateCart();return y.success&&((b=y.data)==null?void 0:b.total_invalid)>0&&(S.warning(`${y.data.total_invalid} item(s) removido(s) do carrinho (não disponível)`),await h()),y}catch(y){return console.error("💥 Erro ao validar carrinho:",y),{success:!1,message:"Erro ao validar carrinho"}}},f=b=>{if(!b)return!1;if(i.has(b))return!0;if(!r.items||!Array.isArray(r.items))return!1;const y=r.items.some(A=>A.ad_id===b);return y&&c(A=>new Set([...A,b])),y},m=b=>{if(!r.items||!Array.isArray(r.items))return 0;const y=r.items.find(A=>A.ad_id===b);return y?y.quantity:0},k=()=>{if(!r.items||!Array.isArray(r.items))return{items:[],total_items:0,total_price:0,sellers:[]};const b=r.items.map(A=>({ad_id:A.ad_id,quantity:A.quantity,price:A.price_snapshot,title:A.ad_snapshot.title,game_name:A.ad_snapshot.game_name,seller_id:A.ad_snapshot.seller_id,seller_name:A.ad_snapshot.seller_username,image_url:A.ad_snapshot.image_url})),y=[...new Set(b.map(A=>A.seller_id))].filter(Boolean);return{items:b,total_items:r.total_items,total_price:r.total_price,sellers:y,seller_count:y.length}};d.useEffect(()=>{},[r,i,l,t]);const v={cart:r,loading:l,loadCart:h,addToCart:u,updateCartItem:g,removeFromCart:p,clearCart:R,validateCart:x,isInCart:f,getCartItemQuantity:m,getCartForCheckout:k};return e.jsx(Ja.Provider,{value:v,children:s})},Oe=()=>({get:async(s,t={})=>{var a;try{return(await z.get(s,t)).data}catch(r){throw console.error("API GET Error:",((a=r.response)==null?void 0:a.data)||r.message),r}},post:async(s,t={},a={})=>{var r;try{return(await z.post(s,t,a)).data}catch(n){throw console.error("API POST Error:",((r=n.response)==null?void 0:r.data)||n.message),n}},put:async(s,t={},a={})=>{var r;try{return(await z.put(s,t,a)).data}catch(n){throw console.error("API PUT Error:",((r=n.response)==null?void 0:r.data)||n.message),n}},delete:async(s,t={})=>{var a;try{return(await z.delete(s,t)).data}catch(r){throw console.error("API DELETE Error:",((a=r.response)==null?void 0:a.data)||r.message),r}}}),oo=(s,t)=>{const[a,r]=d.useState(s);return d.useEffect(()=>{const n=setTimeout(()=>{r(s)},t);return()=>{clearTimeout(n)}},[s,t]),a},lo=()=>{const{user:s,logout:t,isAuthenticated:a}=xe(),{cart:r}=ot(),{fetchGames:n}=Ss(),l=be(),[o,i]=d.useState(!1),[c,h]=d.useState(!1),[u,g]=d.useState(!1),[p,R]=d.useState(""),[x,f]=d.useState([]),[m,k]=d.useState(!1),[v,b]=d.useState(!1),[y,A]=d.useState([]),[w,N]=d.useState(0),C=d.useRef(null),E=d.useRef(null),$=d.useRef(null),P=oo(p,300);d.useEffect(()=>{P.length>=2?_(P):(f([]),k(!1))},[P]),d.useEffect(()=>{if(a&&s){D();const M=setInterval(D,3e4);return()=>clearInterval(M)}},[a,s]),d.useEffect(()=>{const M=X=>{C.current&&!C.current.contains(X.target)&&k(!1),E.current&&!E.current.contains(X.target)&&h(!1),$.current&&!$.current.contains(X.target)&&g(!1)};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]);const _=async M=>{b(!0);try{const X=await n({search:M,limit:5});X.success&&(f(X.data.games||[]),k(!0))}catch(X){console.error("Erro na busca:",X)}finally{b(!1)}},L=()=>{t(),h(!1),i(!1),l("/")},V=M=>{R(""),k(!1),i(!1),l(`/games/${M}`)},O=()=>{i(!1),h(!1),g(!1)},D=async()=>{try{const M=[{id:1,type:"order",title:"Novo pedido recebido",message:'Você recebeu um novo pedido para "Counter-Strike 2"',timestamp:new Date(Date.now()-3e5),read:!1,link:"/orders"},{id:2,type:"message",title:"Nova mensagem",message:"João enviou uma pergunta sobre seu anúncio",timestamp:new Date(Date.now()-9e5),read:!1,link:"/dashboard"},{id:3,type:"favorite",title:"Anúncio favoritado",message:'Seu anúncio "Valorant" foi favoritado',timestamp:new Date(Date.now()-72e5),read:!0,link:"/dashboard"}];A(M),N(M.filter(X=>!X.read).length)}catch(M){console.error("Erro ao carregar notificações:",M)}},I=M=>{A(X=>X.map(te=>te.id===M?{...te,read:!0}:te)),N(X=>Math.max(0,X-1))},G=()=>{A(M=>M.map(X=>({...X,read:!0}))),N(0)},Q=M=>{const te=new Date-M,j=Math.floor(te/6e4),U=Math.floor(j/60),H=Math.floor(U/24);return H>0?`${H}d`:U>0?`${U}h`:j>0?`${j}m`:"agora"},re=(r==null?void 0:r.total_items)||0;return e.jsx("header",{className:"bg-white shadow-md sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx(q,{to:"/",className:"text-2xl font-bold text-blue-600 hover:text-blue-700 transition-colors",onClick:O,children:"GameUnite"}),e.jsx("div",{className:"hidden lg:flex flex-1 max-w-md mx-8",ref:C,children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar jogos...",value:p,onChange:M=>R(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onFocus:()=>{x.length>0&&k(!0)}}),m&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto z-50",children:v?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Buscando..."}):x.length>0?x.map(M=>e.jsx("button",{className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:outline-none focus:bg-gray-50",onClick:()=>V(M._id),children:e.jsxs("div",{className:"flex items-center",children:[M.image_url&&e.jsx("img",{src:M.image_url,alt:M.name,className:"w-10 h-10 rounded object-cover mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:M.name}),M.description&&e.jsx("div",{className:"text-sm text-gray-600 truncate",children:M.description})]})]})},M._id)):e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Nenhum jogo encontrado"})})]})}),e.jsxs("nav",{className:"hidden lg:flex items-center space-x-6",children:[e.jsx(q,{to:"/games",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Jogos"}),a?e.jsxs(e.Fragment,{children:[e.jsxs(q,{to:"/create-ad",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Anunciar"]}),e.jsxs(q,{to:"/cart",className:"relative p-2 text-gray-700 hover:text-blue-600 transition-colors",children:[e.jsx(Ge,{className:"w-6 h-6"}),re>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:re>9?"9+":re})]}),e.jsxs("div",{className:"relative",ref:$,children:[e.jsxs("button",{onClick:()=>g(!u),className:"relative p-2 text-gray-700 hover:text-blue-600 transition-colors",children:[e.jsx(Ye,{className:"w-6 h-6"}),w>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[20px] h-5 flex items-center justify-center",children:w>9?"9+":w})]}),u&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-[24rem] overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Notificações"}),w>0&&e.jsx("button",{onClick:G,className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"Marcar todas como lidas"})]}),e.jsx("div",{className:"max-h-72 overflow-y-auto",children:y.length>0?y.map(M=>e.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer ${M.read?"":"bg-blue-50"}`,onClick:()=>{M.read||I(M.id),l(M.link),g(!1)},children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full ${M.type==="order"?"bg-green-100 text-green-600":M.type==="message"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`,children:M.type==="order"?"🛒":M.type==="message"?"💬":"❤️"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:M.title}),e.jsx("span",{className:"text-xs text-gray-500",children:Q(M.timestamp)})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:M.message}),!M.read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"})]})]})},M.id)):e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx(Ye,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"Nenhuma notificação"})]})}),y.length>0&&e.jsx("div",{className:"p-3 border-t border-gray-200 text-center",children:e.jsx(q,{to:"/notifications",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",onClick:()=>g(!1),children:"Ver todas as notificações"})})]})]}),e.jsxs("div",{className:"relative",ref:E,children:[e.jsxs("button",{onClick:()=>h(!c),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:s!=null&&s.profile_pic?e.jsx("img",{src:s.profile_pic,alt:"Profile",className:"w-8 h-8 rounded-full object-cover"}):e.jsx(Z,{className:"w-5 h-5 text-gray-600"})}),e.jsx(na,{className:"w-4 h-4 text-gray-600"})]}),c&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg py-2 z-50",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["@",s==null?void 0:s.username]})]}),e.jsxs(q,{to:"/dashboard",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(zs,{className:"w-5 h-5 mr-3"}),"Dashboard"]}),e.jsxs(q,{to:"/profile",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(Z,{className:"w-5 h-5 mr-3"}),"Meu Perfil"]}),e.jsxs(q,{to:"/orders",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(we,{className:"w-5 h-5 mr-3"}),"Meus Pedidos"]}),e.jsxs(q,{to:"/favorites",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(fs,{className:"w-5 h-5 mr-3"}),"Favoritos"]}),e.jsxs(q,{to:"/support",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(Ye,{className:"w-5 h-5 mr-3"}),"Suporte"]}),(s==null?void 0:s.role)==="admin"&&e.jsxs(q,{to:"/admin",className:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors",onClick:O,children:[e.jsx(Us,{className:"w-5 h-5 mr-3"}),"Administração"]}),e.jsx("div",{className:"border-t border-gray-200 mt-2 pt-2",children:e.jsxs("button",{onClick:L,className:"flex items-center w-full px-4 py-3 text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(Ut,{className:"w-5 h-5 mr-3"}),"Sair"]})})]})]})]}):e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(q,{to:"/login",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Entrar"}),e.jsx(q,{to:"/register",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Cadastrar"})]})]}),e.jsx("button",{onClick:()=>i(!o),className:"lg:hidden p-2 text-gray-700 hover:text-blue-600 transition-colors",children:o?e.jsx(Se,{className:"w-6 h-6"}):e.jsx(sr,{className:"w-6 h-6"})})]}),o&&e.jsxs("div",{className:"lg:hidden border-t border-gray-200 py-4",children:[e.jsxs("div",{className:"mb-4",ref:C,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar jogos...",value:p,onChange:M=>R(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),m&&x.length>0&&e.jsx("div",{className:"mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:x.map(M=>e.jsx("button",{className:"w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",onClick:()=>V(M._id),children:e.jsx("div",{className:"font-medium text-gray-800",children:M.name})},M._id))})]}),e.jsxs("nav",{className:"space-y-2",children:[e.jsx(q,{to:"/games",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:"Jogos"}),a?e.jsxs(e.Fragment,{children:[e.jsxs(q,{to:"/create-ad",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(Ne,{className:"w-4 h-4 inline mr-2"}),"Criar Anúncio"]}),e.jsxs(q,{to:"/cart",className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Carrinho",re>0&&e.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:re})]}),e.jsxs(q,{to:"/dashboard",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(zs,{className:"w-4 h-4 inline mr-2"}),"Dashboard"]}),e.jsxs(q,{to:"/orders",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(we,{className:"w-4 h-4 inline mr-2"}),"Meus Pedidos"]}),e.jsxs(q,{to:"/favorites",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(fs,{className:"w-4 h-4 inline mr-2"}),"Favoritos"]}),e.jsxs(q,{to:"/support",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(Ye,{className:"w-4 h-4 inline mr-2"}),"Suporte"]}),(s==null?void 0:s.role)==="admin"&&e.jsxs(q,{to:"/admin",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(Us,{className:"w-4 h-4 inline mr-2"}),"Administração"]}),e.jsxs(q,{to:"/profile",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:[e.jsx(Z,{className:"w-4 h-4 inline mr-2"}),"Perfil"]}),e.jsxs("button",{onClick:L,className:"block w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(Ut,{className:"w-4 h-4 inline mr-2"}),"Sair"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{to:"/login",className:"block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",onClick:O,children:"Entrar"}),e.jsx(q,{to:"/register",className:"block px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors",onClick:O,children:"Cadastrar"})]})]})]})]})})},io=()=>e.jsx("footer",{className:"bg-gray-800 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"GameUnite"}),e.jsx("p",{className:"text-gray-400",children:"A plataforma que conecta gamers para compra, venda e troca de jogos."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Links Rápidos"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsx(q,{to:"/games",className:"text-gray-400 hover:text-white",children:"Jogos"})}),e.jsx("li",{children:e.jsx(q,{to:"/create-ad",className:"text-gray-400 hover:text-white",children:"Criar Anúncio"})}),e.jsx("li",{children:e.jsx(q,{to:"/dashboard",className:"text-gray-400 hover:text-white",children:"Dashboard"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Suporte"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Central de Ajuda"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Contato"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Termos de Uso"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Redes Sociais"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Facebook"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Twitter"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Instagram"})})]})]})]}),e.jsx("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center",children:e.jsx("p",{className:"text-gray-400",children:"© 2025 GameUnite. Todos os direitos reservados."})})]})}),ne=({children:s})=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(lo,{}),e.jsx("main",{className:"flex-1",children:s}),e.jsx(io,{})]}),ke={async getAds(s={}){var t,a;try{return{success:!0,data:(await z.get("/ads",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar anúncios"}}},async getBoostedAds(s={}){var t,a;try{return{success:!0,data:(await z.get("/ads/boosted",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar anúncios em destaque"}}},async getAd(s){var t,a;try{return{success:!0,data:(await z.get(`/ads/${s}`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar anúncio"}}},async createAd(s){var t,a;try{return{success:!0,data:(await z.post("/ads",s)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao criar anúncio"}}},async updateAd(s,t){var a,r;try{return{success:!0,message:(await z.put(`/ads/${s}`,t)).data.message}}catch(n){return{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao atualizar anúncio"}}},async deleteAd(s){var t,a;try{return{success:!0,message:(await z.delete(`/ads/${s}`)).data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao deletar anúncio"}}},async getMyAds(s={}){var t,a;try{return{success:!0,data:(await z.get("/ads/my-ads",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar seus anúncios"}}},async getUserAds(s,t={}){var a,r;try{return{success:!0,data:(await z.get(`/ads/user/${s}`,{params:t})).data.data}}catch(n){return{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao buscar anúncios do usuário"}}},async likeAd(s){var t,a;try{const r=await z.post(`/ads/${s}/like`);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao curtir anúncio"}}},async getAdLikes(s){var t,a;try{return{success:!0,data:(await z.get(`/ads/${s}/likes`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar curtidas"}}},async getAdForEdit(s){var t,a;try{return{success:!0,data:(await z.get(`/ads/${s}/edit`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar anúncio para edição"}}}},W=({size:s="md"})=>{const t={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-16 w-16"};return e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("div",{className:`animate-spin rounded-full border-b-2 border-blue-500 ${t[s]}`})})},co=()=>{const{featuredGames:s,loading:t}=Ss(),[a,r]=d.useState([]),[n,l]=d.useState(!1);return d.useEffect(()=>{(async()=>{l(!0);const i=await ke.getBoostedAds({limit:6});i.success&&r(i.data.boosted_ads),l(!1)})()},[]),e.jsxs("div",{className:"min-h-screen",children:[e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white py-20",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-5xl font-bold mb-6",children:"Bem-vindo ao GameUnite"}),e.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto",children:"A plataforma que conecta gamers para compra, venda e troca de jogos. Encontre os melhores preços e faça parte da maior comunidade gamer do Brasil."}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(q,{to:"/games",className:"bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors inline-block",children:"Explorar Jogos"}),e.jsx(q,{to:"/register",className:"border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-blue-600 transition-colors inline-block",children:"Começar Agora"})]})]})}),e.jsx("section",{className:"py-16 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:[e.jsx(Ae,{className:"inline w-8 h-8 mr-2 text-yellow-500"}),"Jogos em Destaque"]}),e.jsx("p",{className:"text-gray-600",children:"Os jogos mais populares da nossa plataforma"})]}),t?e.jsx(W,{size:"lg"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(o=>e.jsxs(q,{to:`/games/${o._id}`,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:o.image_url?e.jsx("img",{src:o.image_url,alt:o.name,className:"w-full h-full object-cover"}):e.jsx(ze,{className:"w-16 h-16 text-gray-400"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:o.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:o.description})]})]},o._id))})]})}),e.jsx("section",{className:"py-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:[e.jsx(Fe,{className:"inline w-8 h-8 mr-2 text-green-500"}),"Anúncios em Destaque"]}),e.jsx("p",{className:"text-gray-600",children:"As melhores ofertas da semana"})]}),n?e.jsx(W,{size:"lg"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(o=>e.jsxs(q,{to:`/ads/${o._id}`,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow border-2 border-yellow-400",children:[e.jsx("div",{className:"bg-yellow-400 text-yellow-800 px-3 py-1 text-sm font-semibold",children:"⭐ DESTAQUE"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:o.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:o.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["R$ ",o.price]}),e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:o.ad_type})]})]})]},o._id))})]})}),e.jsx("section",{className:"bg-blue-600 text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Pronto para começar?"}),e.jsx("p",{className:"text-xl mb-8",children:"Junte-se a milhares de gamers e encontre os melhores jogos!"}),e.jsx(q,{to:"/register",className:"bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors inline-block",children:"Criar Conta Grátis"})]})})]})};function Ha(s){var t,a,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var n=s.length;for(t=0;t<n;t++)s[t]&&(a=Ha(s[t]))&&(r&&(r+=" "),r+=a)}else for(a in s)s[a]&&(r&&(r+=" "),r+=a);return r}function ss(){for(var s,t,a=0,r="",n=arguments.length;a<n;a++)(s=arguments[a])&&(t=Ha(s))&&(r&&(r+=" "),r+=t);return r}const F=({children:s,variant:t="primary",size:a="md",loading:r=!1,disabled:n=!1,className:l="",...o})=>{const i="font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 inline-flex items-center justify-center",c={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-blue-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},h={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"};return e.jsx("button",{className:ss(i,c[t],h[a],{"opacity-50 cursor-not-allowed":n||r},l),disabled:n||r,...o,children:r?e.jsxs("div",{className:"inline-flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Carregando..."]}):s})},mo=()=>{const{games:s,loading:t,fetchGames:a}=Ss(),[r,n]=d.useState(""),[l,o]=d.useState([]),[i,c]=d.useState(!1);d.useEffect(()=>{s.length===0&&a()},[s,a]),d.useEffect(()=>{const u=s.filter(g=>g.name.toLowerCase().includes(r.toLowerCase()));o(u)},[s,r]);const h=u=>{u.preventDefault(),a({search:r})};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Catálogo de Jogos"}),e.jsx("p",{className:"text-gray-600",children:"Explore nossa biblioteca de jogos e encontre anúncios de compra, venda e troca"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[e.jsxs("form",{onSubmit:h,className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar jogos...",value:r,onChange:u=>n(u.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx(F,{type:"submit",children:"Buscar"}),e.jsxs(F,{type:"button",variant:"outline",onClick:()=>c(!i),children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Filtros"]})]}),i&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gênero"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos os gêneros"}),e.jsx("option",{value:"action",children:"Ação"}),e.jsx("option",{value:"adventure",children:"Aventura"}),e.jsx("option",{value:"rpg",children:"RPG"}),e.jsx("option",{value:"sports",children:"Esportes"}),e.jsx("option",{value:"racing",children:"Corrida"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataforma"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todas as plataformas"}),e.jsx("option",{value:"pc",children:"PC"}),e.jsx("option",{value:"ps5",children:"PlayStation 5"}),e.jsx("option",{value:"ps4",children:"PlayStation 4"}),e.jsx("option",{value:"xbox",children:"Xbox"}),e.jsx("option",{value:"switch",children:"Nintendo Switch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordenar por"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"name",children:"Nome"}),e.jsx("option",{value:"popularity",children:"Popularidade"}),e.jsx("option",{value:"newest",children:"Mais recentes"})]})]})]})})]}),t?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(W,{size:"lg"})}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ze,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum jogo encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Tente ajustar os filtros ou termo de busca"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(u=>e.jsxs(q,{to:`/games/${u._id}`,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:u.image_url?e.jsx("img",{src:u.image_url,alt:u.name,className:"w-full h-full object-cover"}):e.jsx(ze,{className:"w-16 h-16 text-gray-400"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-gray-800",children:u.name}),u.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:u.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"Ver anúncios"}),u.is_featured&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full",children:"⭐ Destaque"})]})]})]},u._id))}),l.length>0&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(F,{variant:"outline",disabled:!0,children:"Anterior"}),e.jsx(F,{children:"1"}),e.jsx(F,{variant:"outline",children:"2"}),e.jsx(F,{variant:"outline",children:"3"}),e.jsx(F,{variant:"outline",children:"Próximo"})]})})]})})},kt={async getFavorites(s={}){var t,a;try{return{success:!0,data:(await z.get("/favorites",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar favoritos"}}},async addToFavorites(s){var t,a;try{const r=await z.post(`/favorites/${s}`);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao adicionar aos favoritos"}}},async removeFromFavorites(s){var t,a;try{return{success:!0,message:(await z.delete(`/favorites/${s}`)).data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao remover dos favoritos"}}},async toggleFavorite(s){var t,a;try{const r=await z.post(`/favorites/${s}/toggle`);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao alterar favorito"}}},async checkIsFavorite(s){var t,a,r;try{return{success:!0,data:(await z.get(`/favorites/${s}/check`)).data.data}}catch(n){return((t=n.response)==null?void 0:t.status)===401?{success:!0,data:{is_favorited:!1}}:{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao verificar favorito"}}}},$e={async createOrder(s){var t,a;try{const r=await z.post("/orders",s);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao criar pedido"}}},async processCheckout(s){var t,a;try{const r=await z.post("/orders/checkout",s);return{success:!0,data:r.data.data,message:r.data.message}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro no checkout"}}},async checkout(s){return this.processCheckout(s)},async getOrders(s={}){var t,a;try{return{success:!0,data:(await z.get("/orders",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar pedidos"}}},async getOrder(s){var t,a;try{return{success:!0,data:(await z.get(`/orders/${s}`)).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar pedido"}}},async updateOrderStatus(s,t,a=null){var r,n;try{return{success:!0,message:(await z.put(`/orders/${s}/status`,{status:t,role:a})).data.message}}catch(l){return{success:!1,message:((n=(r=l.response)==null?void 0:r.data)==null?void 0:n.message)||"Erro ao atualizar status"}}},async getOrderStats(){var s,t;try{return{success:!0,data:(await z.get("/orders/stats")).data.data}}catch(a){return{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao buscar estatísticas"}}},async getSales(s={}){var t,a;try{return{success:!0,data:(await z.get("/orders/sales",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar vendas"}}},async getPurchases(s={}){var t,a;try{return{success:!0,data:(await z.get("/orders/purchases",{params:s})).data.data}}catch(r){return{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao buscar compras"}}}},_e={async createTicket(s){var t,a;try{const r=await z.post("/support/tickets",s);return{success:!0,data:r.data.data||r.data,message:r.data.message||"Ticket criado com sucesso"}}catch(r){return console.error("❌ Error creating ticket:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao criar ticket"}}},async getUserTickets(s={}){var t,a;try{const r=await z.get("/support/tickets",{params:s});return{success:!0,data:r.data.data||r.data,message:r.data.message||"Tickets carregados com sucesso"}}catch(r){return console.error("❌ Error fetching tickets:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao carregar tickets",data:{tickets:[]}}}},async getTicketByProtocol(s){var t,a;try{return{success:!0,data:(await z.get(`/support/tickets/protocol/${s}`)).data,message:"Ticket encontrado"}}catch(r){return console.error("❌ Error finding ticket:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Ticket não encontrado"}}},async getTicketById(s){var t,a;try{const r=await z.get(`/support/tickets/${s}`);return{success:!0,data:r.data.data||r.data,message:"Ticket encontrado"}}catch(r){return console.error("❌ Error fetching ticket:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Ticket não encontrado"}}},async addTicketReply(s,t){var a,r;try{const n=await z.post(`/support/tickets/${s}/reply`,{message:t});return{success:!0,data:n.data.data||n.data,message:"Mensagem adicionada com sucesso"}}catch(n){return console.error("❌ Error adding reply:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||n.message||"Erro ao adicionar mensagem"}}},async updateTicketStatus(s,t){var a,r;try{return{success:!0,data:(await z.patch(`/support/tickets/${s}/status`,{status:t})).data,message:"Status atualizado com sucesso"}}catch(n){return console.error("❌ Error updating ticket status:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||n.message||"Erro ao atualizar status"}}},async getAllTickets(s={}){var t,a;try{const r=await z.get("/support/admin/tickets",{params:s});return{success:!0,data:r.data.data||r.data,message:r.data.message||"Tickets carregados com sucesso"}}catch(r){return console.error("❌ Error fetching admin tickets:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao carregar tickets",data:{tickets:[]}}}},async updateTicket(s,t){var a,r;try{const n=await z.put(`/support/admin/tickets/${s}`,t);return{success:!0,data:n.data.data||n.data,message:n.data.message||"Ticket atualizado com sucesso"}}catch(n){return console.error("❌ Error updating admin ticket:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||n.message||"Erro ao atualizar ticket"}}},createGame:s=>z.post("/support/admin/games",s),updateGame:(s,t)=>z.put(`/support/admin/games/${s}`,t),deleteGame:s=>z.delete(`/support/admin/games/${s}`),getCategories:()=>z.get("/support/admin/categories"),createCategory:s=>z.post("/support/admin/categories",s),updateCategory:(s,t)=>z.put(`/support/admin/categories/${s}`,t),deleteCategory:s=>z.delete(`/support/admin/categories/${s}`),submitRating:(s,t)=>z.post(`/support/ratings/${s}`,t),async getAdminStats(){var s,t;try{const a=await z.get("/support/admin/stats");return{success:!0,data:a.data.data||a.data,message:a.data.message||"Estatísticas carregadas com sucesso"}}catch(a){return console.error("❌ Error fetching admin stats:",a),{success:!1,message:((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||a.message||"Erro ao carregar estatísticas",data:{}}}},validateTicketData(s){var a,r;const t=[];return(!s.subject||s.subject.trim().length<5)&&t.push("Assunto deve ter pelo menos 5 caracteres"),(!s.message||s.message.trim().length<10)&&t.push("Mensagem deve ter pelo menos 10 caracteres"),["general","technical","billing","account"].includes(s.category)||t.push("Categoria inválida"),["low","medium","high","urgent"].includes(s.priority)||t.push("Prioridade inválida"),{isValid:t.length===0,errors:t,data:{subject:(a=s.subject)==null?void 0:a.trim(),message:(r=s.message)==null?void 0:r.trim(),category:s.category,priority:s.priority}}}},uo=()=>{const{gameId:s}=ts(),[t,a]=d.useState(null),[r,n]=d.useState([]),[l,o]=d.useState(!0),[i,c]=d.useState(!1),[h,u]=d.useState("all"),[g,p]=d.useState("asc");d.useEffect(()=>{const x=async()=>{o(!0);const m=await Ct.getGame(s);m.success?a(m.data.game):S.error(m.message),o(!1)},f=async()=>{c(!0);const m=await ke.getAds({game_id:s});m.success?n(m.data.ads):S.error(m.message),c(!1)};x(),f()},[s]);const R=r.filter(x=>h==="all"||x.ad_type===h).sort((x,f)=>g==="asc"?(x.price||0)-(f.price||0):(f.price||0)-(x.price||0));return l?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:e.jsxs("div",{className:"md:flex",children:[e.jsx("div",{className:"md:flex-shrink-0",children:e.jsx("div",{className:"h-48 w-full md:h-full md:w-48 bg-gray-200 flex items-center justify-center",children:t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}):e.jsx(ze,{className:"w-16 h-16 text-gray-400"})})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mr-4",children:t.name}),t.is_featured&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm flex items-center",children:[e.jsx(Ae,{className:"w-4 h-4 mr-1 fill-current"}),"Destaque"]})]}),t.description&&e.jsx("p",{className:"text-gray-700 mb-6 leading-relaxed",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-4",children:e.jsx(q,{to:`/create-ad?game=${s}`,children:e.jsxs(F,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Criar Anúncio para este Jogo"]})})})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800",children:["Anúncios para ",t.name," (",R.length,")"]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("select",{value:h,onChange:x=>u(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),e.jsx("option",{value:"venda",children:"Venda"}),e.jsx("option",{value:"troca",children:"Troca"}),e.jsx("option",{value:"procura",children:"Procura"})]}),e.jsxs("select",{value:g,onChange:x=>p(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"asc",children:"Menor preço"}),e.jsx("option",{value:"desc",children:"Maior preço"})]})]})]}),i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(W,{})}):R.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mb-4",children:e.jsx(ze,{className:"w-16 h-16 text-gray-300 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum anúncio encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.length===0?"Seja o primeiro a criar um anúncio para este jogo!":"Nenhum anúncio corresponde aos filtros selecionados."}),e.jsx(q,{to:`/create-ad?game=${s}`,children:e.jsxs(F,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Criar Anúncio"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map(x=>e.jsxs(q,{to:`/ads/${x._id}`,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[x.image_url&&e.jsx("div",{className:"mb-3",children:e.jsx("img",{src:x.image_url,alt:x.title,className:"w-full h-32 object-cover rounded"})}),e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-800 line-clamp-2 flex-1 mr-2",children:x.title}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x.ad_type==="venda"?"bg-green-100 text-green-800":x.ad_type==="troca"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:x.ad_type}),x.is_boosted&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⭐"})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:x.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[x.price&&e.jsxs("span",{className:"text-xl font-bold text-green-600",children:["R$ ",x.price]}),e.jsx("span",{className:"text-gray-500",children:x.platform})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-gray-500",children:new Date(x.created_at).toLocaleDateString("pt-BR")}),e.jsxs("span",{className:"text-gray-400 text-xs",children:[x.view_count," views"]})]})]})]},x._id))})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Jogo não encontrado"}),e.jsx(q,{to:"/games",className:"text-blue-600 hover:text-blue-800",children:"Voltar para catálogo"})]})})},xo=()=>{const{login:s}=xe(),t=be(),a=Et(),[r,n]=d.useState(!1),[l,o]=d.useState(!1),{register:i,handleSubmit:c,formState:{errors:h}}=Xe(),u=async g=>{var R,x;o(!0);const p=await s(g.email,g.password);if(p.success){S.success("Login realizado com sucesso!");const f=((x=(R=a.state)==null?void 0:R.from)==null?void 0:x.pathname)||"/dashboard";t(f,{replace:!0})}else S.error(p.message);o(!1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Entrar na sua conta"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Ou"," ",e.jsx(q,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"crie uma conta gratuita"})]})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c(u),children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Be,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...i("email",{required:"Email é obrigatório",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Email inválido"}}),type:"email",className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${h.email?"border-red-300":"border-gray-300"}`,placeholder:"seu@email.com"})]}),h.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(js,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...i("password",{required:"Senha é obrigatória",minLength:{value:6,message:"Senha deve ter pelo menos 6 caracteres"}}),type:r?"text":"password",className:`block w-full pl-10 pr-10 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${h.password?"border-red-300":"border-gray-300"}`,placeholder:"Sua senha"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>n(!r),className:"text-gray-400 hover:text-gray-600",children:r?e.jsx(bs,{className:"h-5 w-5"}):e.jsx(ue,{className:"h-5 w-5"})})})]}),h.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.password.message})]})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"text-sm",children:e.jsx(q,{to:"/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"Esqueceu sua senha?"})})}),e.jsx("div",{children:e.jsx(F,{type:"submit",loading:l,className:"w-full",size:"lg",children:"Entrar"})})]})]})})},ho=()=>{const{register:s}=xe(),t=be(),[a,r]=d.useState(!1),[n,l]=d.useState(!1),[o,i]=d.useState(!1),{register:c,handleSubmit:h,watch:u,formState:{errors:g}}=Xe(),p=u("password"),R=async x=>{i(!0);const f=await s({username:x.username,email:x.email,password:x.password,first_name:x.first_name,last_name:x.last_name});f.success?(S.success("Conta criada com sucesso! Faça login para continuar."),t("/login")):S.error(f.message),i(!1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Criar nova conta"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Ou"," ",e.jsx(q,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"faça login na sua conta existente"})]})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h(R),children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("input",{...c("first_name",{required:"Nome é obrigatório"}),type:"text",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.first_name?"border-red-300":"border-gray-300"}`,placeholder:"Nome"}),g.first_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Sobrenome"}),e.jsx("input",{...c("last_name",{required:"Sobrenome é obrigatório"}),type:"text",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.last_name?"border-red-300":"border-gray-300"}`,placeholder:"Sobrenome"}),g.last_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.last_name.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Nome de usuário"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Z,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...c("username",{required:"Nome de usuário é obrigatório",minLength:{value:3,message:"Nome de usuário deve ter pelo menos 3 caracteres"}}),type:"text",className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.username?"border-red-300":"border-gray-300"}`,placeholder:"seunomeusuario"})]}),g.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Be,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...c("email",{required:"Email é obrigatório",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Email inválido"}}),type:"email",className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.email?"border-red-300":"border-gray-300"}`,placeholder:"seu@email.com"})]}),g.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(js,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...c("password",{required:"Senha é obrigatória",minLength:{value:6,message:"Senha deve ter pelo menos 6 caracteres"}}),type:a?"text":"password",className:`block w-full pl-10 pr-10 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.password?"border-red-300":"border-gray-300"}`,placeholder:"Sua senha"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>r(!a),className:"text-gray-400 hover:text-gray-600",children:a?e.jsx(bs,{className:"h-5 w-5"}):e.jsx(ue,{className:"h-5 w-5"})})})]}),g.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.password.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirmar Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(js,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{...c("confirmPassword",{required:"Confirmação de senha é obrigatória",validate:x=>x===p||"Senhas não coincidem"}),type:n?"text":"password",className:`block w-full pl-10 pr-10 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${g.confirmPassword?"border-red-300":"border-gray-300"}`,placeholder:"Confirme sua senha"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>l(!n),className:"text-gray-400 hover:text-gray-600",children:n?e.jsx(bs,{className:"h-5 w-5"}):e.jsx(ue,{className:"h-5 w-5"})})})]}),g.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.confirmPassword.message})]})]}),e.jsx("div",{children:e.jsx(F,{type:"submit",loading:o,className:"w-full",size:"lg",children:"Criar Conta"})}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Ao criar uma conta, você concorda com nossos"," ",e.jsx(q,{to:"/terms",className:"text-blue-600 hover:text-blue-500",children:"Termos de Uso"})," ","e"," ",e.jsx(q,{to:"/privacy",className:"text-blue-600 hover:text-blue-500",children:"Política de Privacidade"})]})]})]})})},qe={async getAdQuestions(s){var t,a;try{if(console.log("🔍 Buscando perguntas para anúncio:",s),!s)throw new Error("ID do anúncio é obrigatório");const r=await z.get(`/ad-questions/ad/${s}/questions`);return console.log("📥 Resposta das perguntas:",r.data),{success:r.data.success||!0,data:r.data.data||r.data,message:r.data.message||"Perguntas carregadas"}}catch(r){return console.error("❌ Erro ao buscar perguntas:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao carregar perguntas",data:{questions:[]}}}},async askQuestion(s,t,a=!0){var r,n;try{if(console.log("📤 Enviando pergunta:",{adId:s,question:t,isPublic:a}),!s||!t)throw new Error("ID do anúncio e pergunta são obrigatórios");if(t.trim().length<10)throw new Error("Pergunta deve ter pelo menos 10 caracteres");const l={question:t.trim(),is_public:a};console.log("📦 Dados da requisição:",l);const o=await z.post(`/ad-questions/ad/${s}/question`,l);return console.log("📥 Resposta do envio:",o.data),{success:o.data.success||!0,data:o.data.data||o.data,message:o.data.message||"Pergunta enviada com sucesso"}}catch(l){return console.error("❌ Erro ao enviar pergunta:",l),l.response&&(console.error("Dados da resposta de erro:",l.response.data),console.error("Status do erro:",l.response.status)),{success:!1,message:((n=(r=l.response)==null?void 0:r.data)==null?void 0:n.message)||l.message||"Erro ao enviar pergunta"}}},async answerQuestion(s,t){var a,r;try{if(console.log("📤 Enviando resposta:",{questionId:s,answer:t}),!s||!t)throw new Error("ID da pergunta e resposta são obrigatórios");if(t.trim().length<5)throw new Error("Resposta deve ter pelo menos 5 caracteres");const n={answer:t.trim()},l=await z.post(`/ad-questions/question/${s}/answer`,n);return console.log("📥 Resposta do envio da resposta:",l.data),{success:l.data.success||!0,data:l.data.data||l.data,message:l.data.message||"Resposta enviada com sucesso"}}catch(n){return console.error("❌ Erro ao enviar resposta:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||n.message||"Erro ao enviar resposta"}}},async deleteQuestion(s){var t,a;try{if(console.log("🗑️ Deletando pergunta:",s),!s)throw new Error("ID da pergunta é obrigatório");const r=await z.delete(`/ad-questions/question/${s}`);return console.log("📥 Resposta da deleção:",r.data),{success:r.data.success||!0,message:r.data.message||"Pergunta deletada com sucesso"}}catch(r){return console.error("❌ Erro ao deletar pergunta:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao deletar pergunta"}}},async toggleQuestionVisibility(s){var t,a;try{if(console.log("👁️ Alterando visibilidade:",s),!s)throw new Error("ID da pergunta é obrigatório");const r=await z.put(`/ad-questions/question/${s}/visibility`);return console.log("📥 Resposta da alteração:",r.data),{success:r.data.success||!0,data:r.data.data||r.data,message:r.data.message||"Visibilidade alterada com sucesso"}}catch(r){return console.error("❌ Erro ao alterar visibilidade:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao alterar visibilidade"}}},async getUserQuestions(s="asked"){var t,a;try{if(console.log("🔍 Buscando perguntas do usuário:",s),!["asked","answered"].includes(s))throw new Error('Tipo deve ser "asked" ou "answered"');const r=await z.get(`/ad-questions/user/questions?type=${s}`);return console.log("📥 Perguntas do usuário:",r.data),{success:r.data.success||!0,data:r.data.data||r.data,message:r.data.message||"Perguntas carregadas"}}catch(r){return console.error("❌ Erro ao buscar perguntas do usuário:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao carregar perguntas",data:{questions:[]}}}},async getMyAdQuestions(s={}){var t,a;try{console.log("🔍 Buscando perguntas dos meus anúncios:",s);const r=await z.get("/ad-questions/my-questions",{params:s});return console.log("📥 Perguntas dos meus anúncios:",r.data),{success:r.data.success||!0,data:r.data.data||r.data,message:r.data.message||"Perguntas carregadas"}}catch(r){return console.error("❌ Erro ao buscar perguntas dos meus anúncios:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message||"Erro ao carregar perguntas",data:{questions:[]}}}},async debugConnection(){try{console.log("🔧 Testando conexão com API de perguntas...");const s=await z.get("/health");return console.log("✅ Conexão OK:",s.data),{success:!0,message:"Conexão estabelecida",data:s.data}}catch(s){return console.error("❌ Falha na conexão:",s),{success:!1,message:"Falha na conexão com a API",error:s.message}}},validateQuestionData(s,t){const a=[];if(!s||typeof s!="string")a.push("Pergunta deve ser um texto válido");else{const r=s.trim();r.length<10&&a.push("Pergunta deve ter pelo menos 10 caracteres"),r.length>500&&a.push("Pergunta não pode ter mais de 500 caracteres")}return typeof t!="boolean"&&a.push("Visibilidade deve ser verdadeiro ou falso"),{isValid:a.length===0,errors:a,data:{question:s==null?void 0:s.trim(),is_public:t}}},validateAnswerData(s){const t=[];if(!s||typeof s!="string")t.push("Resposta deve ser um texto válido");else{const a=s.trim();a.length<5&&t.push("Resposta deve ter pelo menos 5 caracteres"),a.length>1e3&&t.push("Resposta não pode ter mais de 1000 caracteres")}return{isValid:t.length===0,errors:t,data:{answer:s==null?void 0:s.trim()}}}},K=({children:s,variant:t="default",size:a="default",className:r="",...n})=>{const l={default:"bg-gray-100 text-gray-800",primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"},o={sm:"px-2 py-1 text-xs",default:"px-2.5 py-0.5 text-sm",lg:"px-3 py-1 text-base"};return e.jsx("span",{className:ss("inline-flex items-center font-medium rounded-full",l[t],o[a],r),...n,children:s})},go=()=>{xe();const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState("all"),[o,i]=d.useState(null),[c,h]=d.useState(""),[u,g]=d.useState(!1);d.useEffect(()=>{p()},[]),d.useEffect(()=>{p()},[n]);const p=async()=>{r(!0);try{const v=await qe.getMyAdQuestions({limit:50,skip:0,status:n==="all"?void 0:n});v.success?t(v.data.questions||[]):S.error(v.message)}catch(v){console.error("Erro ao carregar perguntas:",v),S.error("Erro ao carregar perguntas")}r(!1)},R=async v=>{if(!c.trim()){S.error("Digite uma resposta");return}g(!0);try{const b=await qe.answerQuestion(v,c);b.success?(t(y=>y.map(A=>A._id===v?{...A,answer:c,status:"answered",answered_at:new Date().toISOString(),updated_at:new Date().toISOString()}:A)),S.success("Resposta enviada com sucesso!"),i(null),h("")):S.error(b.message)}catch{S.error("Erro ao enviar resposta")}g(!1)},x=v=>{const b=new Date(v),A=new Date-b,w=Math.floor(A/6e4),N=Math.floor(w/60),C=Math.floor(N/24);return C>0?`${C} dia${C>1?"s":""} atrás`:N>0?`${N} hora${N>1?"s":""} atrás`:w>0?`${w} minuto${w>1?"s":""} atrás`:"Agora mesmo"},f=s.filter(v=>n==="pending"?v.status==="pending":n==="answered"?v.status==="answered":!0),k=(()=>({all:s.length,pending:s.filter(v=>v.status==="pending").length,answered:s.filter(v=>v.status==="answered").length}))();return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(W,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ie,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Perguntas dos Anúncios"}),e.jsxs("p",{className:"text-gray-600",children:[k.pending," pendente",k.pending!==1?"s":""," de ",k.all," total"]})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"Todas",count:k.all},{key:"pending",label:"Pendentes",count:k.pending},{key:"answered",label:"Respondidas",count:k.answered}].map(v=>e.jsxs("button",{onClick:()=>l(v.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===v.key?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[v.label," (",v.count,")"]},v.key))}),e.jsx("div",{className:"space-y-4",children:f.length>0?f.map(v=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-l-blue-500",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:v.user.profile_pic?e.jsx("img",{src:v.user.profile_pic,alt:v.user.username,className:"w-10 h-10 rounded-full object-cover"}):e.jsx(Z,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[v.user.first_name," ",v.user.last_name]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["@",v.user.username]})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Pergunta sobre:"}),e.jsx("h3",{className:"font-semibold text-gray-800",children:v.ad_title})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{variant:v.status==="pending"?"warning":"success",children:v.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),"Pendente"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"Respondida"]})}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),x(v.created_at)]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-800",children:v.question})})}),v.status==="answered"?e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-blue-600 font-medium mb-1",children:["Sua resposta • ",x(v.answered_at)]}),e.jsx("p",{className:"text-gray-800",children:v.answer})]})]})}):e.jsx("div",{className:"border-t border-gray-200 pt-4",children:o===v._id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:c,onChange:b=>h(b.target.value),placeholder:"Digite sua resposta...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(F,{onClick:()=>R(v._id),disabled:u||!c.trim(),size:"sm",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),u?"Enviando...":"Enviar Resposta"]}),e.jsx(F,{variant:"outline",onClick:()=>{i(null),h("")},size:"sm",children:"Cancelar"})]})]}):e.jsxs(F,{onClick:()=>i(v._id),variant:"outline",size:"sm",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Responder"]})})]},v._id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:n==="pending"?"Nenhuma pergunta pendente":n==="answered"?"Nenhuma pergunta respondida":"Nenhuma pergunta encontrada"}),e.jsx("p",{className:"text-gray-600",children:n==="all"?"Ainda não há perguntas nos seus anúncios":"Altere o filtro para ver outras perguntas"})]})})]})},po=()=>{var _;const{user:s}=xe(),t=be(),a=Et(),[r,n]=d.useState("overview"),[l,o]=d.useState(null),[i,c]=d.useState([]),[h,u]=d.useState([]),[g,p]=d.useState(null),[R,x]=d.useState(!0),[f,m]=d.useState(!1),[k,v]=d.useState(!1),b=[{id:"overview",label:"Visão Geral",icon:Fe},{id:"ads",label:"Meus Anúncios",icon:pe},{id:"questions",label:"Perguntas",icon:ie},{id:"sales",label:"Vendas",icon:He},{id:"purchases",label:"Compras",icon:we},{id:"profile",label:"Perfil",icon:Ue}];d.useEffect(()=>{const V=new URLSearchParams(a.search).get("tab");V&&b.some(O=>O.id===V)&&n(V)},[a]),d.useEffect(()=>{y()},[]),d.useEffect(()=>{r==="ads"?A():(r==="sales"||r==="purchases")&&w()},[r]);const y=async()=>{x(!0);try{const L=await es.getDashboardData();L.success&&o(L.data);const V=await $e.getOrderStats();V.success&&p(V.data)}catch{S.error("Erro ao carregar dados do dashboard")}x(!1)},A=async()=>{m(!0);const L=await ke.getMyAds();L.success&&c(L.data.ads),m(!1)},w=async()=>{v(!0);try{let L;r==="sales"?L=await $e.getSales():L=await $e.getPurchases(),L.success&&u(L.data.sales||L.data.purchases||[])}catch{S.error("Erro ao carregar pedidos")}v(!1)},N=L=>{t(`/ads/${L}/edit`)},C=async L=>{if(window.confirm("Tem certeza que deseja excluir este anúncio?")){m(!0);const V=await ke.deleteAd(L);V.success?(S.success("Anúncio excluído com sucesso!"),c(i.filter(O=>O._id!==L)),y()):S.error(V.message),m(!1)}},E=L=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[L]||"bg-gray-100 text-gray-800",$=L=>{const O={pending:ce,paid:ge,shipped:pe,delivered:ge,cancelled:Qe}[L]||ce;return e.jsx(O,{className:"w-4 h-4"})},P=()=>{var L,V,O,D,I,G,Q,re,M,X;switch(r){case"overview":return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:e.jsx(pe,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Anúncios Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((L=l==null?void 0:l.stats)==null?void 0:L.active_ads)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100",children:e.jsx(He,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((V=g==null?void 0:g.seller_stats)==null?void 0:V.delivered)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100",children:e.jsx(we,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Compras"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((O=g==null?void 0:g.buyer_stats)==null?void 0:O.delivered)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-yellow-100",children:e.jsx(ue,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Visualizações"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((D=l==null?void 0:l.stats)==null?void 0:D.total_views)||0})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Ações Rápidas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(q,{to:"/create-ad",children:e.jsxs(F,{className:"w-full flex items-center justify-center",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Criar Novo Anúncio"]})}),e.jsx(q,{to:"/orders",children:e.jsxs(F,{variant:"outline",className:"w-full flex items-center justify-center",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Ver Todos os Pedidos"]})}),e.jsx(q,{to:"/profile",children:e.jsxs(F,{variant:"outline",className:"w-full flex items-center justify-center",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Editar Perfil"]})})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"💰 Como Vendedor"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total de Vendas:"}),e.jsxs("span",{className:"font-medium",children:["R$ ",((I=g.total_revenue)==null?void 0:I.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Pedidos Pendentes:"}),e.jsx("span",{className:"font-medium",children:((G=g.seller_stats)==null?void 0:G.pending)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Pedidos Entregues:"}),e.jsx("span",{className:"font-medium",children:((Q=g.seller_stats)==null?void 0:Q.delivered)||0})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🛒 Como Comprador"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Gasto:"}),e.jsxs("span",{className:"font-medium",children:["R$ ",((re=g.total_spent)==null?void 0:re.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Pedidos Pendentes:"}),e.jsx("span",{className:"font-medium",children:((M=g.buyer_stats)==null?void 0:M.pending)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Pedidos Recebidos:"}),e.jsx("span",{className:"font-medium",children:((X=g.buyer_stats)==null?void 0:X.delivered)||0})]})]})]})]})]});case"ads":return e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Meus Anúncios"}),e.jsx(q,{to:"/create-ad",children:e.jsxs(F,{size:"sm",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Novo Anúncio"]})})]})}),f?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(W,{})}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum anúncio encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece criando seu primeiro anúncio para vender jogos."}),e.jsx(q,{to:"/create-ad",children:e.jsxs(F,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Criar Primeiro Anúncio"]})})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Anúncio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preço"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Views"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(j=>{var U;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[j.image_url&&e.jsx("img",{src:j.image_url,alt:j.title,className:"w-12 h-12 rounded object-cover mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(U=j.game)==null?void 0:U.name," • ",j.platform]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${j.ad_type==="venda"?"bg-green-100 text-green-800":j.ad_type==="troca"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:j.ad_type.charAt(0).toUpperCase()+j.ad_type.slice(1)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.price?`R$ ${j.price}`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${j.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.status==="active"?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.view_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(q,{to:`/ads/${j._id}`,className:"text-blue-600 hover:text-blue-900",title:"Ver anúncio",children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-yellow-600 hover:text-yellow-900",title:"Editar anúncio",onClick:()=>N(j._id),disabled:f,children:e.jsx(ys,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-red-600 hover:text-red-900",title:"Excluir anúncio",onClick:()=>C(j._id),disabled:f,children:e.jsx(Re,{className:"w-4 h-4"})})]})})]},j._id)})})]})})]});case"sales":case"purchases":const te=r==="sales";return e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:te?"Minhas Vendas":"Minhas Compras"}),e.jsx("p",{className:"text-gray-600 mt-1",children:te?"Pedidos onde você é o vendedor":"Pedidos onde você é o comprador"})]}),k?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(W,{})}):h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Nenhum ",te?"venda":"compra"," encontrada"]}),e.jsx("p",{className:"text-gray-600",children:te?"Quando alguém comprar seus anúncios, eles aparecerão aqui.":"Quando você fizer uma compra, ela aparecerá aqui."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:te?"Comprador":"Vendedor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(j=>{var U,H,Y,ee,ve,Pe;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:(U=j.ad_snapshot)==null?void 0:U.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(H=j.ad_snapshot)==null?void 0:H.game_name," • Qtd: ",j.quantity]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[(Y=j.other_user)==null?void 0:Y.first_name," ",(ee=j.other_user)==null?void 0:ee.last_name]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["@",(ve=j.other_user)==null?void 0:ve.username]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["R$ ",(Pe=j.total_price)==null?void 0:Pe.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${E(j.status)}`,children:[$(j.status),e.jsx("span",{className:"ml-1",children:j.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(j.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx(q,{to:`/orders/${j._id}`,className:"text-blue-600 hover:text-blue-900",children:"Ver Detalhes"})})]},j._id)})})]})})]});case"questions":return e.jsx(go,{});case"profile":return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Configurações do Perfil"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Configure suas informações pessoais e preferências."}),e.jsx(q,{to:"/profile",children:e.jsxs(F,{children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Ir para Perfil Completo"]})})]})]});default:return e.jsx("div",{children:"Tab não encontrada"})}};return R?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Olá, ",((_=l==null?void 0:l.user)==null?void 0:_.first_name)||(s==null?void 0:s.username),"! Gerencie seus anúncios e pedidos"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6 overflow-x-auto",children:b.map(L=>{const V=L.icon;return e.jsxs("button",{onClick:()=>n(L.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 whitespace-nowrap ${r===L.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:L.label})]},L.id)})})})}),P()]})})},Me=({isOpen:s,onClose:t,title:a,children:r,footer:n,size:l="md",closeOnBackdrop:o=!0})=>{if(!s)return null;const i={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-full mx-4"},c=h=>{o&&h.target===h.currentTarget&&t()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-8 p-4 bg-black bg-opacity-50",onClick:c,children:e.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full ${i[l]} max-h-full overflow-y-auto`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:a}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:e.jsx(Se,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:r}),n&&e.jsx("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:n})]})})},fo=({currentImage:s,onImageUpdated:t,size:a="lg",className:r=""})=>{const[n,l]=d.useState(!1),[o,i]=d.useState(s),c={sm:"w-16 h-16",md:"w-24 h-24",lg:"w-32 h-32",xl:"w-40 h-40"},h=async g=>{var x,f;if(!["image/png","image/jpeg","image/jpg","image/gif","image/webp"].includes(g.type)){S.error("Tipo de arquivo não suportado");return}const R=5*1024*1024;if(g.size>R){S.error("Arquivo muito grande (máximo 5MB)");return}l(!0);try{const m=new FormData;if(m.append("image",g),o){const v=o.split("/").pop();m.append("replace_existing",v)}const k=await z.post("/upload/profile-image",m,{headers:{"Content-Type":"multipart/form-data"}});if(k.data.success){const v=k.data.data;i(v.main_url),t&&t(v.main_url),S.success("Foto de perfil atualizada com sucesso!")}else S.error(k.data.message||"Erro no upload")}catch(m){console.error("Erro no upload:",m),S.error(((f=(x=m.response)==null?void 0:x.data)==null?void 0:f.message)||"Erro ao enviar imagem")}finally{l(!1)}},u=g=>{const p=g.target.files[0];p&&h(p)};return e.jsxs("div",{className:`relative inline-block ${r}`,children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/gif,image/webp",onChange:u,className:"hidden",id:"profile-image-upload"}),e.jsxs("div",{className:`${c[a]} rounded-full bg-gray-200 flex items-center justify-center overflow-hidden relative group cursor-pointer`,children:[o?e.jsx("img",{src:o,alt:"Foto de perfil",className:"w-full h-full object-cover"}):e.jsx(Z,{className:"w-1/2 h-1/2 text-gray-400"}),e.jsx("label",{htmlFor:"profile-image-upload",className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 flex items-center justify-center cursor-pointer",children:n?e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}):e.jsx(Is,{className:"w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300"})})]}),e.jsx("label",{htmlFor:"profile-image-upload",className:"absolute -bottom-2 -right-2 bg-blue-600 text-white rounded-full p-2 cursor-pointer hover:bg-blue-700 transition-colors shadow-lg",children:e.jsx(Is,{className:"w-4 h-4"})}),n&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})})]})},jo=()=>{var $,P;xe();const[s,t]=d.useState(null),[a,r]=d.useState(!1),[n,l]=d.useState(!1),[o,i]=d.useState(!0),[c,h]=d.useState(!1),[u,g]=d.useState(null),{register:p,handleSubmit:R,reset:x,formState:{errors:f}}=Xe(),{register:m,handleSubmit:k,reset:v,watch:b,formState:{errors:y}}=Xe(),A=b("new_password");d.useEffect(()=>{(async()=>{i(!0);const L=await es.getProfile();L.success?(t(L.data.user),g(L.data.user.profile_pic),x({first_name:L.data.user.first_name||"",last_name:L.data.user.last_name||"",email:L.data.user.email||"",phone:L.data.user.phone||"",location:L.data.user.location||"",bio:L.data.user.bio||""})):S.error(L.message),i(!1)})()},[x]);const w=_=>{g(_),s&&t({...s,profile_pic:_})},N=async _=>{l(!0);const L=await es.updateProfile(_);L.success?(t(L.data.user),S.success(L.message),r(!1)):S.error(L.message),l(!1)},C=async _=>{l(!0);const L=await es.changePassword({current_password:_.current_password,new_password:_.new_password});L.success?(S.success(L.message),h(!1),v()):S.error(L.message),l(!1)},E=()=>{s&&x({first_name:s.first_name||"",last_name:s.last_name||"",email:s.email||"",phone:s.phone||"",location:s.location||"",bio:s.bio||""}),r(!1)};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):s?e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-6",children:e.jsx(fo,{currentImage:u,onImageUpdated:w,size:"xl"})}),e.jsxs("div",{className:"text-white",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:[s.first_name," ",s.last_name]}),e.jsxs("p",{className:"text-blue-100",children:["@",s.username]}),e.jsxs("p",{className:"text-blue-100",children:["Membro desde ",new Date(s.created_at).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})]})]})]}),e.jsx("div",{className:"text-right text-white",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:["⭐ ",(($=s.seller_rating)==null?void 0:$.toFixed(1))||"0.0","/5 - Vendedor"]}),e.jsxs("div",{children:["⭐ ",((P=s.buyer_rating)==null?void 0:P.toFixed(1))||"0.0","/5 - Comprador"]}),e.jsxs("div",{children:[s.total_ads||0," anúncios publicados"]}),e.jsxs("div",{children:[s.active_ads||0," anúncios ativos"]})]})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Informações Pessoais"}),a?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(F,{onClick:R(N),loading:n,size:"sm",children:[e.jsx(oa,{className:"w-4 h-4 mr-2"}),"Salvar"]}),e.jsxs(F,{onClick:E,variant:"outline",size:"sm",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Cancelar"]})]}):e.jsxs(F,{onClick:()=>r(!0),variant:"outline",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"Editar Perfil"]})]}),e.jsxs("form",{onSubmit:R(N),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome"}),e.jsx("input",{...p("first_name",{required:"Nome é obrigatório"}),type:"text",disabled:!a,className:`w-full px-3 py-2 border rounded-md ${a?"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500":"border-gray-200 bg-gray-50"}`}),f.first_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sobrenome"}),e.jsx("input",{...p("last_name",{required:"Sobrenome é obrigatório"}),type:"text",disabled:!a,className:`w-full px-3 py-2 border rounded-md ${a?"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500":"border-gray-200 bg-gray-50"}`}),f.last_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.last_name.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("email",{required:"Email é obrigatório",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Email inválido"}}),type:"email",disabled:!0,className:"w-full pl-10 pr-3 py-2 border border-gray-200 bg-gray-50 rounded-md"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"O email não pode ser alterado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("phone"),type:"tel",disabled:!a,className:`w-full pl-10 pr-3 py-2 border rounded-md ${a?"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500":"border-gray-200 bg-gray-50"}`,placeholder:"(11) 99999-9999"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Localização"}),e.jsxs("div",{className:"relative",children:[e.jsx(ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("location"),type:"text",disabled:!a,className:`w-full pl-10 pr-3 py-2 border rounded-md ${a?"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500":"border-gray-200 bg-gray-50"}`,placeholder:"Cidade, Estado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sobre mim"}),e.jsx("textarea",{...p("bio"),rows:4,disabled:!a,className:`w-full px-3 py-2 border rounded-md ${a?"border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500":"border-gray-200 bg-gray-50"}`,placeholder:"Conte um pouco sobre você e seus interesses em jogos..."})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Configurações da Conta"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Alterar Senha"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Atualize sua senha para manter sua conta segura"})]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>h(!0),children:[e.jsx(js,{className:"w-4 h-4 mr-2"}),"Alterar"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Foto de Perfil"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Clique na sua foto acima para alterá-la"})]}),e.jsx("div",{className:"text-sm text-blue-600",children:u?"Foto definida":"Sem foto"})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:"Notificações por Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receba atualizações sobre seus anúncios"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-600",children:"Excluir Conta"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Remova permanentemente sua conta e todos os dados"})]}),e.jsx(F,{variant:"danger",size:"sm",onClick:()=>S.info("Funcionalidade em desenvolvimento"),children:"Excluir"})]})]})]})]}),e.jsx(Me,{isOpen:c,onClose:()=>h(!1),title:"Alterar Senha",footer:e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),e.jsx(F,{onClick:k(C),loading:n,children:"Alterar Senha"})]}),children:e.jsxs("form",{onSubmit:k(C),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha Atual"}),e.jsx("input",{...m("current_password",{required:"Senha atual é obrigatória"}),type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),y.current_password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.current_password.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nova Senha"}),e.jsx("input",{...m("new_password",{required:"Nova senha é obrigatória",minLength:{value:6,message:"Nova senha deve ter pelo menos 6 caracteres"}}),type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),y.new_password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.new_password.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Nova Senha"}),e.jsx("input",{...m("confirm_password",{required:"Confirmação é obrigatória",validate:_=>_===A||"Senhas não coincidem"}),type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),y.confirm_password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.confirm_password.message})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Erro ao carregar perfil"}),e.jsx("p",{className:"text-gray-600",children:"Não foi possível carregar os dados do seu perfil."})]})})},Qa=({onImageUploaded:s,currentImage:t=null,category:a="ads",className:r="",maxSize:n=10,acceptedTypes:l=["image/png","image/jpeg","image/jpg","image/gif","image/webp"],placeholder:o="Clique para fazer upload ou arraste uma imagem",allowRemove:i=!0})=>{const[c,h]=d.useState(!1),[u,g]=d.useState(t),[p,R]=d.useState(!1),x=d.useRef(null),f=N=>l.includes(N.type)?N.size/(1024*1024)>n?(S.error(`Arquivo muito grande. Máximo ${n}MB.`),!1):!0:(S.error("Tipo de arquivo não suportado. Use PNG, JPG, GIF ou WebP."),!1),m=async N=>{var C,E;if(f(N)){h(!0);try{const $=new FormData;if($.append("image",N),u){const L=u.split("/").pop();$.append("replace_existing",L)}const P=a==="profiles"?"/upload/profile-image":"/upload/ad-image",_=await z.post(P,$,{headers:{"Content-Type":"multipart/form-data"}});if(_.data.success){const L=_.data.data;g(L.main_url),s&&s(L),S.success(_.data.message||"Imagem enviada com sucesso!")}else S.error(_.data.message||"Erro no upload")}catch($){console.error("Erro no upload:",$),S.error(((E=(C=$.response)==null?void 0:C.data)==null?void 0:E.message)||"Erro ao enviar imagem")}finally{h(!1)}}},k=N=>{const C=N.target.files[0];C&&m(C)},v=N=>{N.preventDefault(),R(!1);const C=N.dataTransfer.files;C.length>0&&m(C[0])},b=N=>{N.preventDefault(),R(!0)},y=N=>{N.preventDefault(),R(!1)},A=()=>{g(null),s&&s(null),x.current&&(x.current.value="")},w=()=>{x.current&&x.current.click()};return e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("input",{ref:x,type:"file",accept:l.join(","),onChange:k,className:"hidden"}),e.jsxs("div",{onClick:w,onDrop:v,onDragOver:b,onDragLeave:y,className:`
          relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-all duration-300
          ${p?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}
          ${c?"pointer-events-none opacity-50":""}
        `,children:[u?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:u,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[i&&e.jsx("button",{onClick:N=>{N.stopPropagation(),A()},className:"bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",title:"Remover imagem",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:N=>{N.stopPropagation(),w()},className:"bg-blue-500 text-white rounded-full p-1 hover:bg-blue-600 transition-colors",title:"Trocar imagem",children:e.jsx(Is,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-50 transition-all duration-300 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-white opacity-0 hover:opacity-100 transition-opacity duration-300",children:[e.jsx(Is,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Clique para trocar"})]})})]}):e.jsx("div",{className:"py-8",children:c?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enviando imagem..."})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx(tr,{className:"w-12 h-12 text-gray-400"})}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:o}),e.jsxs("p",{className:"text-xs text-gray-500",children:["PNG, JPG, GIF ou WebP até ",n,"MB"]})]})}),p&&e.jsx("div",{className:"absolute inset-0 bg-blue-100 bg-opacity-75 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-blue-600",children:[e.jsx(ar,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:"Solte a imagem aqui"})]})})]}),!u&&e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Recomendamos imagens com resolução mínima de 800x600 pixels"})]})},bo=()=>{const s=be(),{games:t,fetchGames:a}=Ss(),[r,n]=d.useState(!1),[l,o]=d.useState(null),{register:i,handleSubmit:c,watch:h,formState:{errors:u}}=Xe(),g=h("ad_type");d.useEffect(()=>{t.length===0&&a()},[t,a]);const p=async x=>{n(!0);try{const f={...x,image_url:(l==null?void 0:l.main_url)||null},m=await ke.createAd(f);m.success?(S.success("Anúncio criado com sucesso!"),s("/dashboard")):S.error(m.message)}catch{S.error("Erro ao criar anúncio")}n(!1)},R=x=>{o(x)};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"container mx-auto px-4 max-w-2xl",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Criar Novo Anúncio"}),e.jsx("p",{className:"text-gray-600",children:"Preencha as informações do seu jogo para criar um anúncio"})]}),e.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Anúncio"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...i("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"venda",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Venda"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Vender o jogo"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...i("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"troca",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Troca"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Trocar por outro"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...i("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"procura",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Procura"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Procurar para comprar"})]})]})]}),u.ad_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.ad_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"game_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Jogo"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsxs("select",{...i("game_id",{required:"Selecione um jogo"}),className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.game_id?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione um jogo"}),t.map(x=>e.jsx("option",{value:x._id,children:x.name},x._id))]})]}),u.game_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.game_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Título do Anúncio"}),e.jsx("input",{...i("title",{required:"Título é obrigatório",minLength:{value:10,message:"Título deve ter pelo menos 10 caracteres"}}),type:"text",className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.title?"border-red-300":"border-gray-300"}`,placeholder:"Ex: FIFA 24 - PlayStation 5 em perfeito estado"}),u.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{...i("description",{required:"Descrição é obrigatória",minLength:{value:20,message:"Descrição deve ter pelo menos 20 caracteres"}}),rows:4,className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.description?"border-red-300":"border-gray-300"}`,placeholder:"Descreva o estado do jogo, se possui DLCs, se foi pouco usado, etc."}),u.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.description.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagens do Jogo"}),e.jsx(Qa,{onImageUploaded:R,category:"ads",placeholder:"Adicione fotos do seu jogo para atrair mais compradores",className:"w-full"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"💡 Anúncios com fotos recebem até 5x mais visualizações!"})]}),g==="venda"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preço (R$)"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...i("price",{required:g==="venda"?"Preço é obrigatório para vendas":!1,min:{value:1,message:"Preço deve ser maior que zero"}}),type:"number",step:"0.01",className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.price?"border-red-300":"border-gray-300"}`,placeholder:"0,00"})]}),u.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.price.message})]}),g==="troca"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"desired_games",className:"block text-sm font-medium text-gray-700 mb-2",children:"Jogos Desejados para Troca"}),e.jsx("textarea",{...i("desired_games",{required:g==="troca"?"Informe os jogos desejados para troca":!1}),rows:3,className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.desired_games?"border-red-300":"border-gray-300"}`,placeholder:"Liste os jogos que você gostaria de receber em troca"}),u.desired_games&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.desired_games.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataforma"}),e.jsxs("select",{...i("platform",{required:"Selecione a plataforma"}),className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.platform?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione a plataforma"}),e.jsx("option",{value:"PC",children:"PC"}),e.jsx("option",{value:"PlayStation 5",children:"PlayStation 5"}),e.jsx("option",{value:"PlayStation 4",children:"PlayStation 4"}),e.jsx("option",{value:"Xbox Series X/S",children:"Xbox Series X/S"}),e.jsx("option",{value:"Xbox One",children:"Xbox One"}),e.jsx("option",{value:"Nintendo Switch",children:"Nintendo Switch"})]}),u.platform&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.platform.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"condition",className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado do Jogo"}),e.jsxs("select",{...i("condition",{required:"Selecione o estado do jogo"}),className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${u.condition?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione o estado"}),e.jsx("option",{value:"novo",children:"Novo (lacrado)"}),e.jsx("option",{value:"seminovo",children:"Seminovo (excelente estado)"}),e.jsx("option",{value:"usado",children:"Usado (bom estado)"}),e.jsx("option",{value:"regular",children:"Regular (com sinais de uso)"})]}),u.condition&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.condition.message})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>s("/dashboard"),children:"Cancelar"}),e.jsx(F,{type:"submit",loading:r,children:"Criar Anúncio"})]})]})]})})})},yo=()=>{const{adId:s}=ts(),t=be(),{games:a,fetchGames:r}=Ss(),[n,l]=d.useState(!1),[o,i]=d.useState(!0),[c,h]=d.useState(null),[u,g]=d.useState(null),{register:p,handleSubmit:R,watch:x,reset:f,formState:{errors:m}}=Xe(),k=x("ad_type");d.useEffect(()=>{const y=async()=>{i(!0);try{const A=await ke.getAdForEdit(s);if(A.success){const w=A.data.ad;f({game_id:w.game_id,title:w.title,description:w.description,ad_type:w.ad_type,platform:w.platform,condition:w.condition,price:w.price||"",desired_games:w.desired_games||""}),w.image_url&&g(w.image_url)}else S.error(A.message),t("/dashboard")}catch{S.error("Erro ao carregar anúncio"),t("/dashboard")}i(!1)};a.length===0&&r(),y()},[s,a,r,f,t]);const v=y=>{h(y),g(y?y.main_url:null)},b=async y=>{l(!0);try{const A={...y,image_url:(c==null?void 0:c.main_url)||u||null},w=await ke.updateAd(s,A);w.success?(S.success("Anúncio atualizado com sucesso!"),t("/dashboard")):S.error(w.message)}catch{S.error("Erro ao atualizar anúncio")}l(!1)};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"container mx-auto px-4 max-w-2xl",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Editar Anúncio"}),e.jsx("p",{className:"text-gray-600",children:"Atualize as informações do seu anúncio"})]}),e.jsxs("form",{onSubmit:R(b),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Anúncio"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...p("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"venda",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Venda"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Vender o jogo"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...p("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"troca",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Troca"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Trocar por outro"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{...p("ad_type",{required:"Selecione o tipo de anúncio"}),type:"radio",value:"procura",className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Procura"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Procurar para comprar"})]})]})]}),m.ad_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.ad_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"game_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Jogo"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsxs("select",{...p("game_id",{required:"Selecione um jogo"}),className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.game_id?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione um jogo"}),a.map(y=>e.jsx("option",{value:y._id,children:y.name},y._id))]})]}),m.game_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.game_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Título do Anúncio"}),e.jsx("input",{...p("title",{required:"Título é obrigatório",minLength:{value:10,message:"Título deve ter pelo menos 10 caracteres"}}),type:"text",className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.title?"border-red-300":"border-gray-300"}`,placeholder:"Ex: FIFA 24 - PlayStation 5 em perfeito estado"}),m.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{...p("description",{required:"Descrição é obrigatória",minLength:{value:20,message:"Descrição deve ter pelo menos 20 caracteres"}}),rows:4,className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.description?"border-red-300":"border-gray-300"}`,placeholder:"Descreva o estado do jogo, se possui DLCs, se foi pouco usado, etc."}),m.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.description.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagens do Anúncio"}),e.jsx(Qa,{onImageUploaded:v,currentImage:u,category:"ads",placeholder:"Adicione ou altere a foto do seu anúncio",className:"w-full",allowRemove:!0}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"💡 Você pode arrastar uma nova imagem ou clicar para trocar a atual"})]}),k==="venda"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preço (R$)"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("price",{required:k==="venda"?"Preço é obrigatório para vendas":!1,min:{value:1,message:"Preço deve ser maior que zero"}}),type:"number",step:"0.01",className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.price?"border-red-300":"border-gray-300"}`,placeholder:"0,00"})]}),m.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.price.message})]}),k==="troca"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"desired_games",className:"block text-sm font-medium text-gray-700 mb-2",children:"Jogos Desejados para Troca"}),e.jsx("textarea",{...p("desired_games",{required:k==="troca"?"Informe os jogos desejados para troca":!1}),rows:3,className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.desired_games?"border-red-300":"border-gray-300"}`,placeholder:"Liste os jogos que você gostaria de receber em troca"}),m.desired_games&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.desired_games.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataforma"}),e.jsxs("select",{...p("platform",{required:"Selecione a plataforma"}),className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.platform?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione a plataforma"}),e.jsx("option",{value:"PC",children:"PC"}),e.jsx("option",{value:"PlayStation 5",children:"PlayStation 5"}),e.jsx("option",{value:"PlayStation 4",children:"PlayStation 4"}),e.jsx("option",{value:"Xbox Series X/S",children:"Xbox Series X/S"}),e.jsx("option",{value:"Xbox One",children:"Xbox One"}),e.jsx("option",{value:"Nintendo Switch",children:"Nintendo Switch"})]}),m.platform&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.platform.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"condition",className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado do Jogo"}),e.jsxs("select",{...p("condition",{required:"Selecione o estado do jogo"}),className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${m.condition?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione o estado"}),e.jsx("option",{value:"novo",children:"Novo (lacrado)"}),e.jsx("option",{value:"seminovo",children:"Seminovo (excelente estado)"}),e.jsx("option",{value:"usado",children:"Usado (bom estado)"}),e.jsx("option",{value:"regular",children:"Regular (com sinais de uso)"})]}),m.condition&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.condition.message})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>t("/dashboard"),children:"Cancelar"}),e.jsx(F,{type:"submit",loading:n,children:"Atualizar Anúncio"})]})]})]})})})},No=({ad:s,className:t="",size:a="md",variant:r="primary",showQuantity:n=!0,maxQuantity:l=10})=>{var N;const{isAuthenticated:o,user:i}=xe(),{isInCart:c,getCartItemQuantity:h,addToCart:u,updateCartItem:g,removeFromCart:p}=ot(),[R,x]=d.useState(!1),[f,m]=d.useState(0),[k,v]=d.useState(!1),b=Ka.useMemo(()=>{var C;return!(!s||!o||s.ad_type!=="venda"||s.status!=="active"||i&&(i._id===s.user_id||i._id===((C=s.user)==null?void 0:C._id)))},[s,o,i]);d.useEffect(()=>{if(s!=null&&s._id&&o){const C=c(s._id),E=h(s._id);console.log("🔄 Atualizando estado AddToCartButton:",{adId:s._id,itemInCart:C,quantity:E,canAddToCart:b}),v(C),m(E)}else v(!1),m(0)},[s==null?void 0:s._id,o,c,h]);const y=async()=>{var C;if(!b){o?s.ad_type!=="venda"?S.info("Apenas anúncios de venda podem ser adicionados ao carrinho"):i&&(i._id===s.user_id||i._id===((C=s.user)==null?void 0:C._id))?S.info("Você não pode adicionar seu próprio anúncio ao carrinho"):S.info("Este item não pode ser adicionado ao carrinho"):S.info("Faça login para adicionar itens ao carrinho");return}x(!0);try{(await u(s,1)).success&&console.log("✅ Item adicionado ao carrinho")}catch(E){console.error("❌ Erro ao adicionar ao carrinho:",E),S.error("Erro ao adicionar ao carrinho")}x(!1)},A=async C=>{if(!(C<0||C>l)){x(!0);try{C===0?(await p(s._id)).success&&console.log("✅ Item removido do carrinho"):(await g(s._id,C)).success&&console.log("✅ Quantidade atualizada")}catch(E){console.error("❌ Erro ao atualizar quantidade:",E),S.error("Erro ao atualizar quantidade")}x(!1)}},w=async()=>{x(!0);try{(await p(s._id)).success&&console.log("✅ Item removido do carrinho")}catch(C){console.error("❌ Erro ao remover do carrinho:",C),S.error("Erro ao remover do carrinho")}x(!1)};return b?k&&f>0&&n?e.jsxs("div",{className:`inline-flex items-center ${t}`,children:[e.jsx(F,{onClick:()=>A(f-1),disabled:R||f<=0,variant:"outline",size:a,className:"rounded-r-none border-r-0",children:e.jsx(la,{className:"w-4 h-4"})}),e.jsx("div",{className:"px-4 py-2 border border-gray-300 bg-white text-center min-w-[60px] flex items-center justify-center",children:e.jsx("span",{className:"font-semibold text-gray-800",children:f})}),e.jsx(F,{onClick:()=>A(f+1),disabled:R||f>=l,variant:"outline",size:a,className:"rounded-l-none border-l-0",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx(F,{onClick:w,disabled:R,variant:"danger",size:a,className:"ml-2",title:"Remover do carrinho",children:e.jsx(Se,{className:"w-4 h-4"})})]}):k&&f>0&&!n?e.jsxs(F,{onClick:w,disabled:R,variant:"success",size:a,className:t,children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"No Carrinho (",f,")"]}):e.jsxs(F,{onClick:y,disabled:R,variant:r,size:a,className:t,loading:R,children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Adicionar ao Carrinho"]}):o?i&&(i._id===(s==null?void 0:s.user_id)||i._id===((N=s==null?void 0:s.user)==null?void 0:N._id))?e.jsxs(F,{disabled:!0,variant:"outline",size:a,className:`${t} opacity-50 cursor-not-allowed`,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Seu Anúncio"]}):(s==null?void 0:s.ad_type)!=="venda"?e.jsxs(F,{disabled:!0,variant:"outline",size:a,className:`${t} opacity-50 cursor-not-allowed`,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Não Vendível"]}):null:e.jsxs(F,{onClick:()=>S.info("Faça login para adicionar ao carrinho"),variant:"outline",size:a,className:t,children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Faça Login"]})},vo=()=>{if({}.VITE_API_UPLOAD_URL)return{}.VITE_API_UPLOAD_URL;if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return"http://127.0.0.1:5000/api/upload";if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return"/api/upload";const s=window.location.protocol,t=window.location.hostname;return`${s}//${t}:5000/api/upload`},gs=vo(),aa={defaults:{user:`${gs}/profiles/medium/no-user-image.jpg`,ad:`${gs}/ads/medium/no-ads-image.jpg`,game:`${gs}/games/medium/valorant.jpg`},getImageUrl(s,t="ad",a="medium"){return!s||s===""||s===null?this.defaults[t]:s.startsWith(`${gs}/`)?s:s.startsWith("http://127.0.0.1:5000/api/uploads/")?s.replace("/api/uploads/","/api/upload/"):s.startsWith("http")?this.defaults[t]:`${gs}/${t}/${a}/${s}`},getSrcSet(s,t="ad"){const a=this.getImageUrl(s,t,"medium"),r=a.replace("/medium/","/"),n=this.getFilename(a);return[`${r}thumbnail/${n} 300w`,`${r}medium/${n} 800w`,`${r}large/${n} 1200w`].join(", ")},getFilename(s){return s.split("/").pop()},async checkImageExists(s){try{return(await fetch(s,{method:"HEAD"})).ok}catch{return!1}},validateImageFile(s,t=10){return["image/png","image/jpeg","image/jpg","image/gif","image/webp"].includes(s.type)?s.size/(1024*1024)>t?{valid:!1,error:`Arquivo muito grande. Máximo ${t}MB.`}:{valid:!0}:{valid:!1,error:"Tipo de arquivo não suportado. Use PNG, JPG, GIF ou WebP."}},async resizeImageFile(s,t=1200,a=900,r=.8){return new Promise(n=>{const l=document.createElement("canvas"),o=l.getContext("2d"),i=new Image;i.onload=()=>{let{width:c,height:h}=i;c>t&&(h=h*t/c,c=t),h>a&&(c=c*a/h,h=a),l.width=c,l.height=h,o.drawImage(i,0,0,c,h),l.toBlob(n,"image/jpeg",r)},i.src=URL.createObjectURL(s)})}},Wa=({src:s,alt:t,type:a="ad",size:r="medium",className:n="",fallbackIcon:l=null,...o})=>{const[i,c]=d.useState(!1),[h,u]=d.useState(!0),g=i?aa.defaults[a]:aa.getImageUrl(s,a,r),p=()=>{i||(c(!0),u(!1))},R=()=>{u(!1)};return e.jsxs("div",{className:`relative ${n}`,children:[h&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse rounded"}),e.jsx("img",{src:g,alt:t,onError:p,onLoad:R,className:`${n} ${h?"opacity-0":"opacity-100"} transition-opacity duration-300`,...o}),i&&l&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 rounded",children:l})]})},wo=({ad:s,isOwner:t=!1})=>{const{isAuthenticated:a,user:r}=xe(),[n,l]=d.useState([]),[o,i]=d.useState(!0),[c,h]=d.useState(""),[u,g]=d.useState(!0),[p,R]=d.useState(!1),[x,f]=d.useState(null),[m,k]=d.useState(""),[v,b]=d.useState(null);d.useEffect(()=>{s!=null&&s._id&&(console.log("🔄 Carregando perguntas para anúncio:",s._id),y())},[s==null?void 0:s._id]);const y=async()=>{var P;if(!(s!=null&&s._id)){console.log("⚠️ ID do anúncio não fornecido");return}i(!0);try{console.log("📡 Fazendo requisição para perguntas...");const _=await qe.getAdQuestions(s._id);if(console.log("📥 Resultado da requisição:",_),_.success){const L=((P=_.data)==null?void 0:P.questions)||[];l(L),console.log("✅ Perguntas carregadas:",{total:L.length,questions:L.map(V=>({id:V._id,question:V.question.substring(0,50)+"...",status:V.status,isPublic:V.is_public}))})}else console.error("❌ Erro ao carregar perguntas:",_.message),S.error(_.message),l([])}catch(_){console.error("💥 Erro crítico ao carregar perguntas:",_),S.error("Erro ao carregar perguntas"),l([])}i(!1)},A=async P=>{if(P.preventDefault(),!a){S.info("Faça login para fazer perguntas");return}if(!c.trim()){S.error("Digite sua pergunta");return}if(c.trim().length<10){S.error("Pergunta deve ter pelo menos 10 caracteres");return}R(!0);try{console.log("📤 Enviando pergunta:",{adId:s._id,question:c.trim(),isPublic:u,userId:r._id});const _=await qe.askQuestion(s._id,c.trim(),u);console.log("📥 Resultado do envio:",_),_.success?(S.success(_.message||"Pergunta enviada com sucesso"),h(""),setTimeout(()=>{y()},500)):S.error(_.message)}catch(_){console.error("💥 Erro ao enviar pergunta:",_),S.error("Erro ao enviar pergunta")}R(!1)},w=async P=>{if(!m.trim()){S.error("Digite sua resposta");return}if(m.trim().length<5){S.error("Resposta deve ter pelo menos 5 caracteres");return}try{console.log("📤 Enviando resposta:",{questionId:P,answer:m.trim()});const _=await qe.answerQuestion(P,m.trim());_.success?(S.success(_.message||"Resposta enviada com sucesso"),f(null),k(""),setTimeout(()=>{y()},500)):S.error(_.message)}catch(_){console.error("💥 Erro ao responder pergunta:",_),S.error("Erro ao responder pergunta")}},N=async P=>{if(window.confirm("Tem certeza que deseja deletar esta pergunta?"))try{const _=await qe.deleteQuestion(P);_.success?(S.success(_.message||"Pergunta deletada com sucesso"),setTimeout(()=>{y()},500)):S.error(_.message)}catch(_){console.error("💥 Erro ao deletar pergunta:",_),S.error("Erro ao deletar pergunta")}},C=async P=>{try{const _=await qe.toggleQuestionVisibility(P);_.success?(S.success(_.message||"Visibilidade alterada"),setTimeout(()=>{y()},500)):S.error(_.message)}catch(_){console.error("💥 Erro ao alterar visibilidade:",_),S.error("Erro ao alterar visibilidade")}},E=P=>new Date(P).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),$=P=>r?!!(t||P.user_id===r._id):!1;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 mr-2 text-blue-600"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Perguntas e Respostas"}),e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 text-sm px-2 py-1 rounded-full",children:n.length})]}),e.jsx("button",{onClick:y,disabled:o,className:"p-2 text-gray-500 hover:text-blue-600 rounded-full hover:bg-gray-100",title:"Recarregar perguntas",children:e.jsx(We,{className:`w-4 h-4 ${o?"animate-spin":""}`})})]}),!1,a&&!t&&e.jsxs("form",{onSubmit:A,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Fazer uma pergunta"}),e.jsx("textarea",{value:c,onChange:P=>h(P.target.value),placeholder:"Digite sua pergunta sobre este anúncio...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3,maxLength:500}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:P=>g(P.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Pergunta pública (outros usuários podem ver)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[c.length,"/500"]}),e.jsxs(F,{type:"submit",loading:p,disabled:!c.trim()||c.length<10,size:"sm",className:"inline-flex items-center",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Enviar Pergunta"]})]})]})]}),!a&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsxs("span",{className:"text-blue-800",children:[e.jsx("a",{href:"/login",className:"font-medium hover:underline",children:"Faça login"})," para fazer perguntas sobre este anúncio"]})]})}),o?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando perguntas..."})]}):n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhuma pergunta ainda"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Seja o primeiro a fazer uma pergunta sobre este anúncio!"})]}):e.jsx("div",{className:"space-y-6",children:n.map(P=>{var _,L,V,O,D;return e.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-b-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(_=P.user)!=null&&_.profile_pic?e.jsx("img",{src:P.user.profile_pic,alt:P.user.username,className:"w-8 h-8 rounded-full object-cover"}):e.jsx(Z,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:((L=P.user)==null?void 0:L.first_name)||((V=P.user)==null?void 0:V.username)||"Usuário"}),e.jsx("span",{className:"text-sm text-gray-500",children:"perguntou"}),e.jsx("span",{className:"text-sm text-gray-500",children:E(P.created_at)}),e.jsxs("div",{className:"flex items-center space-x-1",children:[!P.is_public&&e.jsx(bs,{className:"w-4 h-4 text-gray-400",title:"Pergunta privada"}),P.status==="pending"&&e.jsx(ce,{className:"w-4 h-4 text-yellow-500",title:"Aguardando resposta"}),P.status==="answered"&&e.jsx(ge,{className:"w-4 h-4 text-green-500",title:"Respondida"})]})]}),e.jsx("p",{className:"text-gray-800",children:P.question}),$(P)&&e.jsxs("div",{className:"flex items-center space-x-3 mt-3",children:[t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C(P._id),className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:P.is_public?e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),"Tornar Privada"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),"Tornar Pública"]})}),P.status==="pending"&&e.jsx("button",{onClick:()=>f(P._id),className:"text-sm text-green-600 hover:text-green-800",children:"Responder"})]}),e.jsxs("button",{onClick:()=>N(P._id),className:"text-sm text-red-600 hover:text-red-800 flex items-center",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),"Deletar"]})]})]})]}),x===P._id&&e.jsxs("div",{className:"ml-11 mb-4 p-3 bg-green-50 rounded-lg",children:[e.jsx("textarea",{value:m,onChange:I=>k(I.target.value),placeholder:"Digite sua resposta...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 resize-none",rows:3}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 mt-2",children:[e.jsx("button",{onClick:()=>{f(null),k("")},className:"text-sm text-gray-600 hover:text-gray-800",children:"Cancelar"}),e.jsx(F,{onClick:()=>w(P._id),disabled:!m.trim(),size:"sm",children:"Enviar Resposta"})]})]}),P.status==="answered"&&P.answer&&e.jsxs("div",{className:"ml-11 pl-4 border-l-4 border-green-500",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-medium text-green-800",children:((O=P.answered_by_user)==null?void 0:O.first_name)||((D=P.answered_by_user)==null?void 0:D.username)||"Vendedor"}),e.jsx("span",{className:"text-sm text-gray-500",children:"respondeu"}),e.jsx("span",{className:"text-sm text-gray-500",children:E(P.answered_at)})]}),e.jsx("p",{className:"text-gray-800",children:P.answer})]})]},P._id)})})]})},_o=()=>{var Y,ee,ve,Pe,ns,os,ls,is,cs,ds,ms,us,Ot;const{adId:s}=ts(),t=be(),{user:a,isAuthenticated:r}=xe(),[n,l]=d.useState(null),[o,i]=d.useState(!0),[c,h]=d.useState(!0),[u,g]=d.useState(null),[p,R]=d.useState(!1),[x,f]=d.useState(!1),[m,k]=d.useState(""),[v,b]=d.useState(""),[y,A]=d.useState(!1),[w,N]=d.useState([]),[C,E]=d.useState(!1),[$,P]=d.useState(0),[_,L]=d.useState(0),[V,O]=d.useState(!1);d.useEffect(()=>{s&&D()},[s]),d.useEffect(()=>{n&&n.game_id&&I()},[n]);const D=async()=>{i(!0),g(null);try{console.log("🔍 Carregando detalhes do anúncio:",s);const B=await ke.getAd(s);if(console.log("📦 Resultado completo:",B),B.success){const de=B.data.ad;console.log("📋 Dados do anúncio:",de),l(de),P(de.view_count||0),L(de.favorites_count||0),O(de.is_favorited||de.user_favorited||!1),console.log("❤️ Estado dos favoritos:",{count:de.favorites_count,isFavorited:de.is_favorited||de.user_favorited})}else g(B.message),S.error(B.message)}catch(B){console.error("💥 Erro ao carregar anúncio:",B),g("Erro ao carregar anúncio"),S.error("Erro ao carregar anúncio")}i(!1)},I=async()=>{if(!(!n||!n.game_id)){E(!0);try{const B=await ke.getAds({game_id:n.game_id,limit:4,skip:0});if(B.success){const de=B.data.ads.filter(xs=>xs._id!==n._id).slice(0,3);N(de)}}catch(B){console.error("Erro ao carregar anúncios similares:",B)}E(!1)}},G=async()=>{if(window.confirm("Tem certeza que deseja excluir este anúncio?")){R(!0);try{const B=await ke.deleteAd(s);B.success?(S.success("Anúncio excluído com sucesso!"),t("/dashboard")):S.error(B.message)}catch{S.error("Erro ao excluir anúncio")}R(!1)}},Q=async()=>{if(!r){S.info("Faça login para favoritar anúncios");return}try{const B=await kt.toggleFavorite(s);if(B.success){const de=B.data.is_favorited;O(de),L(de?xs=>xs+1:xs=>Math.max(0,xs-1)),S.success(B.message)}else S.error(B.message)}catch(B){console.error("Erro ao favoritar:",B),S.error("Erro ao favoritar anúncio")}},re=async()=>{if(navigator.share)try{await navigator.share({title:n.title,text:`Confira este anúncio: ${n.title}`,url:window.location.href})}catch{}else navigator.clipboard.writeText(window.location.href),S.success("Link copiado para a área de transferência!")},M=async()=>{if(!r){S.info("Faça login para reportar anúncios");return}if(!m.trim()){S.error("Selecione um motivo para o report");return}A(!0);try{const B={ad_id:s,reason:m,details:v,reporter_id:a._id};console.log("Report enviado:",B),await new Promise(de=>setTimeout(de,1e3)),S.success("Report enviado com sucesso! Nossa equipe irá analisar."),f(!1),k(""),b("")}catch(B){console.error("Erro ao enviar report:",B),S.error("Erro ao enviar report. Tente novamente.")}A(!1)},X=[{value:"spam",label:"Spam ou conteúdo repetitivo"},{value:"fake",label:"Anúncio falso ou enganoso"},{value:"inappropriate",label:"Conteúdo inapropriado"},{value:"scam",label:"Tentativa de golpe"},{value:"wrong_category",label:"Categoria incorreta"},{value:"other",label:"Outro motivo"}],te=B=>new Date(B).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),j=B=>{switch(B){case"venda":return"success";case"troca":return"primary";case"procura":return"warning";default:return"default"}},U=B=>({novo:"Novo (lacrado)",seminovo:"Seminovo",usado:"Usado",regular:"Regular"})[B]||B;if(o)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})});if(u||!n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:u||"Anúncio não encontrado"}),e.jsx(F,{onClick:()=>t("/games"),children:"Voltar aos Jogos"})]})});const H=r&&a&&(a._id===n.user_id||a._id===((Y=n.user)==null?void 0:Y._id));return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>t(-1),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4 transition-colors",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Voltar"]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"relative",children:[c&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center z-10",children:e.jsx(pe,{className:"w-16 h-16 text-gray-400"})}),e.jsx("div",{className:"w-full h-96 bg-gray-100 flex items-center justify-center overflow-hidden",children:n.image_url?e.jsx("img",{src:n.image_url,alt:n.title,className:"w-full h-full object-cover",onLoad:()=>h(!1),onError:B=>{console.log("❌ Erro ao carregar imagem:",n.image_url),h(!1),B.target.style.display="none"},style:{display:c?"none":"block"}}):e.jsxs("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:[e.jsx(pe,{className:"w-16 h-16 text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Sem imagem"})]})}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:[e.jsx(K,{variant:j(n.ad_type),size:"lg",children:n.ad_type==="venda"?"Venda":n.ad_type==="troca"?"Troca":"Procura"}),n.condition&&e.jsx(K,{variant:"secondary",size:"lg",children:U(n.condition)})]}),H&&e.jsxs("div",{className:"absolute top-4 right-4 flex space-x-2",children:[e.jsx(q,{to:`/ads/${n._id}/edit`,className:"bg-yellow-500 hover:bg-yellow-600 text-white p-2 rounded-full transition-colors",title:"Editar anúncio",children:e.jsx(ys,{className:"w-4 h-4"})}),e.jsx("button",{onClick:G,disabled:p,className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-colors disabled:opacity-50",title:"Excluir anúncio",children:e.jsx(Re,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:n.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),$," visualizações"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),te(n.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:Q,disabled:!r,className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${V?"bg-red-50 border-red-200 text-red-600 hover:bg-red-100":"bg-gray-50 border-gray-200 text-gray-600 hover:bg-gray-100"} ${r?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,title:r?V?"Remover dos favoritos":"Adicionar aos favoritos":"Faça login para favoritar",children:[e.jsx(fs,{className:`w-5 h-5 ${V?"fill-current text-red-600":"text-gray-600"}`}),e.jsx("span",{className:"text-sm font-medium",children:_})]}),e.jsx("button",{onClick:re,className:"p-2 text-gray-600 hover:text-blue-600 rounded-full hover:bg-gray-100 transition-colors",title:"Compartilhar",children:e.jsx(rr,{className:"w-5 h-5"})})]})]}),n.price&&n.ad_type==="venda"&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["R$ ",parseFloat(n.price).toFixed(2)]})}),n.ad_type==="troca"&&n.desired_games&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Jogos Desejados para Troca:"]}),e.jsx("p",{className:"text-blue-800",children:n.desired_games})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Descrição"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed",children:n.description})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Jogo"}),e.jsx("div",{className:"font-semibold text-gray-800",children:((ee=n.game)==null?void 0:ee.name)||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Plataforma"}),e.jsx("div",{className:"font-semibold text-gray-800",children:n.platform||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Estado"}),e.jsx("div",{className:"font-semibold text-gray-800",children:U(n.condition)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Status"}),e.jsx(K,{variant:n.status==="active"?"success":"secondary",children:n.status==="active"?"Ativo":"Inativo"})]})]})]}),e.jsx(wo,{ad:n,isOwner:H}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Anúncios Similares"}),C?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):w.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:w.map(B=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all cursor-pointer group",onClick:()=>t(`/ads/${B._id}`),children:[e.jsx("div",{className:"aspect-video bg-gray-200 overflow-hidden",children:B.image_url?e.jsx("img",{src:B.image_url,alt:B.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(pe,{className:"w-8 h-8 text-gray-400"})})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 truncate mb-1",children:B.title}),e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${B.ad_type==="venda"?"bg-green-100 text-green-700":B.ad_type==="troca"?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"}`,children:B.ad_type==="venda"?"Venda":B.ad_type==="troca"?"Troca":"Procura"})}),B.price&&B.ad_type==="venda"&&e.jsxs("p",{className:"text-lg font-bold text-green-600 mb-2",children:["R$ ",parseFloat(B.price).toFixed(2)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),B.view_count||0]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(fs,{className:"w-3 h-3 mr-1"}),B.favorites_count||0]})]})]})]},B._id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum anúncio similar encontrado"})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),n.ad_type==="venda"?"Vendedor":n.ad_type==="troca"?"Anunciante":"Comprador"]}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center",children:(ve=n.user)!=null&&ve.profile_pic?e.jsx("img",{src:n.user.profile_pic,alt:n.user.username,className:"w-12 h-12 rounded-full object-cover"}):e.jsx(Z,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-800",children:[(Pe=n.user)==null?void 0:Pe.first_name," ",(ns=n.user)==null?void 0:ns.last_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["@",(os=n.user)==null?void 0:os.username]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2 text-yellow-500"}),"Avaliação: ",(((ls=n.user)==null?void 0:ls.seller_rating)||0).toFixed(1),"(",((is=n.user)==null?void 0:is.sales_count)||0," ",(((cs=n.user)==null?void 0:cs.sales_count)||0)===1?"venda":"vendas",")"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ws,{className:"w-4 h-4 mr-2"}),(ds=n.user)!=null&&ds.city&&((ms=n.user)!=null&&ms.state)?`${n.user.city}, ${n.user.state}`:((us=n.user)==null?void 0:us.location)||"Localização não informada"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Membro desde ",((Ot=n.user)==null?void 0:Ot.member_since)||new Date().getFullYear()]})]}),!H&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(q,{to:`/users/${n.user_id}`,className:"block w-full text-center",children:e.jsx(F,{variant:"outline",className:"w-full",children:"Ver Perfil"})}),e.jsxs(F,{className:"w-full",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Enviar Mensagem"]})]})]}),!H&&n.ad_type==="venda"&&n.status==="active"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Interessado?"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(No,{ad:n,className:"w-full",size:"lg"}),e.jsx(F,{variant:"outline",className:"w-full",children:"Comprar Agora"})]}),e.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("div",{className:"font-semibold mb-1",children:"🛡️ Compra Protegida"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsx("li",{children:"• Pagamento seguro"}),e.jsx("li",{children:"• Chat com vendedor"}),e.jsx("li",{children:"• Suporte dedicado"})]})]})})]}),!H&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Reportar Problema"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Encontrou algo suspeito neste anúncio?"}),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full",onClick:()=>f(!0),disabled:!r,children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Reportar"]})]})]})]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-screen overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Reportar Anúncio"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"✕"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo do report *"}),e.jsxs("select",{value:m,onChange:B=>k(B.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um motivo"}),X.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detalhes (opcional)"}),e.jsx("textarea",{value:v,onChange:B=>b(B.target.value),placeholder:"Descreva o problema com mais detalhes...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"4"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(F,{variant:"outline",onClick:()=>f(!1),className:"flex-1",disabled:y,children:"Cancelar"}),e.jsx(F,{onClick:M,className:"flex-1",disabled:y||!m.trim(),children:y?"Enviando...":"Enviar Report"})]})]})]})})})]})},So=()=>{var u,g;const{userId:s}=ts(),[t,a]=d.useState(null),[r,n]=d.useState([]),[l,o]=d.useState(!0),[i,c]=d.useState(!1);d.useEffect(()=>{(async()=>{o(!0);try{const R=await es.getUserPublicProfile(s);R.success?a(R.data.user):S.error(R.message),c(!0);const x=await ke.getUserAds(s,{limit:12});x.success&&n(x.data.ads),c(!1)}catch{S.error("Erro ao carregar perfil do usuário")}o(!1)})()},[s]);const h=()=>{S.info("Funcionalidade de contato em desenvolvimento")};return l?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 md:mb-0 md:mr-6",children:t.profile_pic?e.jsx("img",{src:t.profile_pic,alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}):e.jsx(Z,{className:"w-12 h-12 text-gray-600"})}),e.jsxs("div",{className:"text-center md:text-left text-white flex-1",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[t.first_name," ",t.last_name]}),e.jsxs("p",{className:"text-blue-100 text-lg mb-2",children:["@",t.username]}),e.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-4 text-sm text-blue-100 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),"Membro desde ",new Date(t.created_at).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})]}),t.location&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(ws,{className:"w-4 h-4 mr-1"}),t.location]})]}),t.bio&&e.jsx("p",{className:"text-blue-100 max-w-2xl",children:t.bio})]}),e.jsx("div",{className:"mt-4 md:mt-0 text-center md:text-right",children:e.jsxs(F,{onClick:h,className:"bg-white text-blue-600 hover:bg-gray-100",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Entrar em Contato"]})})]})}),e.jsx("div",{className:"p-6 bg-gray-50 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:t.total_ads||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Anúncios Publicados"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:t.active_ads||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Anúncios Ativos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:t.total_views||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Visualizações Totais"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:["R$ ",t.total_value||0]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Valor Total em Vendas"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Avaliações"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-green-800",children:"Como Vendedor"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-yellow-500 fill-current mr-1"}),e.jsxs("span",{className:"text-lg font-bold text-green-800",children:[((u=t.seller_rating)==null?void 0:u.toFixed(1))||"0.0","/5"]})]})]}),e.jsxs("div",{className:"text-sm text-green-600",children:[t.seller_ratings_count||0," avaliações"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Como Comprador"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-yellow-500 fill-current mr-1"}),e.jsxs("span",{className:"text-lg font-bold text-blue-800",children:[((g=t.buyer_rating)==null?void 0:g.toFixed(1))||"0.0","/5"]})]})]}),e.jsxs("div",{className:"text-sm text-blue-600",children:[t.buyer_ratings_count||0," avaliações"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Anúncios de ",t.first_name]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[r.length," anúncios"]})]}),i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(W,{})}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Fe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum anúncio encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Este usuário ainda não publicou nenhum anúncio."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(p=>e.jsxs(q,{to:`/ads/${p._id}`,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[p.image_url&&e.jsx("div",{className:"mb-3",children:e.jsx("img",{src:p.image_url,alt:p.title,className:"w-full h-32 object-cover rounded"})}),e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-800 line-clamp-2 flex-1 mr-2",children:p.title}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.ad_type==="venda"?"bg-green-100 text-green-800":p.ad_type==="troca"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:p.ad_type}),p.is_boosted&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⭐"})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:p.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[p.price&&e.jsxs("span",{className:"text-xl font-bold text-green-600",children:["R$ ",p.price]}),e.jsx("span",{className:"text-gray-500",children:p.platform})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-gray-500",children:new Date(p.created_at).toLocaleDateString("pt-BR")}),e.jsxs("span",{className:"text-gray-400 text-xs",children:[p.view_count," views"]})]})]})]},p._id))}),r.length>=12&&e.jsx("div",{className:"text-center mt-6",children:e.jsx(F,{variant:"outline",onClick:()=>S.info("Funcionalidade de paginação em desenvolvimento"),children:"Ver Mais Anúncios"})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Usuário não encontrado"}),e.jsx(q,{to:"/",className:"text-blue-600 hover:text-blue-800",children:"Voltar para a página inicial"})]})})},Lt=({icon:s=ze,title:t="Nada encontrado",description:a="Não encontramos nenhum resultado para sua busca.",actionText:r,onAction:n,children:l})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mb-6",children:e.jsx(s,{className:"w-16 h-16 text-gray-300 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:a}),r&&n&&e.jsx(F,{onClick:n,children:r}),l]}),Co=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState({}),[o,i]=d.useState("grid"),[c,h]=d.useState("all"),[u,g]=d.useState("recent");d.useEffect(()=>{p()},[]);const p=async()=>{r(!0);const f=await kt.getFavorites();f.success?t(f.data.favorites||[]):S.error(f.message),r(!1)},R=async f=>{if(window.confirm("Tem certeza que deseja remover este anúncio dos favoritos?")){l(k=>({...k,[f]:!0}));const m=await kt.removeFromFavorites(f);m.success?(t(s.filter(k=>k.ad._id!==f)),S.success("Anúncio removido dos favoritos")):S.error(m.message),l(k=>({...k,[f]:!1}))}},x=s.filter(f=>c==="all"?!0:f.ad.ad_type===c).sort((f,m)=>{switch(u){case"price_asc":return(f.ad.price||0)-(m.ad.price||0);case"price_desc":return(m.ad.price||0)-(f.ad.price||0);case"title":return f.ad.title.localeCompare(m.ad.title);case"recent":default:return new Date(m.created_at)-new Date(f.created_at)}});return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Meus Favoritos"}),e.jsx("p",{className:"text-gray-600",children:"Anúncios que você salvou para acompanhar"})]}),s.length===0?e.jsx(Lt,{icon:fs,title:"Nenhum favorito encontrado",description:"Você ainda não favoritou nenhum anúncio. Explore jogos e salve os que mais te interessam!",actionText:"Explorar Jogos",onAction:()=>window.location.href="/games"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[x.length," ",x.length===1?"favorito":"favoritos"]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(At,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:c,onChange:f=>h(f.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),e.jsx("option",{value:"venda",children:"Venda"}),e.jsx("option",{value:"troca",children:"Troca"}),e.jsx("option",{value:"procura",children:"Procura"})]})]}),e.jsxs("select",{value:u,onChange:f=>g(f.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"recent",children:"Mais recentes"}),e.jsx("option",{value:"title",children:"Nome A-Z"}),e.jsx("option",{value:"price_asc",children:"Menor preço"}),e.jsx("option",{value:"price_desc",children:"Maior preço"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>i("grid"),className:`p-2 rounded ${o==="grid"?"bg-blue-100 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsx(ia,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i("list"),className:`p-2 rounded ${o==="list"?"bg-blue-100 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsx(ca,{className:"w-4 h-4"})})]})]})]})}),o==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(f=>{var m;return e.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${n[f.ad._id]?"opacity-50":""}`,children:[f.ad.image_url&&e.jsx("div",{className:"h-48 bg-gray-200",children:e.jsx("img",{src:f.ad.image_url,alt:f.ad.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-800 line-clamp-2 mb-1",children:f.ad.title}),e.jsx("p",{className:"text-sm text-gray-600",children:(m=f.ad.game)==null?void 0:m.name})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-1 ml-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f.ad.ad_type==="venda"?"bg-green-100 text-green-800":f.ad.ad_type==="troca"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:f.ad.ad_type}),f.ad.is_boosted&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⭐"})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:f.ad.description}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[f.ad.price&&e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["R$ ",f.ad.price]}),e.jsx("p",{className:"text-sm text-gray-500",children:f.ad.platform})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Favoritado em ",new Date(f.created_at).toLocaleDateString("pt-BR")]})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(q,{to:`/ads/${f.ad._id}`,className:"flex-1 bg-blue-600 text-white text-center py-2 px-3 rounded-md hover:bg-blue-700 transition-colors text-sm flex items-center justify-center",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Ver Anúncio"]}),e.jsx("button",{onClick:()=>R(f.ad._id),disabled:n[f.ad._id],className:"bg-red-600 text-white py-2 px-3 rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",children:e.jsx(Re,{className:"w-4 h-4"})})]})]})]},f._id)})}):e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Anúncio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preço"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Favoritado em"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(f=>{var m;return e.jsxs("tr",{className:n[f.ad._id]?"opacity-50":"",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[f.ad.image_url&&e.jsx("img",{src:f.ad.image_url,alt:f.ad.title,className:"w-12 h-12 rounded object-cover mr-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.ad.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(m=f.ad.game)==null?void 0:m.name," • ",f.ad.platform]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.ad.ad_type==="venda"?"bg-green-100 text-green-800":f.ad.ad_type==="troca"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:f.ad.ad_type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:f.ad.price?`R$ ${f.ad.price}`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(f.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(q,{to:`/ads/${f.ad._id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>R(f.ad._id),disabled:n[f.ad._id],className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(Re,{className:"w-4 h-4"})})]})})]},f._id)})})]})})})]})]})})},ko=()=>{const s=be(),{cart:t,loading:a,updateCartItem:r,removeFromCart:n,clearCart:l,validateCart:o}=ot(),[i,c]=d.useState({}),[h,u]=d.useState(!1);d.useEffect(()=>{x()},[]);const g=async(m,k)=>{if(k<1){p(m);return}c(v=>({...v,[m]:!0}));try{await r(m,k)}catch{S.error("Erro ao atualizar quantidade")}c(v=>({...v,[m]:!1}))},p=async m=>{if(window.confirm("Deseja remover este item do carrinho?")){c(k=>({...k,[m]:!0}));try{await n(m)}catch{S.error("Erro ao remover item")}c(k=>({...k,[m]:!1}))}},R=async()=>{if(window.confirm("Deseja limpar todo o carrinho?"))try{await l()}catch{S.error("Erro ao limpar carrinho")}},x=async()=>{u(!0);try{await o()}catch{S.error("Erro ao validar carrinho")}u(!1)},f=()=>t.items.reduce((m,k)=>m+k.price_snapshot*k.quantity,0);return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):t.items.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx(Lt,{icon:Ge,title:"Seu carrinho está vazio",description:"Adicione alguns jogos ao seu carrinho para continuar",actionText:"Explorar Jogos",onAction:()=>s("/games")})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Meu Carrinho"}),e.jsxs("p",{className:"text-gray-600",children:[t.items.length," ",t.items.length===1?"item":"itens"," no carrinho"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(F,{onClick:x,loading:h,variant:"outline",size:"sm",className:"inline-flex items-center",children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Validar Carrinho"]}),t.items.length>1&&e.jsxs(F,{onClick:R,variant:"danger",size:"sm",className:"inline-flex items-center",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Limpar Carrinho"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:t.items.map(m=>{var k,v,b,y,A,w,N,C,E;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx("img",{src:((k=m.ad_snapshot)==null?void 0:k.image_url)||"/placeholder-game.jpg",alt:(v=m.ad_snapshot)==null?void 0:v.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 line-clamp-2",children:(b=m.ad_snapshot)==null?void 0:b.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(y=m.ad_snapshot)==null?void 0:y.game_name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Plataforma: ",(A=m.ad_snapshot)==null?void 0:A.platform]}),e.jsxs("span",{children:["Estado: ",(w=m.ad_snapshot)==null?void 0:w.condition]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Vendedor: @",(N=m.ad_snapshot)==null?void 0:N.seller_username]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600 mb-3",children:["R$ ",(C=m.price_snapshot)==null?void 0:C.toFixed(2)]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("button",{onClick:()=>g(m.ad_id,m.quantity-1),disabled:i[m.ad_id]||m.quantity<=1,className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center disabled:opacity-50",children:e.jsx(la,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-12 text-center font-semibold",children:i[m.ad_id]?e.jsx(W,{size:"sm"}):m.quantity}),e.jsx("button",{onClick:()=>g(m.ad_id,m.quantity+1),disabled:i[m.ad_id],className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center disabled:opacity-50",children:e.jsx(Ne,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Subtotal: R$ ",(m.price_snapshot*m.quantity).toFixed(2)]}),e.jsxs("button",{onClick:()=>p(m.ad_id),disabled:i[m.ad_id],className:"text-sm text-red-600 hover:text-red-800 flex items-center disabled:opacity-50",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),"Remover"]})]})]}),m.price_changed&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 text-yellow-600 mr-2"}),e.jsxs("span",{className:"text-sm text-yellow-800",children:["O preço deste item foi alterado para R$ ",(E=m.current_price)==null?void 0:E.toFixed(2)]})]})})]},m._id)})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Resumo do Pedido"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsxs("span",{className:"font-semibold",children:["R$ ",f().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:["Itens (",t.items.length,"):"]}),e.jsxs("span",{children:[t.items.reduce((m,k)=>m+k.quantity,0)," unidades"]})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["R$ ",f().toFixed(2)]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(q,{to:"/checkout",children:e.jsxs(F,{className:"w-full inline-flex items-center justify-center",size:"lg",children:["Finalizar Compra",e.jsx(nr,{className:"w-4 h-4 ml-2"})]})}),e.jsx(q,{to:"/games",children:e.jsx(F,{variant:"outline",className:"w-full",children:"Continuar Comprando"})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"💡 Dicas"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Frete combinado diretamente com o vendedor"}),e.jsx("li",{children:"• Pagamento seguro pela plataforma"}),e.jsx("li",{children:"• Chat em tempo real com os vendedores"}),e.jsx("li",{children:"• Suporte 24/7 para dúvidas"})]})]})]})})]})]})})},Eo=()=>{var N;const{user:s}=xe(),t=be(),{cart:a,clearCart:r,validateCart:n,loadCart:l}=ot(),[o,i]=d.useState(!1),[c,h]=d.useState(!0),[u,g]=d.useState(null),{register:p,handleSubmit:R,formState:{errors:x}}=Xe({defaultValues:{first_name:(s==null?void 0:s.first_name)||"",last_name:(s==null?void 0:s.last_name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||""}});d.useEffect(()=>{f()},[]);const f=async()=>{h(!0);try{if(await l(),await new Promise(E=>setTimeout(E,500)),!a.items||a.items.length===0){S.error("Carrinho vazio"),t("/cart");return}const C=await n();g(C),C.success&&C.data.total_invalid>0&&S.warning(`${C.data.total_invalid} item(s) removido(s) (não disponível)`)}catch(C){console.error("Erro ao carregar checkout:",C),S.error("Erro ao carregar dados do checkout"),t("/cart")}finally{h(!1)}},m=()=>!(a!=null&&a.items)||!Array.isArray(a.items)?0:a.items.reduce((C,E)=>{const $=E.price_snapshot||E.price||0,P=E.quantity||0;return C+$*P},0),k=()=>!(a!=null&&a.items)||!Array.isArray(a.items)?0:a.items.reduce((C,E)=>C+(E.quantity||0),0),v=()=>{if(!(a!=null&&a.items)||!Array.isArray(a.items))return 0;const C=new Set;return a.items.forEach(E=>{var P;const $=((P=E.ad_snapshot)==null?void 0:P.seller_id)||E.seller_id;$&&C.add($)}),C.size},b=async C=>{if(!a.items||a.items.length===0){S.error("Carrinho está vazio");return}i(!0);try{const E={cart_items:a.items.map(P=>{var _;return{ad_id:P.ad_id,quantity:P.quantity,title:((_=P.ad_snapshot)==null?void 0:_.title)||"Item sem título"}}),shipping_address:{street:C.street,number:C.number,complement:C.complement||"",neighborhood:C.neighborhood,city:C.city,state:C.state,zipcode:C.zipcode.replace(/\D/g,""),country:"Brasil"},contact:{first_name:C.first_name,last_name:C.last_name,email:C.email,phone:C.phone.replace(/\D/g,"")},payment_method:C.payment_method||"pending"};console.log("Enviando checkout:",E);const $=await $e.processCheckout(E);$.success?(await r(),S.success("Pedidos criados com sucesso!"),t("/orders",{state:{message:"Seus pedidos foram criados com sucesso!",orders:$.data.orders||$.orders}})):S.error($.message)}catch(E){console.error("Erro no checkout:",E),S.error("Erro ao processar pedidos")}finally{i(!1)}},y={email:{required:"Email é obrigatório",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Email inválido"}},phone:{required:"Telefone é obrigatório",pattern:{value:/^\(\d{2}\)\s\d{4,5}-\d{4}$/,message:"Formato: (11) 99999-9999"}},zipcode:{required:"CEP é obrigatório",pattern:{value:/^\d{5}-?\d{3}$/,message:"Formato: 00000-000"}},name:{required:"Nome é obrigatório",pattern:{value:/^[A-Za-zÀ-ÿ\s]{2,}$/,message:"Apenas letras, mínimo 2 caracteres"}},state:{required:"Estado é obrigatório",pattern:{value:/^[A-Z]{2}$/,message:"Use a sigla (ex: SP, RJ)"}}},A=C=>{if(!C)return C;const $=C.replace(/\D/g,"").match(/^(\d{2})(\d{4,5})(\d{4})$/);return $?`(${$[1]}) ${$[2]}-${$[3]}`:C},w=C=>{if(!C)return C;const $=C.replace(/\D/g,"").match(/^(\d{5})(\d{3})$/);return $?`${$[1]}-${$[2]}`:C};return c?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):!a.items||a.items.length===0?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ge,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Carrinho vazio"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Adicione alguns jogos ao seu carrinho para continuar."}),e.jsx(F,{onClick:()=>t("/games"),children:"Explorar Jogos"})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>t("/cart"),className:"flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Voltar ao Carrinho"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"🎯 Finalizar Compra"}),e.jsxs("p",{className:"text-lg text-gray-600",children:[k()," ",k()===1?"item":"itens"," •",e.jsxs("span",{className:"font-semibold text-green-600 ml-2",children:["Total: R$ ",m().toFixed(2)]})]})]})]}),u&&((N=u.data)==null?void 0:N.total_invalid)>0&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.jsx("span",{className:"text-yellow-800 font-medium",children:"Alguns itens foram removidos do carrinho por não estarem mais disponíveis."})]})}),v()>1&&e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsxs("div",{className:"text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"Múltiplos vendedores detectados!"}),e.jsxs("p",{className:"text-sm mt-1",children:["Seus itens serão divididos em ",v()," pedidos separados, um para cada vendedor."]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("form",{onSubmit:R(b),className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[e.jsx(Z,{className:"w-6 h-6 mr-3 text-blue-600"}),"Informações de Contato"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nome *"}),e.jsx("input",{...p("first_name",y.name),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${x.first_name?"border-red-300 bg-red-50":"border-gray-300 focus:border-blue-500"}`,placeholder:"Seu primeiro nome"}),x.first_name&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.first_name.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Sobrenome *"}),e.jsx("input",{...p("last_name",y.name),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${x.last_name?"border-red-300 bg-red-50":"border-gray-300 focus:border-blue-500"}`,placeholder:"Seu sobrenome"}),x.last_name&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.last_name.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("email",y.email),type:"email",className:`w-full pl-12 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${x.email?"border-red-300 bg-red-50":"border-gray-300 focus:border-blue-500"}`,placeholder:"seu@email.com"})]}),x.email&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.email.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Telefone *"}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{...p("phone",y.phone),type:"tel",className:`w-full pl-12 pr-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ${x.phone?"border-red-300 bg-red-50":"border-gray-300 focus:border-blue-500"}`,placeholder:"(11) 99999-9999",onChange:C=>{C.target.value=A(C.target.value)}})]}),x.phone&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.phone.message]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[e.jsx(ws,{className:"w-6 h-6 mr-3 text-green-600"}),"Endereço de Entrega"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"CEP *"}),e.jsx("input",{...p("zipcode",y.zipcode),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.zipcode?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"00000-000",onChange:C=>{C.target.value=w(C.target.value)}}),x.zipcode&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.zipcode.message]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Estado *"}),e.jsx("input",{...p("state",y.state),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.state?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"SP",maxLength:2,style:{textTransform:"uppercase"}}),x.state&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.state.message]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Rua *"}),e.jsx("input",{...p("street",{required:"Rua é obrigatória"}),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.street?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"Nome da rua"}),x.street&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.street.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Número *"}),e.jsx("input",{...p("number",{required:"Número é obrigatório"}),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.number?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"123"}),x.number&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.number.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Complemento"}),e.jsx("input",{...p("complement"),type:"text",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",placeholder:"Apto, bloco, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Bairro *"}),e.jsx("input",{...p("neighborhood",{required:"Bairro é obrigatório"}),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.neighborhood?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"Nome do bairro"}),x.neighborhood&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.neighborhood.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Cidade *"}),e.jsx("input",{...p("city",{required:"Cidade é obrigatória"}),type:"text",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ${x.city?"border-red-300 bg-red-50":"border-gray-300 focus:border-green-500"}`,placeholder:"Nome da cidade"}),x.city&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),x.city.message]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[e.jsx(ht,{className:"w-6 h-6 mr-3 text-purple-600"}),"Método de Pagamento"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-6 border-2 border-yellow-300 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{...p("payment_method"),type:"radio",value:"pending",defaultChecked:!0,className:"mr-4 w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-yellow-800 text-lg flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2"}),"Pagamento Pendente"]}),e.jsx("div",{className:"text-sm text-yellow-700 mt-1",children:"O pagamento será combinado diretamente com cada vendedor após a confirmação do pedido"})]})]})}),e.jsx("div",{className:"p-6 border-2 border-gray-200 bg-gray-50 rounded-xl opacity-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",disabled:!0,className:"mr-4 w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-gray-600 text-lg flex items-center",children:[e.jsx(ht,{className:"w-5 h-5 mr-2"}),"Cartão de Crédito"]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Em breve - Gateway de pagamento em desenvolvimento"})]})]})}),e.jsx("div",{className:"p-6 border-2 border-gray-200 bg-gray-50 rounded-xl opacity-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",disabled:!0,className:"mr-4 w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-gray-600 text-lg flex items-center",children:[e.jsx(pe,{className:"w-5 h-5 mr-2"}),"PIX"]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Em breve - Pagamento via PIX"})]})]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-blue-600 rounded-xl shadow-lg p-6",children:[e.jsxs(F,{type:"submit",loading:o,className:"w-full bg-white text-gray-800 hover:bg-gray-100 font-bold text-lg py-4 shadow-lg",size:"lg",children:[e.jsx(js,{className:"w-5 h-5 mr-3"}),"Finalizar Pedido",v()>1?"s":""," - R$ ",m().toFixed(2)]}),e.jsx("p",{className:"text-white text-center text-sm mt-3 opacity-90",children:"🔒 Transação 100% segura • Seus dados estão protegidos"})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sticky top-8 border border-gray-100",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-6 flex items-center",children:[e.jsx(Ge,{className:"w-6 h-6 mr-3 text-blue-600"}),"Resumo do Pedido"]}),e.jsx("div",{className:"space-y-4 mb-6 max-h-96 overflow-y-auto",children:a!=null&&a.items&&Array.isArray(a.items)&&a.items.length>0?a.items.map(C=>{var E,$,P,_,L,V;return e.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:(E=C.ad_snapshot)!=null&&E.image_url||C.image_url?e.jsx("img",{src:(($=C.ad_snapshot)==null?void 0:$.image_url)||C.image_url,alt:((P=C.ad_snapshot)==null?void 0:P.title)||C.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(pe,{className:"w-8 h-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:((_=C.ad_snapshot)==null?void 0:_.title)||C.title||"Item sem título"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[((L=C.ad_snapshot)==null?void 0:L.game_name)||C.game_name||"Jogo não identificado"," • Qtd: ",C.quantity||1]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Por: ",((V=C.ad_snapshot)==null?void 0:V.seller_username)||C.seller_name||"Vendedor"]}),e.jsxs("p",{className:"text-sm font-semibold text-green-600 mt-1",children:["R$ ",((C.price_snapshot||C.price||0)*(C.quantity||1)).toFixed(2)]})]})]},C.ad_id||C._id)}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(pe,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum item no carrinho"})]})}),e.jsxs("div",{className:"space-y-3 border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsxs("span",{className:"text-gray-600",children:["Subtotal (",k()," itens):"]}),e.jsxs("span",{className:"font-semibold",children:["R$ ",m().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Frete:"}),e.jsx("span",{className:"font-semibold text-blue-600",children:"A combinar"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-200",children:[e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Total:"}),e.jsxs("span",{className:"text-3xl font-bold text-green-600",children:["R$ ",m().toFixed(2)]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("span",{className:"font-semibold text-green-900",children:"Compra Protegida"})]}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Dados seguros e criptografados"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Chat direto com vendedores"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Suporte 24/7 disponível"]})]})]}),v()>1&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Z,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsxs("span",{className:"font-semibold text-blue-900",children:[v()," Vendedores"]})]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Serão criados ",v()," pedidos separados, um para cada vendedor."]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.jsx("span",{className:"font-semibold text-yellow-900",children:"Vendedores Verificados"})]}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Todos os vendedores são verificados e têm avaliações positivas na plataforma."})]})]})})]})]})})},Ao=()=>{const s=Et(),[t,a]=d.useState([]),[r,n]=d.useState(!0),[l,o]=d.useState("all"),[i,c]=d.useState("all"),[h,u]=d.useState("list"),[g,p]=d.useState(null);d.useEffect(()=>{R(),x()},[l]),d.useEffect(()=>{var N;(N=s.state)!=null&&N.message&&(S.success(s.state.message),window.history.replaceState({},document.title))},[s]);const R=async()=>{n(!0);try{let N;l==="sales"?N=await $e.getSales():l==="purchases"?N=await $e.getPurchases():N=await $e.getOrders(),N.success?a(N.data.orders||N.data.sales||N.data.purchases||[]):S.error(N.message)}catch{S.error("Erro ao carregar pedidos")}n(!1)},x=async()=>{try{const N=await $e.getOrderStats();N.success&&p(N.data)}catch(N){console.error("Erro ao carregar estatísticas:",N)}},f=t.filter(N=>i==="all"?!0:N.status===i),m=N=>({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",paid:"bg-blue-100 text-blue-800 border-blue-200",shipped:"bg-purple-100 text-purple-800 border-purple-200",delivered:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200"})[N]||"bg-gray-100 text-gray-800 border-gray-200",k=N=>{const E={pending:ce,paid:ge,shipped:pe,delivered:ge,cancelled:Qe}[N]||ce;return e.jsx(E,{className:"w-4 h-4"})},v=N=>({pending:"Pendente",paid:"Pago",shipped:"Enviado",delivered:"Entregue",cancelled:"Cancelado"})[N]||N,b=N=>N==="buyer"?"Compra":"Venda",y=N=>N==="buyer"?lt:Fe,A=N=>N==="buyer"?"bg-blue-100 text-blue-800 border-blue-200":"bg-green-100 text-green-800 border-green-200",w=[{id:"all",label:"Todos",icon:we,description:"Todas as transações"},{id:"purchases",label:"Minhas Compras",icon:lt,description:"Itens que você comprou"},{id:"sales",label:"Minhas Vendas",icon:Fe,description:"Itens que você vendeu"}];return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Meus Pedidos"}),e.jsx("p",{className:"text-gray-600",children:"Acompanhe suas compras e vendas na plataforma"})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(lt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Compras"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.buyer_stats.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Fe,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Vendas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.seller_stats.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(He,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gasto Total"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",g.total_spent.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(He,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita Total"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["R$ ",g.total_revenue.toFixed(2)]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-0",children:w.map(N=>{const C=N.icon;return e.jsx("button",{onClick:()=>o(N.id),className:`flex-1 py-6 px-6 text-center border-b-2 font-medium text-sm transition-colors ${l===N.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:N.label}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:N.description})]})},N.id)})})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[f.length," ",f.length===1?"pedido":"pedidos"]}),l!=="all"&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:l==="purchases"?"Suas Compras":"Suas Vendas"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(At,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:i,onChange:N=>c(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os status"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"paid",children:"Pago"}),e.jsx("option",{value:"shipped",children:"Enviado"}),e.jsx("option",{value:"delivered",children:"Entregue"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>u("list"),className:`p-2 rounded ${h==="list"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Visualização em lista",children:e.jsx(ca,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>u("grid"),className:`p-2 rounded ${h==="grid"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Visualização em grade",children:e.jsx(ia,{className:"w-4 h-4"})})]})]})]})})]}),f.length===0?e.jsx(Lt,{icon:we,title:"Nenhum pedido encontrado",description:l==="sales"?"Quando alguém comprar seus anúncios, os pedidos aparecerão aqui.":l==="purchases"?"Quando você fizer uma compra, ela aparecerá aqui.":"Você ainda não tem nenhum pedido.",actionText:"Explorar Jogos",onAction:()=>window.location.href="/games"}):h==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(N=>{var E,$,P,_,L;const C=y(N.role);return e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full border ${A(N.role)}`,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),b(N.role)]}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full border ${m(N.status)}`,children:[k(N.status),e.jsx("span",{className:"ml-1",children:v(N.status)})]})]}),e.jsx("h3",{className:"font-semibold text-lg text-gray-800 line-clamp-2 mb-2",children:(E=N.ad_snapshot)==null?void 0:E.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:($=N.ad_snapshot)==null?void 0:$.game_name}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:N.role==="buyer"?"Vendedor:":"Comprador:"}),e.jsxs("span",{className:"font-medium text-right",children:[(P=N.other_user)==null?void 0:P.first_name," ",(_=N.other_user)==null?void 0:_.last_name]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Quantidade:"}),e.jsx("span",{className:"font-medium",children:N.quantity})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsxs("span",{className:"font-bold text-green-600",children:["R$ ",(L=N.total_price)==null?void 0:L.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-medium",children:new Date(N.created_at).toLocaleDateString("pt-BR")})]})]}),e.jsx(q,{to:`/orders/${N._id}`,children:e.jsxs(F,{className:"w-full inline-flex items-center justify-center",size:"sm",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Ver Detalhes"]})})]})},N._id)})}):e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(N=>{var E,$,P,_,L,V;const C=y(N.role);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:(E=N.ad_snapshot)==null?void 0:E.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[($=N.ad_snapshot)==null?void 0:$.game_name," • Qtd: ",N.quantity]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 text-xs font-semibold rounded-full border ${A(N.role)}`,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),b(N.role)]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[(P=N.other_user)==null?void 0:P.first_name," ",(_=N.other_user)==null?void 0:_.last_name]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["@",(L=N.other_user)==null?void 0:L.username]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["R$ ",(V=N.total_price)==null?void 0:V.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full border ${m(N.status)}`,children:[k(N.status),e.jsx("span",{className:"ml-1",children:v(N.status)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(N.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs(q,{to:`/orders/${N._id}`,className:"text-blue-600 hover:text-blue-900 inline-flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"Ver Detalhes"]})})]},N._id)})})]})})})]})})};class Ro{constructor(){this.socket=null,this.isConnected=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectInterval=null}connect(t){try{console.log("🔌 Conectando ao chat WebSocket..."),this.socket&&this.disconnect();let a;if({}.VITE_WS_URL)a={}.VITE_WS_URL;else if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")a="http://127.0.0.1:5000";else{const r=window.location.protocol==="https:"?"https:":"http:",n=window.location.hostname;a=`${r}//${n}:5000`}return console.log("🔗 Conectando ao WebSocket em:",a),this.socket=xr(a,{auth:{token:`Bearer ${t}`},transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!0,timeout:2e4,forceNew:!0}),this.setupEventListeners(),this.socket}catch(a){return console.error("❌ Erro ao conectar WebSocket:",a),null}}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("✅ Conectado ao chat WebSocket"),this.isConnected=!0,this.reconnectAttempts=0,this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null)}),this.socket.on("disconnect",t=>{console.log("❌ Desconectado do chat WebSocket:",t),this.isConnected=!1,t==="io server disconnect"&&this.attemptReconnect()}),this.socket.on("connect_error",t=>{console.error("❌ Erro de conexão WebSocket:",t),this.isConnected=!1,this.attemptReconnect()}),this.socket.on("error",t=>{console.error("❌ Erro no WebSocket:",t)}),this.socket.on("connected",t=>{console.log("👤 Chat autenticado:",t)}),this.socket.on("room_joined",t=>{console.log("🏠 Sala joined:",t)}),this.socket.on("new_message",t=>{console.log("💬 Nova mensagem recebida:",t)}),this.socket.on("user_typing",t=>{console.log("⌨️ Usuário digitando:",t)}),this.socket.on("user_stop_typing",t=>{console.log("⏹️ Usuário parou de digitar:",t)}),this.socket.on("order_status_update",t=>{console.log("📦 Status do pedido atualizado:",t)}),this.socket.on("system_notification",t=>{console.log("🔔 Notificação do sistema:",t)}))}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.log("❌ Máximo de tentativas de reconexão atingido");return}if(this.reconnectInterval)return;this.reconnectAttempts++;const t=Math.pow(2,this.reconnectAttempts)*1e3;console.log(`🔄 Tentativa de reconexão ${this.reconnectAttempts}/${this.maxReconnectAttempts} em ${t}ms`),this.reconnectInterval=setTimeout(()=>{this.reconnectInterval=null,this.socket&&this.socket.connect()},t)}disconnect(){console.log("🔌 Desconectando do chat WebSocket..."),this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.socket&&(this.socket.disconnect(),this.socket=null),this.isConnected=!1}isConnected(){return this.isConnected&&this.socket&&this.socket.connected}joinRoom(t){return!this.isConnected()||!t?(console.warn("⚠️ Não é possível entrar na sala - não conectado"),!1):(console.log("🏠 Entrando na sala:",t),this.socket.emit("join_chat_room",{room_id:t}),!0)}leaveRoom(t){return!this.isConnected()||!t?(console.warn("⚠️ Não é possível sair da sala - não conectado"),!1):(console.log("🚪 Saindo da sala:",t),this.socket.emit("leave_chat_room",{room_id:t}),!0)}sendMessage(t,a){return!this.isConnected()||!t||!a?(console.warn("⚠️ Não é possível enviar mensagem - parâmetros inválidos"),!1):(console.log("💬 Enviando mensagem:",{roomId:t,content:a}),this.socket.emit("send_message",{room_id:t,content:a.trim()}),!0)}startTyping(t){return!this.isConnected()||!t?!1:(this.socket.emit("typing",{room_id:t}),!0)}stopTyping(t){return!this.isConnected()||!t?!1:(this.socket.emit("stop_typing",{room_id:t}),!0)}ping(){return this.isConnected()?(this.socket.emit("ping",{timestamp:Date.now()}),!0):!1}async getChatRooms(){var t,a;try{console.log("🔍 Buscando salas de chat...");const r=await z.get("/chat/rooms");return console.log("📥 Salas de chat:",r.data),{success:r.data.success||!0,data:r.data.data||r.data,message:r.data.message||"Salas carregadas"}}catch(r){return console.error("❌ Erro ao buscar salas:",r),{success:!1,message:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Erro ao carregar salas",data:{rooms:[]}}}}async getOrderChatRoom(t){var a,r;try{console.log("🔍 Buscando sala do pedido:",t);const n=await z.get(`/chat/room/${t}`);return console.log("📥 Sala do pedido:",n.data),{success:n.data.success||!0,data:n.data.data||n.data,message:n.data.message||"Sala encontrada"}}catch(n){return console.error("❌ Erro ao buscar sala do pedido:",n),{success:!1,message:((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||"Erro ao buscar sala",data:null}}}async getRoomMessages(t,a=50,r=0){var n,l;try{console.log("🔍 Buscando mensagens da sala:",t);const o=await z.get(`/chat/room/${t}/messages?limit=${a}&skip=${r}`);return console.log("📥 Mensagens da sala:",o.data),{success:o.data.success||!0,data:o.data.data||o.data,message:o.data.message||"Mensagens carregadas"}}catch(o){return console.error("❌ Erro ao buscar mensagens:",o),{success:!1,message:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Erro ao carregar mensagens",data:{messages:[]}}}}async sendMessageRest(t,a){var r,n;try{console.log("📤 Enviando mensagem via REST:",{roomId:t,content:a});const l=await z.post(`/chat/room/${t}/message`,{content:a.trim()});return console.log("📥 Resposta do envio:",l.data),{success:l.data.success||!0,data:l.data.data||l.data,message:l.data.message||"Mensagem enviada"}}catch(l){return console.error("❌ Erro ao enviar mensagem via REST:",l),{success:!1,message:((n=(r=l.response)==null?void 0:r.data)==null?void 0:n.message)||"Erro ao enviar mensagem"}}}on(t,a){this.socket&&this.socket.on(t,a)}off(t,a){this.socket&&this.socket.off(t,a)}getConnectionStatus(){return{connected:this.isConnected(),socket:!!this.socket,reconnectAttempts:this.reconnectAttempts,maxReconnectAttempts:this.maxReconnectAttempts}}}const ut=new Ro,To=({orderId:s,onClose:t})=>{const{user:a}=xe(),[r,n]=d.useState(null),[l,o]=d.useState([]),[i,c]=d.useState(""),[h,u]=d.useState(!0),[g,p]=d.useState(!1),[R,x]=d.useState(!1),[f,m]=d.useState(new Set),[k,v]=d.useState(null),b=d.useRef(null),y=d.useRef(null),A=d.useRef(null);d.useEffect(()=>(w(),()=>{C()}),[s]),d.useEffect(()=>{E()},[l]);const w=async()=>{var O;u(!0);try{const D=await ut.getOrderChatRoom(s);if(!D.success){S.error(D.message);return}n(D.data.room);const I=localStorage.getItem("access_token")||((O=document.cookie.split("; ").find(G=>G.startsWith("access_token=")))==null?void 0:O.split("=")[1]);if(I){const G=ut.connect(I);v(G),N(G,D.data.room._id),G.emit("join_chat_room",{room_id:D.data.room._id})}}catch(D){console.error("Erro ao inicializar chat:",D),S.error("Erro ao carregar chat")}u(!1)},N=(O,D)=>{O.on("connected",()=>{p(!0),console.log("Conectado ao chat")}),O.on("room_joined",I=>{console.log("Entrou na sala:",I),o(I.messages||[])}),O.on("new_message",I=>{const G=I.message;G.room_id===D&&(o(Q=>[...Q,G]),G.user_id!==a._id&&$())}),O.on("user_typing",I=>{I.user_id!==a._id&&(m(G=>new Set([...G,I.username])),setTimeout(()=>{m(G=>{const Q=new Set(G);return Q.delete(I.username),Q})},3e3))}),O.on("user_stop_typing",I=>{I.user_id!==a._id&&m(G=>{const Q=new Set(G);return Q.delete(I.username),Q})}),O.on("system_notification",I=>{S.info(I.message)}),O.on("error",I=>{console.error("Erro no WebSocket:",I),S.error(I.message||"Erro na conexão")}),O.on("disconnect",()=>{p(!1),console.log("Desconectado do chat")})},C=()=>{k&&(r&&k.emit("leave_chat_room",{room_id:r._id}),ut.disconnect()),y.current&&clearTimeout(y.current)},E=()=>{var O;(O=b.current)==null||O.scrollIntoView({behavior:"smooth"})},$=()=>{try{const O=new Audio("/notification.mp3");O.volume=.3,O.play().catch(()=>{})}catch{}},P=async O=>{var D;if(O.preventDefault(),!(!i.trim()||R||!g)){x(!0);try{k&&r&&(k.emit("send_message",{room_id:r._id,content:i.trim()}),c(""),(D=A.current)==null||D.focus())}catch(I){console.error("Erro ao enviar mensagem:",I),S.error("Erro ao enviar mensagem")}x(!1)}},_=()=>{k&&r&&g&&(k.emit("typing",{room_id:r._id}),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{k.emit("stop_typing",{room_id:r._id})},2e3))},L=O=>{const D=new Date(O),I=new Date;return D.toDateString()===I.toDateString()?D.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):D.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})},V=O=>{var D;return O.user_id===a._id?((D=O.read_by)==null?void 0:D.length)>1?"read":"sent":null};return h?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Carregando chat..."})]})}):e.jsxs("div",{className:"flex flex-col h-96 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ie,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Chat do Pedido"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${g?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-gray-600",children:g?"Conectado":"Desconectado"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",title:"Chamada de voz (em breve)",children:e.jsx(vs,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",title:"Chamada de vídeo (em breve)",children:e.jsx(lr,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",title:"Configurações",children:e.jsx(Us,{className:"w-4 h-4"})})]})]}),!g&&e.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-b border-yellow-200",children:e.jsxs("div",{className:"flex items-center text-yellow-800",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Reconectando ao chat..."})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhuma mensagem ainda"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Inicie a conversa sobre este pedido"})]}):l.map((O,D)=>{const I=O.user_id===a._id,G=O.is_system;return e.jsx("div",{className:`flex ${G?"justify-center":I?"justify-end":"justify-start"}`,children:G?e.jsx("div",{className:"bg-blue-50 text-blue-800 px-3 py-2 rounded-lg text-sm border border-blue-200",children:O.content}):e.jsxs("div",{className:`max-w-xs lg:max-w-md ${I?"ml-12":"mr-12"}`,children:[!I&&O.user&&e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center mr-2",children:O.user.profile_pic?e.jsx("img",{src:O.user.profile_pic,alt:O.user.username,className:"w-6 h-6 rounded-full object-cover"}):e.jsx(Z,{className:"w-3 h-3 text-gray-600"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:O.user.first_name||O.user.username})]}),e.jsxs("div",{className:`px-4 py-2 rounded-lg ${I?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:O.content}),e.jsxs("div",{className:`flex items-center justify-between mt-1 ${I?"text-blue-100":"text-gray-500"}`,children:[e.jsx("span",{className:"text-xs",children:L(O.created_at)}),I&&e.jsx("div",{className:"ml-2",children:V(O)==="read"?e.jsx(da,{className:"w-3 h-3"}):e.jsx(ce,{className:"w-3 h-3"})})]})]})]})},O._id||D)}),f.size>0&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"max-w-xs lg:max-w-md mr-12",children:e.jsx("div",{className:"bg-gray-100 text-gray-600 px-4 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("span",{className:"text-sm",children:[Array.from(f).join(", ")," ",f.size===1?"está":"estão"," digitando"]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})}),e.jsx("div",{ref:b})]}),e.jsxs("div",{className:"border-t border-gray-200 p-4",children:[e.jsxs("form",{onSubmit:P,className:"flex space-x-2",children:[e.jsx("input",{ref:A,type:"text",value:i,onChange:O=>{c(O.target.value),_()},placeholder:g?"Digite sua mensagem...":"Aguardando conexão...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",disabled:!g,maxLength:1e3}),e.jsx(F,{type:"submit",disabled:!i.trim()||R||!g,loading:R,size:"sm",className:"px-4",children:e.jsx(Je,{className:"w-4 h-4"})})]}),i.length>800&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/1000 caracteres"]})]})]})},Ws=({type:s="info",title:t,children:a,dismissible:r=!1,onDismiss:n,className:l=""})=>{const o={success:ge,error:Qe,warning:ye,info:gt},i={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"},c={success:"text-green-400",error:"text-red-400",warning:"text-yellow-400",info:"text-blue-400"},h=o[s];return e.jsx("div",{className:ss("border rounded-lg p-4",i[s],l),children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(h,{className:ss("w-5 h-5",c[s])})}),e.jsxs("div",{className:"ml-3 flex-1",children:[t&&e.jsx("h3",{className:"text-sm font-medium mb-1",children:t}),e.jsx("div",{className:"text-sm",children:a})]}),r&&e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("div",{className:"-mx-1.5 -my-1.5",children:e.jsx("button",{onClick:n,className:ss("inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2",c[s],"hover:bg-opacity-20"),children:e.jsx(Se,{className:"w-4 h-4"})})})})]})})},se=({children:s,className:t="",padding:a="default",shadow:r="default",rounded:n="default",hover:l=!1,...o})=>{const i={none:"",sm:"p-3",default:"p-6",lg:"p-8"},c={none:"",sm:"shadow-sm",default:"shadow-md",lg:"shadow-lg",xl:"shadow-xl"},h={none:"",sm:"rounded-sm",default:"rounded-lg",lg:"rounded-xl",full:"rounded-full"};return e.jsx("div",{className:ss("bg-white",i[a],c[r],h[n],{"hover:shadow-lg transition-shadow duration-300":l},t),...o,children:s})},Cs=({currentPage:s,totalPages:t,onPageChange:a,showPrevNext:r=!0,showPageNumbers:n=!0,maxPageNumbers:l=5})=>{const o=()=>{const i=[],c=Math.max(1,s-Math.floor(l/2)),h=Math.min(t,c+l-1);for(let u=c;u<=h;u++)i.push(u);return i};return t<=1?null:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>a(s-1),disabled:s===1,children:[e.jsx(ir,{className:"w-4 h-4 mr-1"}),"Anterior"]}),n&&e.jsxs(e.Fragment,{children:[o()[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:s===1?"primary":"outline",size:"sm",onClick:()=>a(1),children:"1"}),o()[0]>2&&e.jsx("span",{className:"px-2",children:"..."})]}),o().map(i=>e.jsx(F,{variant:i===s?"primary":"outline",size:"sm",onClick:()=>a(i),children:i},i)),o()[o().length-1]<t&&e.jsxs(e.Fragment,{children:[o()[o().length-1]<t-1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(F,{variant:t===s?"primary":"outline",size:"sm",onClick:()=>a(t),children:t})]})]}),r&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>a(s+1),disabled:s===t,children:["Próximo",e.jsx(ma,{className:"w-4 h-4 ml-1"})]})]})},Po=({isOpen:s,onClose:t,order:a,onSuccess:r})=>{var k,v;const[n,l]=d.useState(0),[o,i]=d.useState(""),[c,h]=d.useState(!1),[u,g]=d.useState(""),[p,R]=d.useState(!1),x=async b=>{var y,A;if(b.preventDefault(),n===0){g("Por favor, selecione uma avaliação");return}h(!0),g("");try{await _e.submitRating(a._id,{rating:n,comment:o.trim()||void 0}),R(!0),setTimeout(()=>{r(),t(),f()},2e3)}catch(w){g(((A=(y=w.response)==null?void 0:y.data)==null?void 0:A.message)||"Erro ao enviar avaliação")}finally{h(!1)}},f=()=>{l(0),i(""),g(""),R(!1)},m=()=>{f(),t()};return!s||!a?null:e.jsx(Me,{onClose:m,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Avaliar Pedido"}),u&&e.jsx(Ws,{type:"error",message:u,className:"mb-4"}),p&&e.jsx(Ws,{type:"success",message:"Avaliação enviada com sucesso!",className:"mb-4"}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium",children:"Detalhes do Pedido"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Pedido #",(k=a._id)==null?void 0:k.slice(-8)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Total: R$ ",(v=a.total_price)==null?void 0:v.toFixed(2)]})]}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Como você avalia esta experiência?"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(b=>e.jsx("button",{type:"button",onClick:()=>l(b),className:`w-8 h-8 text-2xl ${b<=n?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition-colors`,children:"★"},b))}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[n===0&&"Selecione uma avaliação",n===1&&"Muito ruim",n===2&&"Ruim",n===3&&"Regular",n===4&&"Bom",n===5&&"Excelente"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comentário (opcional)"}),e.jsx("textarea",{value:o,onChange:b=>i(b.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Compartilhe sua experiência...",maxLength:500}),e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[o.length,"/500 caracteres"]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(F,{type:"button",variant:"outline",onClick:m,disabled:c,children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:c||n===0,loading:c,children:"Enviar Avaliação"})]})]})]})})},Do=()=>{var _,L,V,O,D,I,G,Q,re,M,X,te;const{orderId:s}=ts(),t=be(),{user:a,isAuthenticated:r}=xe(),[n,l]=d.useState(null),[o,i]=d.useState(!0),[c,h]=d.useState(!1),[u,g]=d.useState(!1),[p,R]=d.useState(!1);d.useEffect(()=>{s&&x()},[s]);const x=async()=>{i(!0);try{console.log("🔍 Carregando detalhes do pedido:",s);const j=await $e.getOrder(s);if(console.log("📦 Dados do pedido (raw):",j),j.success){const U=j.data.order||j.data;console.log("📋 Dados do pedido processados:",U),l(U)}else S.error(j.message),t("/orders")}catch(j){console.error("💥 Erro ao carregar pedido:",j),S.error("Erro ao carregar pedido"),t("/orders")}i(!1)},f=async j=>{if(window.confirm(`Tem certeza que deseja alterar o status para "${j}"?`)){h(!0);try{const U=m();console.log("🔄 Atualizando status:",{orderId:s,newStatus:j,userRole:U,currentUserId:a._id,orderSellerId:n.seller_id,orderBuyerId:n.buyer_id});const H=await $e.updateOrderStatus(s,j,U);H.success?(S.success(`Status atualizado para: ${j}`),await x()):S.error(H.message)}catch(U){console.error("💥 Erro ao atualizar status:",U),S.error("Erro ao atualizar status")}h(!1)}},m=()=>{var j,U,H;return!a||!n?null:n.seller_id===a._id||((j=n.seller)==null?void 0:j._id)===a._id?"seller":n.buyer_id===a._id||((U=n.buyer)==null?void 0:U._id)===a._id?"buyer":((H=n.ad_snapshot)==null?void 0:H.seller_id)===a._id?"seller":n.created_by===a._id?"buyer":(console.warn("⚠️ Não foi possível determinar o papel do usuário"),null)},k=()=>{var U,H,Y,ee;if(!a||!n)return null;const j=m();return j==="seller"?n.buyer||n.buyer_details||{_id:n.buyer_id,username:n.buyer_username||"Comprador",first_name:n.buyer_name||"Comprador",last_name:"",email:n.buyer_email||"",phone:n.buyer_phone||""}:j==="buyer"?n.seller||n.seller_details||((U=n.ad_snapshot)==null?void 0:U.seller)||{_id:n.seller_id||((H=n.ad_snapshot)==null?void 0:H.seller_id),username:n.seller_username||((Y=n.ad_snapshot)==null?void 0:Y.seller_username)||"Vendedor",first_name:n.seller_name||((ee=n.ad_snapshot)==null?void 0:ee.seller_name)||"Vendedor",last_name:"",email:n.seller_email||"",phone:n.seller_phone||""}:null},v=j=>({pending:"warning",paid:"primary",shipped:"info",delivered:"success",cancelled:"danger"})[j]||"secondary",b=j=>{const H={pending:ce,paid:ht,shipped:cr,delivered:ge,cancelled:Qe}[j]||ce;return e.jsx(H,{className:"w-4 h-4"})},y=j=>({pending:"Pendente",paid:"Pago",shipped:"Enviado",delivered:"Entregue",cancelled:"Cancelado"})[j]||j,A=()=>{if(!a||!n)return[];const j=m(),U=[];if(console.log("🎯 Determinando ações disponíveis:",{userRole:j,currentStatus:n.status,userId:a._id}),j==="seller")switch(n.status){case"pending":U.push({action:"paid",label:"Confirmar Pagamento",color:"primary",description:"Marcar como pago após receber o pagamento"}),U.push({action:"cancelled",label:"Cancelar Pedido",color:"danger",description:"Cancelar este pedido"});break;case"paid":U.push({action:"shipped",label:"Marcar como Enviado",color:"info",description:"Confirmar que o item foi enviado"});break;case"shipped":U.push({action:"delivered",label:"Marcar como Entregue",color:"success",description:"Confirmar que foi entregue"});break}else if(j==="buyer")switch(n.status){case"pending":U.push({action:"cancelled",label:"Cancelar Pedido",color:"danger",description:"Cancelar este pedido"});break;case"shipped":U.push({action:"delivered",label:"Confirmar Recebimento",color:"success",description:"Confirmar que recebi o item"});break}return console.log("✅ Ações disponíveis:",U),U},w=()=>{if(!n||n.status!=="completed"&&n.status!=="delivered"||n.rating_submitted)return!1;const j=m();return j==="buyer"&&!n.seller_rating||j==="seller"&&!n.buyer_rating},N=()=>{x(),S.success("Avaliação enviada com sucesso!")},C=j=>new Date(j).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});if(o)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})});if(!n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Pedido não encontrado"}),e.jsx(F,{onClick:()=>t("/orders"),children:"Voltar aos Pedidos"})]})});const E=m(),$=k(),P=A();return console.log("🎯 Renderização final:",{userRole:E,otherUser:$,availableActions:P,orderStatus:n.status}),e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>t("/orders"),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4 transition-colors",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Voltar aos Pedidos"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Pedido #",((_=n._id)==null?void 0:_.slice(-8))||"N/A"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(K,{variant:v(n.status),className:"flex items-center",children:[b(n.status),e.jsx("span",{className:"ml-1",children:y(n.status)})]}),e.jsx("span",{className:"text-sm text-gray-600",children:C(n.created_at)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(F,{onClick:x,variant:"outline",size:"sm",disabled:o,children:[e.jsx(We,{className:`w-4 h-4 mr-2 ${o?"animate-spin":""}`}),"Atualizar"]}),e.jsxs(F,{onClick:()=>g(!u),variant:"outline",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),u?"Fechar Chat":"Abrir Chat"]})]})]})]}),!1,e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(pe,{className:"w-5 h-5 mr-2"}),"Produto"]}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:(L=n.ad_snapshot)!=null&&L.image_url?e.jsx("img",{src:n.ad_snapshot.image_url,alt:n.ad_snapshot.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(pe,{className:"w-8 h-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:((V=n.ad_snapshot)==null?void 0:V.title)||"Produto não informado"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Jogo:"}),e.jsx("div",{className:"font-medium",children:((O=n.ad_snapshot)==null?void 0:O.game_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Plataforma:"}),e.jsx("div",{className:"font-medium",children:((D=n.ad_snapshot)==null?void 0:D.platform)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Estado:"}),e.jsx("div",{className:"font-medium",children:((I=n.ad_snapshot)==null?void 0:I.condition)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Quantidade:"}),e.jsx("div",{className:"font-medium",children:n.quantity||1})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["R$ ",parseFloat(n.total_price||0).toFixed(2)]}),n.quantity>1&&e.jsxs("div",{className:"text-sm text-gray-600",children:["R$ ",parseFloat(n.unit_price||0).toFixed(2)," cada"]})]})]}),n.notes&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Observações:"})," ",n.notes]})})]}),n.shipping_address&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(ws,{className:"w-5 h-5 mr-2"}),"Endereço de Entrega"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{children:e.jsxs("strong",{children:[(G=n.contact)==null?void 0:G.first_name," ",(Q=n.contact)==null?void 0:Q.last_name]})}),e.jsxs("div",{children:[n.shipping_address.street,", ",n.shipping_address.number]}),n.shipping_address.complement&&e.jsx("div",{children:n.shipping_address.complement}),e.jsxs("div",{children:[n.shipping_address.neighborhood," - ",n.shipping_address.city,"/",n.shipping_address.state]}),e.jsxs("div",{children:["CEP: ",n.shipping_address.zipcode]}),((re=n.contact)==null?void 0:re.phone)&&e.jsxs("div",{className:"flex items-center mt-3",children:[e.jsx(vs,{className:"w-4 h-4 mr-2 text-gray-600"}),n.contact.phone]}),((M=n.contact)==null?void 0:M.email)&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"w-4 h-4 mr-2 text-gray-600"}),n.contact.email]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"Histórico do Pedido"]}),e.jsx("div",{className:"space-y-4",children:((X=n.status_history)==null?void 0:X.map((j,U)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${j.status===n.status?"bg-blue-600":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:y(j.status)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[C(j.timestamp),j.updated_by&&` - por ${j.updated_by}`]})]})]},U)))||e.jsx("div",{className:"text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Pedido Criado"}),e.jsx("div",{className:"text-sm text-gray-600",children:C(n.created_at)})]})]})})})]}),u&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 mr-2"}),"Chat do Pedido"]}),e.jsx(To,{orderId:s,onClose:()=>g(!1)})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[$&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),E==="seller"?"Comprador":"Vendedor"]}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center",children:$.profile_pic?e.jsx("img",{src:$.profile_pic,alt:$.username,className:"w-12 h-12 rounded-full object-cover"}):e.jsx(Z,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-800",children:[$.first_name," ",$.last_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["@",$.username]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2 text-yellow-500"}),"Avaliação: 4.8 (23 vendas)"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Membro desde 2023"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(q,{to:`/users/${$._id}`,className:"block w-full text-center",children:e.jsx(F,{variant:"outline",className:"w-full",children:"Ver Perfil"})}),e.jsxs(F,{className:"w-full",onClick:()=>g(!0),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Enviar Mensagem"]})]})]}),(P.length>0||w())&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Ações Disponíveis"}),e.jsxs("div",{className:"space-y-3",children:[P.map((j,U)=>e.jsxs("div",{children:[e.jsx(F,{onClick:()=>f(j.action),disabled:c,variant:j.color==="danger"?"danger":"primary",className:"w-full",children:c?"Atualizando...":j.label}),j.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:j.description})]},U)),w()&&e.jsxs("div",{children:[e.jsxs(F,{onClick:()=>R(!0),variant:"primary",className:"w-full",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Avaliar ",m()==="buyer"?"Vendedor":"Comprador"]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Compartilhe sua experiência com esta transação"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Detalhes do Pedido"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"ID do Pedido:"}),e.jsxs("span",{className:"font-mono",children:["#",(te=n._id)==null?void 0:te.slice(-8)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data do Pedido:"}),e.jsx("span",{children:C(n.created_at)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Método de Pagamento:"}),e.jsx("span",{children:n.payment_method||"A combinar"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx(K,{variant:v(n.status),children:y(n.status)})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["R$ ",parseFloat(n.total_price||0).toFixed(2)]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Suporte"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Problemas com este pedido?"}),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Reportar Problema"]})]})]})]})]}),e.jsx(Po,{isOpen:p,onClose:()=>R(!1),order:n,onSuccess:N})]})},$o=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(!1),[o,i]=d.useState("create"),[c,h]=d.useState(null),[u,g]=d.useState(""),[p,R]=d.useState("all"),[x,f]=d.useState(1),[m,k]=d.useState(1),v=Oe();d.useEffect(()=>{b()},[x,u,p]);const b=async()=>{var $;r(!0);try{const P=await v.get("/games");P.success&&(($=P.data)!=null&&$.games)?t(P.data.games):t([])}catch(P){console.error("Erro ao carregar jogos:",P),t([])}finally{r(!1)}},y=()=>{i("create"),h(null),l(!0)},A=$=>{i("edit"),h($),l(!0)},w=async $=>{if(window.confirm("Tem certeza que deseja deletar este jogo?"))try{await v.delete(`/games/${$}`),await b()}catch(P){console.error("Erro ao deletar jogo:",P)}},N=async($,P)=>{try{await v.put(`/games/${$}`,{is_featured:!P}),await b()}catch(_){console.error("Erro ao alterar destaque:",_)}},C=async($,P)=>{try{await v.put(`/games/${$}`,{is_active:!P}),await b()}catch(_){console.error("Erro ao alterar status:",_)}},E=s.filter($=>{const P=$.name.toLowerCase().includes(u.toLowerCase()),_=p==="all"||p==="active"&&$.is_active||p==="inactive"&&!$.is_active||p==="featured"&&$.is_featured;return P&&_});return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gestão de Jogos"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie jogos, categorias e destaques"})]}),e.jsxs(F,{onClick:y,className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Adicionar Jogo"]})]}),e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar jogos...",value:u,onChange:$=>g($.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:p,onChange:$=>R($.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"active",children:"Ativos"}),e.jsx("option",{value:"inactive",children:"Inativos"}),e.jsx("option",{value:"featured",children:"Em Destaque"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Es,{title:"Total de Jogos",value:s.length,icon:It,color:"blue"}),e.jsx(Es,{title:"Jogos Ativos",value:s.filter($=>$.is_active).length,icon:ua,color:"green"}),e.jsx(Es,{title:"Em Destaque",value:s.filter($=>$.is_featured).length,icon:Ae,color:"yellow"}),e.jsx(Es,{title:"Com Anúncios",value:s.reduce(($,P)=>$+(P.ads_count||0),0),icon:Fe,color:"purple"})]}),E.length===0?e.jsxs(se,{className:"p-8 text-center",children:[e.jsx(It,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum jogo encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece adicionando o primeiro jogo à plataforma"}),e.jsx(F,{onClick:y,children:"Adicionar Primeiro Jogo"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:E.map($=>e.jsx(Fo,{game:$,onEdit:A,onDelete:w,onToggleFeatured:N,onToggleActive:C},$._id))}),m>1&&e.jsx(Cs,{currentPage:x,totalPages:m,onPageChange:f}),n&&e.jsx(Lo,{type:o,game:c,onClose:()=>l(!1),onSave:b})]})},Fo=({game:s,onEdit:t,onDelete:a,onToggleFeatured:r,onToggleActive:n})=>{const[l,o]=d.useState(!1);return e.jsxs(se,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.image_url||"/placeholder-game.png",alt:s.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"absolute top-2 left-2 flex gap-1",children:[s.is_featured&&e.jsxs(K,{variant:"warning",size:"sm",className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"w-3 h-3"}),"Destaque"]}),!s.is_active&&e.jsx(K,{variant:"danger",size:"sm",children:"Inativo"})]}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>o(!l),className:"bg-white/90 hover:bg-white",children:e.jsx(dr,{className:"w-4 h-4"})}),l&&e.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10",children:[e.jsxs("button",{onClick:()=>t(s),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(xa,{className:"w-4 h-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>r(s._id,s.is_featured),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),s.is_featured?"Remover Destaque":"Destacar"]}),e.jsxs("button",{onClick:()=>n(s._id,s.is_active),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(ua,{className:"w-4 h-4"}),s.is_active?"Desativar":"Ativar"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:()=>a(s._id),className:"w-full px-3 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Deletar"]})]})]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.platform}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Criado em ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-3 h-3 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.ads_count||0," ads"]})]})]})]})]})},Lo=({type:s,game:t,onClose:a,onSave:r})=>{const[n,l]=d.useState({name:"",description:"",image_url:"",platform:"PC",category:"",is_featured:!1,is_active:!0}),[o,i]=d.useState(!1),[c,h]=d.useState(""),u=Oe();d.useEffect(()=>{t&&l(t)},[t]);const g=async p=>{var R,x;p.preventDefault(),i(!0),h("");try{s==="create"?await u.post("/games",n):await u.put(`/games/${t._id}`,n),r(),a()}catch(f){h(((x=(R=f.response)==null?void 0:R.data)==null?void 0:x.message)||"Erro ao salvar jogo")}finally{i(!1)}};return e.jsx(Me,{onClose:a,size:"lg",children:e.jsxs("form",{onSubmit:g,className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:s==="create"?"Adicionar Novo Jogo":"Editar Jogo"}),c&&e.jsx(Ws,{type:"error",message:c,className:"mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Jogo *"}),e.jsx("input",{type:"text",value:n.name,onChange:p=>l({...n,name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plataforma"}),e.jsxs("select",{value:n.platform,onChange:p=>l({...n,platform:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"PC",children:"PC"}),e.jsx("option",{value:"PlayStation",children:"PlayStation"}),e.jsx("option",{value:"Xbox",children:"Xbox"}),e.jsx("option",{value:"Nintendo",children:"Nintendo"}),e.jsx("option",{value:"Mobile",children:"Mobile"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),e.jsx("input",{type:"text",value:n.category,onChange:p=>l({...n,category:p.target.value}),placeholder:"Ex: FPS, RPG, Battle Royale...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL da Imagem"}),e.jsx("input",{type:"url",value:n.image_url,onChange:p=>l({...n,image_url:p.target.value}),placeholder:"https://exemplo.com/imagem.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{value:n.description,onChange:p=>l({...n,description:p.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descrição do jogo..."})]}),n.image_url&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview"}),e.jsx("img",{src:n.image_url,alt:"Preview",className:"w-full h-32 object-cover rounded-lg border",onError:p=>{p.target.style.display="none"}})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.is_featured,onChange:p=>l({...n,is_featured:p.target.checked}),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Jogo em destaque"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.is_active,onChange:p=>l({...n,is_active:p.target.checked}),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Jogo ativo"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:[e.jsx(F,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:o,children:o?"Salvando...":s==="create"?"Criar Jogo":"Salvar Alterações"})]})]})})},Es=({title:s,value:t,icon:a,color:r})=>{const n={blue:"text-blue-600 bg-blue-100",green:"text-green-600 bg-green-100",yellow:"text-yellow-600 bg-yellow-100",purple:"text-purple-600 bg-purple-100"};return e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t})]}),e.jsx("div",{className:`w-10 h-10 rounded-lg ${n[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-5 h-5"})})]})})},Oo=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(""),[o,i]=d.useState("all"),[c,h]=d.useState(null),[u,g]=d.useState(!1),p=Oe();d.useEffect(()=>{R()},[o]);const R=async()=>{r(!0);try{const m=await p.get("/support/admin/tickets",{params:{status:o!=="all"?o:void 0}});t(m.data.tickets||[])}catch(m){console.error("Erro ao carregar tickets:",m),t([])}finally{r(!1)}},x=m=>{h(m),g(!0)},f=m=>{const k={open:"danger",in_progress:"warning",resolved:"success",closed:"secondary"};return e.jsx(K,{variant:k[m],children:m})};return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Tickets de Suporte"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie e responda tickets dos usuários"})]})}),e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar tickets...",value:n,onChange:m=>l(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsxs("select",{value:o,onChange:m=>i(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"open",children:"Abertos"}),e.jsx("option",{value:"in_progress",children:"Em Progresso"}),e.jsx("option",{value:"resolved",children:"Resolvidos"}),e.jsx("option",{value:"closed",children:"Fechados"})]})]})}),s.length===0?e.jsxs(se,{className:"p-8 text-center",children:[e.jsx(qs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum ticket encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Não há tickets de suporte no momento"})]}):e.jsx("div",{className:"space-y-4",children:s.map(m=>{var k,v;return e.jsx(se,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:m.subject}),f(m.status),e.jsx(K,{variant:"secondary",children:m.priority})]}),e.jsx("p",{className:"text-gray-600 mb-3",children:m.message}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[(k=m.user)!=null&&k.profile_pic?e.jsx(Wa,{src:m.user.profile_pic,alt:m.user.username,type:"user",size:"thumbnail",className:"w-6 h-6 rounded-full object-cover",fallbackIcon:e.jsx(Z,{className:"w-4 h-4"})}):e.jsx(Z,{className:"w-4 h-4"}),((v=m.user)==null?void 0:v.username)||"Usuário"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-4 h-4"}),new Date(m.created_at).toLocaleString()]}),e.jsxs("div",{children:["Categoria: ",m.category]})]}),m.admin_response&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Resposta do Suporte:"}),e.jsx("p",{className:"text-blue-800 text-sm",children:m.admin_response})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx(F,{onClick:()=>x(m),size:"sm",variant:m.status==="open"?"primary":"outline",children:m.admin_response?"Atualizar":"Responder"})})]})},m._id)})}),u&&c&&e.jsx(zo,{ticket:c,onClose:()=>g(!1),onSave:R})]})},zo=({ticket:s,onClose:t,onSave:a})=>{const[r,n]=d.useState({status:s.status||"open",admin_response:s.admin_response||"",priority:s.priority||"medium"}),[l,o]=d.useState(!1),[i,c]=d.useState(""),h=Oe(),u=async g=>{var p,R;g.preventDefault(),o(!0),c("");try{await h.put(`/support/admin/tickets/${s._id}`,r),a(),t()}catch(x){c(((R=(p=x.response)==null?void 0:p.data)==null?void 0:R.message)||"Erro ao atualizar ticket")}finally{o(!1)}};return e.jsx(Me,{isOpen:!0,onClose:t,title:"Responder Ticket",size:"lg",children:e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[i&&e.jsx(Ws,{type:"error",message:i,className:"mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:r.status,onChange:g=>n({...r,status:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"in_progress",children:"Em Progresso"}),e.jsx("option",{value:"resolved",children:"Resolvido"}),e.jsx("option",{value:"closed",children:"Fechado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioridade"}),e.jsxs("select",{value:r.priority,onChange:g=>n({...r,priority:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"low",children:"Baixa"}),e.jsx("option",{value:"medium",children:"Média"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resposta"}),e.jsx("textarea",{value:r.admin_response,onChange:g=>n({...r,admin_response:g.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite sua resposta ao usuário...",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:[e.jsx(F,{type:"button",variant:"outline",onClick:t,children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:l,children:l?"Salvando...":"Salvar Resposta"})]})]})})},Uo=({isOpen:s,onClose:t,user:a,onUserUpdated:r})=>{const[n,l]=d.useState({username:"",email:"",first_name:"",last_name:"",bio:"",role:"user",is_active:!0,is_verified:!1,profile_pic:""});d.useEffect(()=>{a&&(l({username:a.username||"",email:a.email||"",first_name:a.first_name||"",last_name:a.last_name||"",bio:a.bio||"",role:a.role||"user",is_active:a.is_active!==!1,is_verified:a.is_verified||!1,profile_pic:a.profile_pic||""}),h({}))},[a]);const[o,i]=d.useState(!1),[c,h]=d.useState({}),u=Oe(),g=(x,f)=>{l(m=>({...m,[x]:f})),c[x]&&h(m=>({...m,[x]:null}))},p=()=>{const x={};return n.username.trim()?n.username.length<3&&(x.username="Username deve ter pelo menos 3 caracteres"):x.username="Username é obrigatório",n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(x.email="Email inválido"):x.email="Email é obrigatório",n.first_name&&n.first_name.length<2&&(x.first_name="Nome deve ter pelo menos 2 caracteres"),n.last_name&&n.last_name.length<2&&(x.last_name="Sobrenome deve ter pelo menos 2 caracteres"),n.bio&&n.bio.length>500&&(x.bio="Bio não pode ter mais de 500 caracteres"),x},R=async x=>{var m,k;x.preventDefault();const f=p();if(Object.keys(f).length>0){h(f);return}i(!0);try{const v={};if(Object.keys(n).forEach(y=>{n[y]!==a[y]&&(v[y]=n[y])}),Object.keys(v).length===0){t();return}const b=await u.put(`/support/admin/users/${a._id}`,v);b.success&&(r(b.data),t())}catch(v){console.error("Erro ao atualizar usuário:",v),(k=(m=v.response)==null?void 0:m.data)!=null&&k.message?h({submit:v.response.data.message}):h({submit:"Erro ao atualizar usuário"})}finally{i(!1)}};return a?e.jsx(Me,{isOpen:s,onClose:t,title:`Editar Usuário: ${a.username}`,size:"lg",children:e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:n.profile_pic?e.jsx("img",{src:n.profile_pic,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(Z,{className:"w-12 h-12 text-gray-400"})}),e.jsx("input",{type:"url",placeholder:"URL da imagem de perfil",value:n.profile_pic,onChange:x=>g("profile_pic",x.target.value),className:"text-sm px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Z,{className:"w-4 h-4 inline mr-2"}),"Username *"]}),e.jsx("input",{type:"text",value:n.username,onChange:x=>g("username",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.username?"border-red-500":"border-gray-300"}`,placeholder:"Username"}),c.username&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),c.username]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Be,{className:"w-4 h-4 inline mr-2"}),"Email *"]}),e.jsx("input",{type:"email",value:n.email,onChange:x=>g("email",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-500":"border-gray-300"}`,placeholder:"email@exemplo.com"}),c.email&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),c.email]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primeiro Nome"}),e.jsx("input",{type:"text",value:n.first_name,onChange:x=>g("first_name",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.first_name?"border-red-500":"border-gray-300"}`,placeholder:"Primeiro nome"}),c.first_name&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),c.first_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sobrenome"}),e.jsx("input",{type:"text",value:n.last_name,onChange:x=>g("last_name",x.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.last_name?"border-red-500":"border-gray-300"}`,placeholder:"Sobrenome"}),c.last_name&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),c.last_name]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{value:n.bio,onChange:x=>g("bio",x.target.value),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${c.bio?"border-red-500":"border-gray-300"}`,placeholder:"Biografia do usuário..."}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mt-1",children:[e.jsxs("span",{children:[n.bio.length,"/500 caracteres"]}),c.bio&&e.jsxs("span",{className:"text-red-500 flex items-center",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),c.bio]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ie,{className:"w-4 h-4 inline mr-2"}),"Função"]}),e.jsxs("select",{value:n.role,onChange:x=>g("role",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"user",children:"Usuário"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"support",children:"Suporte"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ha,{className:"w-4 h-4 inline mr-2"}),"Status"]}),e.jsxs("select",{value:n.is_active,onChange:x=>g("is_active",x.target.value==="true"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:!0,children:"Ativo"}),e.jsx("option",{value:!1,children:"Inativo"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Verificado"}),e.jsxs("select",{value:n.is_verified,onChange:x=>g("is_verified",x.target.value==="true"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:!0,children:"Verificado"}),e.jsx("option",{value:!1,children:"Não Verificado"})]})]})]}),c.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"w-5 h-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700",children:c.submit})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsxs(F,{type:"button",variant:"outline",onClick:t,disabled:o,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Cancelar"]}),e.jsxs(F,{type:"submit",disabled:o,children:[e.jsx(oa,{className:"w-4 h-4 mr-2"}),o?"Salvando...":"Salvar Alterações"]})]})]})}):null},Io=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(""),[o,i]=d.useState("all"),[c,h]=d.useState("all"),[u,g]=d.useState(1),[p,R]=d.useState(1),[x,f]=d.useState(null),[m,k]=d.useState(!1),v=Oe();d.useEffect(()=>{b()},[u,n,o,c]);const b=async()=>{var E,$;r(!0);try{const P=await v.get("/support/admin/users",{params:{page:u,limit:20,search:n||void 0,role:o!=="all"?o:void 0,status:c!=="all"?c:void 0}});P.success&&(t(((E=P.data)==null?void 0:E.users)||[]),R((($=P.data)==null?void 0:$.total_pages)||1))}catch(P){console.error("Erro ao carregar usuários:",P),t([])}finally{r(!1)}},y=async(E,$)=>{try{await v.put(`/support/admin/users/${E}`,{is_active:!$}),await b()}catch(P){console.error("Erro ao alterar status do usuário:",P)}},A=E=>{f(E),k(!0)},w=E=>{t($=>$.map(P=>P._id===E._id?E:P))},N=()=>{k(!1),f(null)},C=s.filter(E=>{var L;const $=E.username.toLowerCase().includes(n.toLowerCase())||((L=E.email)==null?void 0:L.toLowerCase().includes(n.toLowerCase())),P=o==="all"||E.role===o,_=c==="all"||c==="active"&&E.is_active||c==="inactive"&&!E.is_active;return $&&P&&_});return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gestão de Usuários"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie usuários, permissões e atividades"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(As,{title:"Total de Usuários",value:s.length,icon:Ue,color:"blue"}),e.jsx(As,{title:"Usuários Ativos",value:s.filter(E=>E.is_active).length,icon:ha,color:"green"}),e.jsx(As,{title:"Administradores",value:s.filter(E=>E.role==="admin").length,icon:Ie,color:"purple"}),e.jsx(As,{title:"Usuários Hoje",value:s.filter(E=>{const $=new Date().toDateString();return new Date(E.created_at).toDateString()===$}).length,icon:ps,color:"orange"})]}),e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:n,onChange:E=>l(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:o,onChange:E=>i(E.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todas as Funções"}),e.jsx("option",{value:"user",children:"Usuário"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"support",children:"Suporte"})]}),e.jsxs("select",{value:c,onChange:E=>h(E.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"})]})]})]})}),e.jsx(se,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Função"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cadastro"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(E=>e.jsx(Mo,{user:E,onToggleStatus:y,onEdit:A},E._id))})]})})}),p>1&&e.jsx(Cs,{currentPage:u,totalPages:p,onPageChange:g}),e.jsx(Uo,{isOpen:m,onClose:N,user:x,onUserUpdated:w})]})},Mo=({user:s,onToggleStatus:t,onEdit:a})=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx(Wa,{src:s.profile_pic||s.profile_image,alt:s.username,type:"user",size:"thumbnail",className:"h-10 w-10 rounded-full object-cover",fallbackIcon:e.jsx(Ue,{className:"w-6 h-6 text-gray-400"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.username}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s._id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.email||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:s.role==="admin"?"danger":s.role==="support"?"warning":"default",children:s.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:s.is_active?"success":"danger",children:s.is_active?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),new Date(s.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:()=>a(s),title:"Editar usuário",children:e.jsx(xa,{className:"w-4 h-4"})}),e.jsx(F,{size:"sm",variant:s.is_active?"outline":"default",onClick:()=>t(s._id,s.is_active),children:s.is_active?"Desativar":"Ativar"})]})})]}),As=({title:s,value:t,icon:a,color:r})=>{const n={blue:"text-blue-600 bg-blue-100",green:"text-green-600 bg-green-100",purple:"text-purple-600 bg-purple-100",orange:"text-orange-600 bg-orange-100"};return e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t})]}),e.jsx("div",{className:`w-10 h-10 rounded-lg ${n[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-5 h-5"})})]})})},Bo=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(""),[o,i]=d.useState("all"),[c,h]=d.useState(1),[u,g]=d.useState(1),[p,R]=d.useState(null),[x,f]=d.useState(!1),m=Oe();be(),d.useEffect(()=>{k()},[c,n,o]);const k=async()=>{var w,N;r(!0);try{const C=await m.get("/support/admin/orders",{params:{page:c,limit:20,search:n||void 0,status:o!=="all"?o:void 0}});C.success&&(t(((w=C.data)==null?void 0:w.orders)||[]),g(((N=C.data)==null?void 0:N.total_pages)||1))}catch(C){console.error("Erro ao carregar pedidos:",C),t([])}finally{r(!1)}},v=async(w,N)=>{try{await m.put(`/support/admin/orders/${w}`,{status:N}),await k()}catch(C){console.error("Erro ao atualizar status do pedido:",C)}},b=async w=>{try{const N=await m.get(`/admin/orders/${w}`);N.success&&(R(N.data),f(!0))}catch(N){console.error("Erro ao carregar detalhes do pedido:",N)}},y=s.filter(w=>{var E,$;const N=w._id.includes(n)||((E=w.buyer_name)==null?void 0:E.toLowerCase().includes(n.toLowerCase()))||(($=w.seller_name)==null?void 0:$.toLowerCase().includes(n.toLowerCase())),C=o==="all"||w.status===o;return N&&C}),A=s.reduce((w,N)=>N.status==="completed"?w+(N.total_price||0):w,0);return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gestão de Pedidos"}),e.jsx("p",{className:"text-gray-600",children:"Monitore e gerencie pedidos da plataforma"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Rs,{title:"Total de Pedidos",value:s.length,icon:we,color:"blue"}),e.jsx(Rs,{title:"Pedidos Completos",value:s.filter(w=>w.status==="completed").length,icon:ge,color:"green"}),e.jsx(Rs,{title:"Pendentes",value:s.filter(w=>w.status==="pending").length,icon:ce,color:"orange"}),e.jsx(Rs,{title:"Receita Total",value:`R$ ${A.toFixed(2)}`,icon:Fe,color:"purple"})]}),e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pedidos...",value:n,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:o,onChange:w=>i(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"confirmed",children:"Confirmado"}),e.jsx("option",{value:"shipped",children:"Enviado"}),e.jsx("option",{value:"delivered",children:"Entregue"}),e.jsx("option",{value:"completed",children:"Completo"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})})]})}),e.jsx(se,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprador"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(w=>e.jsx(qo,{order:w,onUpdateStatus:v,onViewDetails:b},w._id))})]})})}),u>1&&e.jsx(Cs,{currentPage:c,totalPages:u,onPageChange:h}),e.jsx(Me,{isOpen:x,onClose:()=>f(!1),title:"Detalhes do Pedido",size:"lg",children:p&&e.jsx(Vo,{order:p,onClose:()=>f(!1)})})]})},qo=({order:s,onUpdateStatus:t,onViewDetails:a})=>{const r=l=>({pending:"warning",confirmed:"info",shipped:"default",delivered:"success",completed:"success",cancelled:"danger"})[l]||"default",n=l=>({pending:"Pendente",confirmed:"Confirmado",shipped:"Enviado",delivered:"Entregue",completed:"Completo",cancelled:"Cancelado"})[l]||l;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",s._id.slice(-8)]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.ad_title||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.buyer_name||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.seller_name||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["R$ ",(s.total_price||0).toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:r(s.status),children:n(s.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),new Date(s.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:()=>a(s._id),title:"Ver detalhes do pedido",children:e.jsx(ue,{className:"w-4 h-4"})}),s.status!=="completed"&&s.status!=="cancelled"&&e.jsxs("select",{value:s.status,onChange:l=>t(s._id,l.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded",children:[e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"confirmed",children:"Confirmado"}),e.jsx("option",{value:"shipped",children:"Enviado"}),e.jsx("option",{value:"delivered",children:"Entregue"}),e.jsx("option",{value:"completed",children:"Completo"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})]})})]})},Rs=({title:s,value:t,icon:a,color:r})=>{const n={blue:"text-blue-600 bg-blue-100",green:"text-green-600 bg-green-100",orange:"text-orange-600 bg-orange-100",purple:"text-purple-600 bg-purple-100"};return e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t})]}),e.jsx("div",{className:`w-10 h-10 rounded-lg ${n[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-5 h-5"})})]})})},Vo=({order:s,onClose:t})=>{var n,l,o,i,c,h,u,g,p,R,x,f,m,k,v,b;const a=y=>{try{return y?new Date(y).toLocaleString("pt-BR"):"Data não disponível"}catch{return"Data inválida"}},r=y=>y?y.first_name&&y.last_name?`${y.first_name} ${y.last_name}`:y.username||"N/A":"N/A";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Pedido #",(n=s._id)==null?void 0:n.slice(-8)]}),e.jsx(K,{variant:Go(s.status),children:ra(s.status)})]}),e.jsxs("p",{className:"text-gray-600",children:["Criado em ",a(s.created_at)]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informações do Comprador"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",r(s.buyer)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((l=s.buyer)==null?void 0:l.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",((o=s.buyer)==null?void 0:o.username)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.buyer_id]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informações do Vendedor"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",r(s.seller)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((i=s.seller)==null?void 0:i.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",((c=s.seller)==null?void 0:c.username)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.seller_id]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Produto"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[(((h=s.ad)==null?void 0:h.image_url)||((g=(u=s.ad)==null?void 0:u.images)==null?void 0:g[0]))&&e.jsx("img",{src:((p=s.ad)==null?void 0:p.image_url)||((x=(R=s.ad)==null?void 0:R.images)==null?void 0:x[0]),alt:((f=s.ad)==null?void 0:f.title)||"Produto",className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium",children:((m=s.ad)==null?void 0:m.title)||s.ad_title||"Produto não identificado"}),e.jsx("p",{className:"text-sm text-gray-600",children:((k=s.ad)==null?void 0:k.description)||s.ad_description||"Sem descrição"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Jogo: ",((b=(v=s.ad)==null?void 0:v.game)==null?void 0:b.name)||"N/A"]}),e.jsxs("p",{className:"text-lg font-bold text-green-600 mt-2",children:["R$ ",(s.total_price||s.price||0).toFixed(2)]})]})]})})]}),s.status_history&&s.status_history.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Histórico do Pedido"}),e.jsx("div",{className:"space-y-3",children:s.status_history.map((y,A)=>e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:ra(y.status)}),e.jsx("p",{className:"text-gray-600",children:new Date(y.timestamp).toLocaleString()})]})]},A))})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(F,{onClick:t,variant:"outline",children:"Fechar"})})]})},Go=s=>({pending:"warning",confirmed:"info",shipped:"default",delivered:"success",completed:"success",cancelled:"danger"})[s]||"default",ra=s=>({pending:"Pendente",confirmed:"Confirmado",shipped:"Enviado",delivered:"Entregue",completed:"Completo",cancelled:"Cancelado"})[s]||s,Jo=()=>{var P;const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(""),[o,i]=d.useState("all"),[c,h]=d.useState(1),[u,g]=d.useState(1),[p,R]=d.useState(null),[x,f]=d.useState(!1),[m,k]=d.useState(!1),[v,b]=d.useState(!1),y=Oe();d.useEffect(()=>{A()},[c,n,o]);const A=async()=>{var _;r(!0);try{const L=new URLSearchParams({page:c,limit:10,search:n,status:o}),V=await y.get(`/admin/ads?${L}`);V.success&&(t(V.data.ads||[]),g(((_=V.data)==null?void 0:_.total_pages)||1))}catch(L){console.error("Erro ao carregar anúncios:",L),t([])}finally{r(!1)}},w=async()=>{if(p){b(!0);try{(await y.delete(`/admin/ads/${p._id}`)).success&&(await A(),f(!1),R(null))}catch(_){console.error("Erro ao deletar anúncio:",_)}finally{b(!1)}}},N=async(_,L)=>{try{await y.put(`/admin/ads/${_}/status`,{status:L}),await A()}catch(V){console.error("Erro ao atualizar status do anúncio:",V)}},C=_=>{R(_),k(!0)},E=s.filter(_=>{var O,D,I,G,Q;const L=((O=_.title)==null?void 0:O.toLowerCase().includes(n.toLowerCase()))||((I=(D=_.seller)==null?void 0:D.username)==null?void 0:I.toLowerCase().includes(n.toLowerCase()))||((Q=(G=_.game)==null?void 0:G.name)==null?void 0:Q.toLowerCase().includes(n.toLowerCase())),V=o==="all"||_.status===o;return L&&V}),$=s.reduce((_,L)=>_+(L.price||0),0);return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gestão de Anúncios"}),e.jsx("p",{className:"text-gray-600",children:"Monitore e gerencie anúncios da plataforma"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Ts,{title:"Total de Anúncios",value:s.length,icon:ga,color:"blue"}),e.jsx(Ts,{title:"Anúncios Ativos",value:s.filter(_=>_.status==="active").length,icon:ge,color:"green"}),e.jsx(Ts,{title:"Pendentes",value:s.filter(_=>_.status==="pending").length,icon:ce,color:"orange"}),e.jsx(Ts,{title:"Valor Total",value:`R$ ${$.toFixed(2)}`,icon:Fe,color:"purple"})]}),e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar anúncios, vendedores ou jogos...",value:n,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:o,onChange:_=>i(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"banned",children:"Banido"})]})})]})}),e.jsx(se,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Anúncio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendedor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jogo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preço"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(_=>e.jsx(Ho,{ad:_,onDelete:L=>{R(L),f(!0)},onView:()=>C(_),onUpdateStatus:N},_._id))})]})})}),u>1&&e.jsx(Cs,{currentPage:c,totalPages:u,onPageChange:h}),e.jsx(Me,{isOpen:x,onClose:()=>f(!1),title:"Confirmar Exclusão",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Tem certeza que deseja deletar este anúncio?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Esta ação não pode ser desfeita."})]})]}),p&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:p.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Vendedor: ",((P=p.seller)==null?void 0:P.username)||"N/A"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>f(!1),disabled:v,children:"Cancelar"}),e.jsx(F,{variant:"danger",onClick:w,disabled:v,children:v?"Deletando...":"Deletar"})]})]})}),e.jsx(Me,{isOpen:m,onClose:()=>k(!1),title:"Detalhes do Anúncio",size:"lg",children:p&&e.jsx(Qo,{ad:p,onClose:()=>k(!1)})})]})},Ho=({ad:s,onDelete:t,onView:a,onUpdateStatus:r})=>{var o,i;const n=c=>({active:"success",inactive:"default",pending:"warning",banned:"danger"})[c]||"default",l=c=>({active:"Ativo",inactive:"Inativo",pending:"Pendente",banned:"Banido"})[c]||c;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[s.images&&s.images.length>0&&e.jsx("img",{src:s.images[0],alt:s.title,className:"w-12 h-12 object-cover rounded mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500",children:s._id.slice(-8)})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:((o=s.seller)==null?void 0:o.username)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:((i=s.game)==null?void 0:i.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["R$ ",(s.price||s.price_per_hour||0).toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:n(s.status),children:l(s.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),new Date(s.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:a,title:"Ver detalhes",children:e.jsx(ue,{className:"w-4 h-4"})}),s.status!=="banned"&&e.jsxs("select",{value:s.status,onChange:c=>r(s._id,c.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"banned",children:"Banir"})]}),e.jsx(F,{size:"sm",variant:"danger",onClick:()=>t(s),title:"Deletar anúncio",children:e.jsx(Re,{className:"w-4 h-4"})})]})})]})},Ts=({title:s,value:t,icon:a,color:r})=>{const n={blue:"bg-blue-500 text-white",green:"bg-green-500 text-white",orange:"bg-orange-500 text-white",purple:"bg-purple-500 text-white"};return e.jsx(se,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:t})]}),e.jsx("div",{className:`w-12 h-12 rounded-lg ${n[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-6 h-6"})})]})})},Qo=({ad:s,onClose:t})=>{var n,l,o;const a=i=>{try{return i?new Date(i).toLocaleString("pt-BR"):"Data não disponível"}catch{return"Data inválida"}},r=i=>i.price||i.price_per_hour||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.title||"Título não disponível"}),e.jsx(K,{variant:Wo(s.status),children:Xo(s.status)})]}),e.jsxs("p",{className:"text-gray-600",children:["Criado em ",a(s.created_at)]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informações do Anúncio"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Preço:"})," R$ ",r(s).toFixed(2)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Jogo:"})," ",((n=s.game)==null?void 0:n.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Plataforma:"})," ",s.platform||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo:"})," ",s.ad_type||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Condição:"})," ",s.condition||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s._id]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Vendedor"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",((l=s.seller)==null?void 0:l.username)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((o=s.seller)==null?void 0:o.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.seller_id]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Descrição"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm",children:s.description||"Sem descrição"})})]}),s.images&&s.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Imagens"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:s.images.map((i,c)=>e.jsx("img",{src:i,alt:`${s.title} ${c+1}`,className:"w-full h-32 object-cover rounded-lg"},c))})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(F,{onClick:t,variant:"outline",children:"Fechar"})})]})},Wo=s=>({active:"success",inactive:"default",pending:"warning",banned:"danger"})[s]||"default",Xo=s=>({active:"Ativo",inactive:"Inativo",pending:"Pendente",banned:"Banido"})[s]||s,Ko=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState(1),[o,i]=d.useState(1),c=Oe();d.useEffect(()=>{h()},[n]);const h=async()=>{r(!0);try{const p=await c.get("/support/admin/audit-logs",{params:{page:n,limit:20}});t(p.data.logs||[]),i(Math.ceil((p.data.total||0)/20))}catch(p){console.error("Erro ao carregar logs:",p),t([])}finally{r(!1)}},u=p=>{const x={create:ue,update:Ie,delete:me,read:ps}[p]||ps;return e.jsx(x,{className:"w-4 h-4"})},g=p=>({create:"success",update:"warning",delete:"danger",read:"primary"})[p]||"secondary";return a?e.jsx(W,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Logs de Auditoria"}),e.jsx("p",{className:"text-gray-600",children:"Monitore ações administrativas e eventos de segurança"})]})}),s.length===0?e.jsxs(se,{className:"p-8 text-center",children:[e.jsx(ps,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum log encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Não há logs de auditoria no momento"})]}):e.jsx(se,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ação"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recurso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(K,{variant:g(p.action),className:"flex items-center gap-1",children:[u(p.action),p.action]})})})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:p.resource_type}),p.resource_id&&e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",p.resource_id.slice(-8)]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("div",{className:"text-sm text-gray-900",children:p.admin_username||"Sistema"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),new Date(p.timestamp).toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:p.success?"success":"danger",children:p.success?"Sucesso":"Falha"})})]},p._id))})]})})}),o>1&&e.jsx(Cs,{currentPage:n,totalPages:o,onPageChange:l})]})},Zo=()=>{const[s,t]=d.useState([]),[a,r]=d.useState(!0),[n,l]=d.useState("all"),[o,i]=d.useState(null),[c,h]=d.useState(!1),[u,g]=d.useState({});d.useEffect(()=>{p()},[n]);const p=async()=>{r(!0);try{const w=[{_id:"1",reporter:{username:"user123",first_name:"João",last_name:"Silva"},reported_item_id:"ad_123",reported_item_type:"ad",reason:"spam",details:"Este anúncio está sendo postado repetidamente com o mesmo conteúdo",status:"pending",created_at:new Date(Date.now()-72e5).toISOString(),updated_at:new Date(Date.now()-72e5).toISOString()},{_id:"2",reporter:{username:"maria456",first_name:"Maria",last_name:"Santos"},reported_item_id:"ad_456",reported_item_type:"ad",reason:"fake",details:"O vendedor está anunciando um produto que não possui",status:"reviewed",admin_notes:"Verificado e confirmado como falso",reviewed_by:"admin",reviewed_at:new Date(Date.now()-36e5).toISOString(),created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString()},{_id:"3",reporter:{username:"pedro789",first_name:"Pedro",last_name:"Costa"},reported_item_id:"user_789",reported_item_type:"user",reason:"inappropriate",details:"Usuário está enviando mensagens ofensivas",status:"resolved",admin_notes:"Usuário foi advertido e suspendido temporariamente",reviewed_by:"admin",reviewed_at:new Date(Date.now()-18e5).toISOString(),created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-18e5).toISOString()}];t(w)}catch(w){console.error("Erro ao carregar reports:",w),S.error("Erro ao carregar reports")}r(!1)},R=w=>new Date(w).toLocaleString("pt-BR"),x=w=>({spam:"Spam",fake:"Anúncio falso",inappropriate:"Conteúdo inapropriado",scam:"Tentativa de golpe",wrong_category:"Categoria incorreta",other:"Outro motivo"})[w]||w,f=w=>{switch(w){case"pending":return"warning";case"reviewed":return"primary";case"resolved":return"success";case"dismissed":return"secondary";default:return"default"}},m=w=>{switch(w){case"pending":return"Pendente";case"reviewed":return"Analisado";case"resolved":return"Resolvido";case"dismissed":return"Descartado";default:return w}},k=async(w,N,C="")=>{g(E=>({...E,[w]:!0}));try{await new Promise(E=>setTimeout(E,1e3)),t(E=>E.map($=>$._id===w?{...$,status:N,admin_notes:C,reviewed_by:"admin",reviewed_at:new Date().toISOString(),updated_at:new Date().toISOString()}:$)),S.success(`Report ${m(N).toLowerCase()}`),h(!1),i(null)}catch{S.error("Erro ao atualizar status do report")}g(E=>({...E,[w]:!1}))},v=w=>{i(w),h(!0)},b=s.filter(w=>n==="all"?!0:w.status===n),A=(()=>({all:s.length,pending:s.filter(w=>w.status==="pending").length,reviewed:s.filter(w=>w.status==="reviewed").length,resolved:s.filter(w=>w.status==="resolved").length,dismissed:s.filter(w=>w.status==="dismissed").length}))();return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(W,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Bs,{className:"w-6 h-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Gerenciar Reports"}),e.jsxs("p",{className:"text-gray-600",children:[A.pending," pendente",A.pending!==1?"s":""," de ",A.all," total"]})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"Todos",count:A.all},{key:"pending",label:"Pendentes",count:A.pending},{key:"reviewed",label:"Analisados",count:A.reviewed},{key:"resolved",label:"Resolvidos",count:A.resolved},{key:"dismissed",label:"Descartados",count:A.dismissed}].map(w=>e.jsxs("button",{onClick:()=>l(w.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===w.key?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[w.label," (",w.count,")"]},w.key))}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reporter"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item Reportado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(w=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[w.reporter.first_name," ",w.reporter.last_name]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["@",w.reporter.username]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:w.reported_item_type==="ad"?"Anúncio":"Usuário"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",w.reported_item_id]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:x(w.reason)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{variant:f(w.status),children:m(w.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R(w.created_at)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>v(w),className:"text-blue-600 hover:text-blue-900 mr-3",children:e.jsx(ue,{className:"w-4 h-4"})}),w.status==="pending"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>k(w._id,"resolved"),disabled:u[w._id],className:"text-green-600 hover:text-green-900",title:"Resolver",children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(w._id,"dismissed"),disabled:u[w._id],className:"text-red-600 hover:text-red-900",title:"Descartar",children:e.jsx(Se,{className:"w-4 h-4"})})]})]})]},w._id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Bs,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Nenhum report encontrado"}),e.jsx("p",{className:"text-gray-600",children:n==="all"?"Ainda não há reports para revisar":`Nenhum report ${m(n).toLowerCase()}`})]})}),c&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Detalhes do Report"}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"✕"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reporter"}),e.jsxs("p",{className:"text-gray-900",children:[o.reporter.first_name," ",o.reporter.last_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["@",o.reporter.username]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx(K,{variant:f(o.status),children:m(o.status)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Reportado"}),e.jsxs("p",{className:"text-gray-900",children:[o.reported_item_type==="ad"?"Anúncio":"Usuário","(ID: ",o.reported_item_id,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo"}),e.jsx("p",{className:"text-gray-900",children:x(o.reason)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Detalhes"}),e.jsx("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-lg",children:o.details||"Nenhum detalhe fornecido"})]}),o.admin_notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas do Admin"}),e.jsx("p",{className:"text-gray-900 bg-blue-50 p-3 rounded-lg",children:o.admin_notes})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Criado em"}),e.jsx("p",{className:"text-gray-900",children:R(o.created_at)})]}),o.reviewed_at&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revisado em"}),e.jsx("p",{className:"text-gray-900",children:R(o.reviewed_at)})]})]})]}),o.status==="pending"&&e.jsxs("div",{className:"flex space-x-3 pt-6 border-t border-gray-200 mt-6",children:[e.jsxs(F,{onClick:()=>k(o._id,"resolved","Report resolvido pelo administrador"),disabled:u[o._id],className:"flex-1",children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Resolver"]}),e.jsxs(F,{variant:"outline",onClick:()=>k(o._id,"dismissed","Report descartado - sem violação encontrada"),disabled:u[o._id],className:"flex-1",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Descartar"]})]})]})})})]})},Yo=()=>{var h,u;const[s,t]=d.useState("dashboard"),[a,r]=d.useState(!0),[n,l]=d.useState({}),o=Oe();d.useEffect(()=>{i()},[]);const i=async()=>{r(!0);try{const g=await o.get("/support/admin/stats");l(g.data)}catch(g){console.error("Erro ao carregar dados:",g)}finally{r(!1)}},c=[{id:"dashboard",label:"Dashboard",icon:zs,description:"Visão geral do sistema"},{id:"tickets",label:"Tickets",icon:qs,description:"Suporte ao cliente",badge:((h=n.tickets)==null?void 0:h.open)||0},{id:"games",label:"Jogos",icon:Us,description:"Gestão de jogos"},{id:"users",label:"Usuários",icon:Ue,description:"Gestão de usuários"},{id:"ads",label:"Anúncios",icon:ga,description:"Gestão de anúncios"},{id:"orders",label:"Pedidos",icon:we,description:"Gestão de pedidos"},{id:"audit",label:"Auditoria",icon:ps,description:"Logs do sistema"},{id:"reports",label:"Reports",icon:me,description:"Gerenciar reports de usuários",badge:((u=n.reports)==null?void 0:u.pending)||0}];return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Painel Administrativo"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie e monitore o GameUnite"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(F,{onClick:i,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Atualizar"]}),e.jsx(K,{variant:"success",className:"px-3 py-1",children:"Sistema Online"})]})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"px-6",children:e.jsx("nav",{className:"flex space-x-0 overflow-x-auto",children:c.map(g=>{const p=g.icon;return e.jsxs("button",{onClick:()=>t(g.id),className:`flex items-center gap-3 px-6 py-4 border-b-2 font-medium text-sm transition-all whitespace-nowrap ${s===g.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(p,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:g.label}),g.badge>0&&e.jsx(K,{variant:"danger",size:"sm",children:g.badge})]},g.id)})})})}),e.jsxs("div",{className:"p-6",children:[s==="dashboard"&&e.jsx(el,{stats:n,setActiveTab:t}),s==="tickets"&&e.jsx(sl,{}),s==="games"&&e.jsx(tl,{}),s==="users"&&e.jsx(al,{}),s==="ads"&&e.jsx(rl,{}),s==="orders"&&e.jsx(nl,{}),s==="audit"&&e.jsx(ol,{}),s==="reports"&&e.jsx(ll,{})]})]})},el=({stats:s,setActiveTab:t})=>{var a,r,n,l,o,i,c,h,u,g;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Ps,{title:"Total de Usuários",value:((a=s.users)==null?void 0:a.total)||0,icon:Ue,color:"blue",subtitle:`${((r=s.users)==null?void 0:r.active)||0} ativos`}),e.jsx(Ps,{title:"Tickets Abertos",value:((n=s.tickets)==null?void 0:n.open)||0,icon:me,color:"red",subtitle:`${((l=s.tickets)==null?void 0:l.total)||0} total`}),e.jsx(Ps,{title:"Total de Pedidos",value:((o=s.orders)==null?void 0:o.total)||0,icon:we,color:"green",subtitle:`${((i=s.orders)==null?void 0:i.completed)||0} completos`}),e.jsx(Ps,{title:"Receita Total",value:`R$ ${(((c=s.revenue)==null?void 0:c.total)||0).toFixed(2)}`,icon:Fe,color:"purple",subtitle:`${((h=s.orders)==null?void 0:h.completed)||0} vendas`})]}),e.jsxs(se,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Ações Rápidas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(xt,{title:"Novo Jogo",description:"Adicionar jogo à plataforma",icon:Ne,color:"blue",onClick:()=>t("games")}),e.jsx(xt,{title:"Verificar Tickets",description:"Responder tickets pendentes",icon:qs,color:"orange",onClick:()=>window.location.href="/admin/support"}),e.jsx(xt,{title:"Ver Pedidos",description:"Monitorar pedidos recentes",icon:zs,color:"green",onClick:()=>t("orders")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(se,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Atividade Recente"}),e.jsx("div",{className:"space-y-4",children:(g=(u=s.tickets)==null?void 0:u.recent)==null?void 0:g.map((p,R)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(qs,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:p.subject}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(p.created_at).toLocaleString()})]}),e.jsx(K,{variant:p.status==="open"?"danger":"success",children:p.status})]},R))})]}),e.jsxs(se,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Status do Sistema"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ds,{label:"API Backend",status:"online"}),e.jsx(Ds,{label:"Base de Dados",status:"online"}),e.jsx(Ds,{label:"Storage",status:"online"}),e.jsx(Ds,{label:"Cache",status:"warning"})]})]})]})]})},Ps=({title:s,value:t,icon:a,color:r,trend:n,subtitle:l})=>{const o={blue:"bg-blue-500 text-white",red:"bg-red-500 text-white",green:"bg-green-500 text-white",purple:"bg-purple-500 text-white"};return e.jsx(se,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:t}),l&&e.jsx("p",{className:"text-sm mt-1 text-gray-500",children:l}),n&&e.jsxs("p",{className:`text-sm mt-1 ${n.startsWith("+")?"text-green-600":"text-red-600"}`,children:[n," vs mês anterior"]})]}),e.jsx("div",{className:`w-12 h-12 rounded-lg ${o[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-6 h-6"})})]})})},xt=({title:s,description:t,icon:a,color:r,onClick:n})=>{const l={blue:"text-blue-600 bg-blue-100",orange:"text-orange-600 bg-orange-100",green:"text-green-600 bg-green-100"};return e.jsx(se,{className:"p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:n,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${l[r]} flex items-center justify-center`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:t})]})]})})},Ds=({label:s,status:t})=>{const r={online:{color:"bg-green-500",text:"Online"},warning:{color:"bg-yellow-500",text:"Atenção"},offline:{color:"bg-red-500",text:"Offline"}}[t];return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.color}`}),e.jsx("span",{className:"text-sm text-gray-600",children:r.text})]})]})},sl=()=>e.jsx(Oo,{}),tl=()=>e.jsx($o,{}),al=()=>e.jsx(Io,{}),rl=()=>e.jsx(Jo,{}),nl=()=>e.jsx(Bo,{}),ol=()=>e.jsx(Ko,{}),ll=()=>e.jsx(Zo,{}),il=()=>{var re,M,X,te;be();const[s,t]=d.useState([]),[a,r]=d.useState({}),[n,l]=d.useState(!0),[o,i]=d.useState(!1),[c,h]=d.useState(null),[u,g]=d.useState(!1),[p,R]=d.useState(new Set),[x,f]=d.useState(1),[m,k]=d.useState(1),[v,b]=d.useState({status:"",category:"",priority:"",search:""}),[y,A]=d.useState({status:"",priority:"",admin_response:""});d.useEffect(()=>{w()},[x,v]);const w=async()=>{l(!0);try{await Promise.all([N(),C()])}catch(j){console.error("Erro ao carregar dados:",j),S.error("Erro ao carregar dados do painel")}finally{l(!1)}},N=async()=>{var j;try{const U={page:x,limit:10,...Object.fromEntries(Object.entries(v).filter(([Y,ee])=>ee))};console.log("📋 Carregando tickets admin com params:",U);const H=await _e.getAllTickets(U);if(console.log("📄 Resposta getAllTickets:",H),H&&H.data){const Y=H.data.data||H.data;t(Y.tickets||[]),k(Y.total_pages||1),console.log("✅ Tickets carregados:",((j=Y.tickets)==null?void 0:j.length)||0)}else console.error("❌ Estrutura de resposta inesperada:",H),t([])}catch(U){console.error("❌ Erro ao carregar tickets:",U),S.error("Erro ao carregar tickets"),t([])}},C=async()=>{try{console.log("📊 Carregando estatísticas...");const j=await _e.getAdminStats();if(console.log("📈 Resposta getAdminStats:",j),j&&j.data){const U=j.data.data||j.data;r(U),console.log("✅ Stats carregadas:",U)}}catch(j){console.error("❌ Erro ao carregar stats:",j)}},E=async(j,U)=>{var H,Y;i(!0);try{console.log("🔄 Atualizando ticket:",j,U);const ee=await _e.updateTicket(j,U);console.log("✅ Resultado da atualização:",ee),ee&&ee.data?(S.success("Ticket atualizado com sucesso"),g(!1),h(null),await N()):S.error("Erro ao atualizar ticket")}catch(ee){console.error("❌ Erro ao atualizar ticket:",ee),S.error(((Y=(H=ee.response)==null?void 0:H.data)==null?void 0:Y.message)||"Erro ao atualizar ticket")}finally{i(!1)}},$=j=>{h(j),A({status:j.status||"",priority:j.priority||"",admin_response:j.admin_response||""}),g(!0)},P=j=>{const U=new Set(p);U.has(j)?U.delete(j):U.add(j),R(U)},_=j=>{if(!j)return"Não disponível";try{return new Date(j).toLocaleString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return"Data inválida"}},L=j=>{if(!j)return"";try{const U=new Date(j),Y=new Date-U,ee=Math.floor(Y/(1e3*60*60)),ve=Math.floor(ee/24);if(ve>0)return`há ${ve} dia(s)`;if(ee>0)return`há ${ee} hora(s)`;{const Pe=Math.floor(Y/6e4);return`há ${Math.max(1,Pe)} minuto(s)`}}catch{return""}},V=j=>{switch(j){case"open":return"warning";case"in_progress":return"primary";case"resolved":return"success";case"closed":return"secondary";default:return"default"}},O=j=>{switch(j){case"open":return"Aberto";case"in_progress":return"Em Andamento";case"resolved":return"Resolvido";case"closed":return"Fechado";default:return j||"Desconhecido"}},D=j=>{switch(j){case"open":return e.jsx(ce,{className:"w-4 h-4"});case"in_progress":return e.jsx(pt,{className:"w-4 h-4"});case"resolved":return e.jsx(ge,{className:"w-4 h-4"});case"closed":return e.jsx(Qe,{className:"w-4 h-4"});default:return e.jsx(ye,{className:"w-4 h-4"})}},I=j=>{switch(j){case"low":return"secondary";case"medium":return"primary";case"high":return"warning";case"urgent":return"danger";default:return"default"}},G=j=>{switch(j){case"low":return"Baixa";case"medium":return"Média";case"high":return"Alta";case"urgent":return"Urgente";default:return j||"Não definida"}},Q=j=>{switch(j){case"general":return"Geral";case"technical":return"Técnico";case"billing":return"Pagamento";case"account":return"Conta";default:return j||"Não categorizado"}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando painel administrativo..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ie,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Painel de Suporte"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie tickets de suporte dos usuários"})]})]}),e.jsxs(F,{onClick:w,variant:"outline",disabled:n,children:[e.jsx(We,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Atualizar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total de Tickets"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:((re=a.tickets)==null?void 0:re.total)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(ce,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tickets Abertos"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:((M=a.tickets)==null?void 0:M.open)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(pt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Em Andamento"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((X=a.tickets)==null?void 0:X.in_progress)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ge,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Resolvidos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.filter(j=>j.status==="resolved").length})]})]})})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar tickets...",value:v.search,onChange:j=>b({...v,search:j.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:v.status,onChange:j=>b({...v,status:j.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Todos os Status"}),e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"in_progress",children:"Em Andamento"}),e.jsx("option",{value:"resolved",children:"Resolvido"}),e.jsx("option",{value:"closed",children:"Fechado"})]}),e.jsxs("select",{value:v.priority,onChange:j=>b({...v,priority:j.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Todas as Prioridades"}),e.jsx("option",{value:"low",children:"Baixa"}),e.jsx("option",{value:"medium",children:"Média"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]}),e.jsxs("select",{value:v.category,onChange:j=>b({...v,category:j.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Todas as Categorias"}),e.jsx("option",{value:"general",children:"Geral"}),e.jsx("option",{value:"technical",children:"Técnico"}),e.jsx("option",{value:"billing",children:"Pagamento"}),e.jsx("option",{value:"account",children:"Conta"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:Array.isArray(s)&&s.length>0?s.map(j=>{var U;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:j.subject||"Sem assunto"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[D(j.status),e.jsx(K,{variant:V(j.status||"open"),children:O(j.status||"open")})]}),e.jsxs(K,{variant:I(j.priority||"medium"),size:"sm",children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),G(j.priority||"medium")]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),((U=j.user)==null?void 0:U.username)||j.user_name||"Usuário desconhecido"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),_(j.created_at),j.created_at&&e.jsxs("span",{className:"text-gray-400 ml-2",children:["(",L(j.created_at),")"]})]}),j.protocol_number&&e.jsxs("span",{className:"flex items-center font-mono text-blue-600",children:[e.jsx(Vs,{className:"w-4 h-4 mr-1"}),j.protocol_number]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Gs,{className:"w-4 h-4 mr-1"}),Q(j.category||"general")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>P(j._id),children:p.has(j._id)?e.jsx(na,{className:"w-4 h-4"}):e.jsx(ma,{className:"w-4 h-4"})}),e.jsxs(F,{size:"sm",onClick:()=>$(j),children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Gerenciar"]})]})]}),e.jsx("div",{className:"border-l-4 border-gray-200 pl-4 mb-4",children:e.jsx("p",{className:"text-gray-700 line-clamp-2",children:j.message||"Sem mensagem"})}),p.has(j._id)&&e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Descrição Completa:"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:j.message||"Sem mensagem"})})]}),j.admin_response&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Resposta da Equipe:"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-800",children:j.admin_response}),j.resolved_at&&e.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:["Respondido em ",_(j.resolved_at)]})]})]}),j.additional_info&&j.additional_info.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Informações Adicionais do Usuário:"}),e.jsx("div",{className:"space-y-2",children:j.additional_info.map((H,Y)=>e.jsxs("div",{className:"bg-green-50 border border-green-200 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-800",children:H.message}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:_(H.created_at)})]},Y))})]})]})]},j._id)}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[e.jsx(ie,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Nenhum ticket encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Não há tickets que correspondam aos filtros selecionados."})]})}),m>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("div",{className:"flex space-x-2",children:Array.from({length:m},(j,U)=>U+1).map(j=>e.jsx("button",{onClick:()=>f(j),className:`px-4 py-2 rounded-lg ${x===j?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:j},j))})}),u&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Gerenciar Ticket"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Qe,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:c.subject}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Usuário:"}),e.jsx("span",{className:"ml-2 font-medium",children:((te=c.user)==null?void 0:te.username)||c.user_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Protocolo:"}),e.jsx("span",{className:"ml-2 font-medium font-mono",children:c.protocol_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Criado em:"}),e.jsx("span",{className:"ml-2",children:_(c.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Categoria:"}),e.jsx("span",{className:"ml-2",children:Q(c.category)})]})]})]}),e.jsxs("form",{onSubmit:j=>{j.preventDefault(),E(c._id,y)},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:y.status,onChange:j=>A(U=>({...U,status:j.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"in_progress",children:"Em Andamento"}),e.jsx("option",{value:"resolved",children:"Resolvido"}),e.jsx("option",{value:"closed",children:"Fechado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioridade"}),e.jsxs("select",{value:y.priority,onChange:j=>A(U=>({...U,priority:j.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"low",children:"Baixa"}),e.jsx("option",{value:"medium",children:"Média"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resposta da Equipe de Suporte"}),e.jsx("textarea",{value:y.admin_response,onChange:j=>A(U=>({...U,admin_response:j.target.value})),placeholder:"Digite sua resposta para o usuário...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"4",maxLength:"2000"}),e.jsxs("div",{className:"text-right text-xs text-gray-500 mt-1",children:[y.admin_response.length,"/2000 caracteres"]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>g(!1),className:"flex-1",disabled:o,children:"Cancelar"}),e.jsxs(F,{type:"submit",className:"flex-1",disabled:o,children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),o?"Atualizando...":"Atualizar Ticket"]})]})]})]})})})]})})},cl=()=>{xe();const s=be(),[t,a]=d.useState([]),[r,n]=d.useState(!0),[l,o]=d.useState("all"),[i,c]=d.useState(!1),[h,u]=d.useState(!1),[g,p]=d.useState(""),[R,x]=d.useState(""),[f,m]=d.useState({subject:"",message:"",category:"general",priority:"medium"});d.useEffect(()=>{k()},[]),d.useEffect(()=>{k()},[l]);const k=async()=>{n(!0);try{const D=await _e.getUserTickets({limit:50,skip:0,status:l==="all"?void 0:l});if(D.success){const I=D.data.tickets||D.data||[];a(Array.isArray(I)?I:[])}else S.error(D.message),a([])}catch(D){console.error("Erro ao carregar tickets:",D),S.error("Erro ao carregar tickets de suporte"),a([])}n(!1)},v=async D=>{D.preventDefault();const I=_e.validateTicketData(f);if(!I.isValid){S.error(I.errors[0]);return}u(!0);try{const G=await _e.createTicket(I.data);if(G.success){const Q=G.data.ticket||G.data;Q&&Q._id?a(M=>Array.isArray(M)?[Q,...M]:[Q]):(console.error("Invalid ticket structure:",Q),S.error("Erro na estrutura do ticket criado")),m({subject:"",message:"",category:"general",priority:"medium"}),c(!1);const re=Q.protocol_number?`Protocolo: ${Q.protocol_number}`:`ID: ${Q._id}`;S.success(`Ticket criado com sucesso! ${re}`)}else S.error(G.message)}catch(G){console.error("Erro ao criar ticket:",G),S.error("Erro ao criar ticket")}u(!1)},b=async()=>{if(!R.trim()){S.error("Digite um número de protocolo");return}n(!0);try{const D=await _e.getTicketByProtocol(R.trim());if(D.success){const I=D.data.ticket||D.data;a(I?[I]:[]),o("all"),p(""),S.success("Ticket encontrado!")}else S.error(D.message),a([])}catch{S.error("Erro ao buscar ticket"),a([])}n(!1)},y=()=>{x(""),p(""),k()},A=D=>{const I=D.protocol_number||D._id;s(`/support/ticket/${I}`)},w=D=>{s(`/support/ticket/${D.protocol_number||D._id}`)},N=D=>new Date(D).toLocaleString("pt-BR"),C=D=>{switch(D){case"open":return"warning";case"in_progress":return"primary";case"resolved":return"success";case"closed":return"secondary";default:return"default"}},E=D=>{switch(D){case"open":return"Aberto";case"in_progress":return"Em Andamento";case"resolved":return"Resolvido";case"closed":return"Fechado";default:return D}},$=D=>{switch(D){case"low":return"secondary";case"medium":return"primary";case"high":return"warning";case"urgent":return"danger";default:return"default"}},P=D=>{switch(D){case"low":return"Baixa";case"medium":return"Média";case"high":return"Alta";case"urgent":return"Urgente";default:return D}},_=D=>{switch(D){case"general":return"Geral";case"technical":return"Técnico";case"billing":return"Pagamento";case"account":return"Conta";default:return D}},L=Array.isArray(t)?t.filter(D=>{const I=l==="all"||D.status===l,G=!g||D.subject.toLowerCase().includes(g.toLowerCase())||D.message.toLowerCase().includes(g.toLowerCase());return I&&G}):[],O=(()=>Array.isArray(t)?{all:t.length,open:t.filter(D=>D.status==="open").length,in_progress:t.filter(D=>D.status==="in_progress").length,resolved:t.filter(D=>D.status==="resolved").length}:{all:0,open:0,in_progress:0,resolved:0})();return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(mr,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Central de Ajuda"}),e.jsx("p",{className:"text-gray-600",children:"Como podemos ajudar você hoje?"})]})]}),e.jsxs(F,{onClick:()=>c(!0),className:"flex items-center",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Novo Ticket"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(Gs,{className:"w-6 h-6 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-800",children:"FAQ"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"Encontre respostas para as perguntas mais comuns"}),e.jsx(F,{variant:"outline",size:"sm",children:"Ver FAQ"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(Be,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"font-semibold text-gray-800",children:"Email"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"Entre em contato diretamente por email"}),e.jsx(F,{variant:"outline",size:"sm",children:e.jsx("a",{href:"mailto:suporte@gameunite.com",children:"Enviar Email"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(vs,{className:"w-6 h-6 text-purple-600"}),e.jsx("h3",{className:"font-semibold text-gray-800",children:"WhatsApp"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"Suporte rápido via WhatsApp"}),e.jsx(F,{variant:"outline",size:"sm",children:e.jsx("a",{href:"https://wa.me/5511999999999",target:"_blank",rel:"noopener noreferrer",children:"Abrir Chat"})})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por protocolo (ex: SUP-2025-000123)",value:R,onChange:D=>x(D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{onClick:b,disabled:!R.trim()||r,size:"sm",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Buscar"]}),e.jsx(F,{variant:"outline",onClick:y,size:"sm",children:"Limpar"})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar tickets...",value:g,onChange:D=>p(D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"Todos",count:O.all},{key:"open",label:"Abertos",count:O.open},{key:"in_progress",label:"Em Andamento",count:O.in_progress},{key:"resolved",label:"Resolvidos",count:O.resolved}].map(D=>e.jsxs("button",{onClick:()=>o(D.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l===D.key?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[D.label," (",D.count,")"]},D.key))})]})]})}),e.jsx("div",{className:"space-y-4",children:L.length>0?L.map(D=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:D.subject||"Sem assunto"}),e.jsx(K,{variant:C(D.status||"open"),children:E(D.status||"open")}),e.jsx(K,{variant:$(D.priority||"medium"),size:"sm",children:P(D.priority||"medium")})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),D.created_at?N(D.created_at):"Data não disponível"]}),D.protocol_number&&e.jsxs("span",{className:"flex items-center font-mono",children:[e.jsx(Vs,{className:"w-4 h-4 mr-1"}),D.protocol_number]}),e.jsxs("span",{children:["#",D._id?D._id.slice(-6):"N/A"]}),e.jsx("span",{children:_(D.category||"general")})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:D.message||"Sem mensagem"})}),D.admin_response&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-blue-600 font-medium mb-1",children:["Resposta do Suporte",D.resolved_at&&e.jsxs("span",{className:"ml-2 text-xs",children:["• ",N(D.resolved_at)]})]}),e.jsx("p",{className:"text-gray-800",children:D.admin_response})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[D.status==="open"&&e.jsxs("span",{className:"flex items-center text-sm text-orange-600",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),"Aguardando resposta"]}),D.status==="in_progress"&&e.jsxs("span",{className:"flex items-center text-sm text-blue-600",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"Em análise"]}),D.status==="resolved"&&e.jsxs("span",{className:"flex items-center text-sm text-green-600",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Resolvido"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>A(D),children:"Ver Detalhes"}),D.status==="open"&&e.jsx(F,{size:"sm",onClick:()=>w(D),children:"Adicionar Informação"})]})]})]},D._id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:g?"Nenhum ticket encontrado":"Nenhum ticket ainda"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g?"Tente ajustar sua busca ou filtros":"Crie seu primeiro ticket de suporte"}),!g&&e.jsxs(F,{onClick:()=>c(!0),children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Criar Ticket"]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Criar Novo Ticket"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Se,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assunto *"}),e.jsx("input",{type:"text",value:f.subject,onChange:D=>m(I=>({...I,subject:D.target.value})),placeholder:"Descreva brevemente o problema",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),e.jsxs("select",{value:f.category,onChange:D=>m(I=>({...I,category:D.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"general",children:"Geral"}),e.jsx("option",{value:"technical",children:"Técnico"}),e.jsx("option",{value:"billing",children:"Pagamento"}),e.jsx("option",{value:"account",children:"Conta"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioridade"}),e.jsxs("select",{value:f.priority,onChange:D=>m(I=>({...I,priority:D.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"low",children:"Baixa"}),e.jsx("option",{value:"medium",children:"Média"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"urgent",children:"Urgente"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição *"}),e.jsx("textarea",{value:f.message,onChange:D=>m(I=>({...I,message:D.target.value})),placeholder:"Descreva o problema com detalhes...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"6",required:!0})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>c(!1),className:"flex-1",disabled:h,children:"Cancelar"}),e.jsxs(F,{type:"submit",className:"flex-1",disabled:h,children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),h?"Criando...":"Criar Ticket"]})]})]})]})})})]})})},dl=()=>{const{ticketId:s}=ts(),t=be();xe();const[a,r]=d.useState(null),[n,l]=d.useState(!0),[o,i]=d.useState(!1),[c,h]=d.useState(""),[u,g]=d.useState(!1);d.useEffect(()=>{p()},[s]);const p=async()=>{var E,$;l(!0);try{let P;if(console.log("🔍 Carregando ticket:",s),s.startsWith("SUP-")?(console.log("📋 Buscando por protocolo"),P=await _e.getTicketByProtocol(s)):(console.log("📋 Buscando por ID"),P=await _e.getTicketById(s)),console.log("📄 Resultado da busca:",P),P.success){const _=P.data.ticket||P.data;console.log("🎯 Ticket carregado:",_),r(_)}else console.error("❌ Erro ao carregar ticket:",P.message),S.error(P.message||"Ticket não encontrado"),t("/support")}catch(P){console.error("❌ Erro no carregamento:",P),((E=P.response)==null?void 0:E.status)===429?S.error("Muitas requisições. Aguarde um momento e tente novamente."):(($=P.response)==null?void 0:$.status)===404?S.error("Ticket não encontrado"):S.error("Erro ao carregar detalhes do ticket"),t("/support")}l(!1)},R=E=>{if(!E)return"Não disponível";try{return new Date(E).toLocaleString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"Data inválida"}},x=E=>{if(!E)return"";try{const $=new Date(E),_=new Date-$,L=Math.floor(_/(1e3*60*60)),V=Math.floor(L/24);if(V>0)return`há ${V} dia(s)`;if(L>0)return`há ${L} hora(s)`;{const O=Math.floor(_/6e4);return`há ${Math.max(1,O)} minuto(s)`}}catch{return""}},f=E=>{switch(E){case"open":return"warning";case"in_progress":return"primary";case"resolved":return"success";case"closed":return"secondary";default:return"default"}},m=E=>{switch(E){case"open":return"Aberto";case"in_progress":return"Em Andamento";case"resolved":return"Resolvido";case"closed":return"Fechado";default:return E||"Desconhecido"}},k=E=>{switch(E){case"open":return e.jsx(ce,{className:"w-4 h-4"});case"in_progress":return e.jsx(pt,{className:"w-4 h-4"});case"resolved":return e.jsx(da,{className:"w-4 h-4"});case"closed":return e.jsx(Qe,{className:"w-4 h-4"});default:return e.jsx(ye,{className:"w-4 h-4"})}},v=E=>{switch(E){case"low":return"secondary";case"medium":return"primary";case"high":return"warning";case"urgent":return"danger";default:return"default"}},b=E=>{switch(E){case"low":return"Baixa";case"medium":return"Média";case"high":return"Alta";case"urgent":return"Urgente";default:return E||"Não definida"}},y=E=>{switch(E){case"general":return"Geral";case"technical":return"Técnico";case"billing":return"Pagamento";case"account":return"Conta";default:return E||"Não categorizado"}},A=E=>{switch(E){case"general":return e.jsx(gt,{className:"w-4 h-4"});case"technical":return e.jsx(Ie,{className:"w-4 h-4"});case"billing":return e.jsx(Gs,{className:"w-4 h-4"});case"account":return e.jsx(Z,{className:"w-4 h-4"});default:return e.jsx(ie,{className:"w-4 h-4"})}},w=async()=>{if(!c.trim()){S.error("Digite uma mensagem");return}if(c.trim().length<5){S.error("A mensagem deve ter pelo menos 5 caracteres");return}i(!0);try{console.log("📤 Enviando resposta para ticket:",a._id);const E=await _e.addTicketReply(a._id,c.trim());console.log("📨 Resultado do envio:",E),E.success?(S.success("Informação adicionada com sucesso"),h(""),g(!1),await p()):S.error(E.message||"Erro ao adicionar informação")}catch(E){console.error("❌ Erro ao adicionar resposta:",E),S.error("Erro ao adicionar informação")}i(!1)},N=()=>{S.info("Atualizando ticket..."),p()};if(n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando detalhes do ticket..."})]})});if(!a)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ie,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Ticket não encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"O ticket solicitado não existe ou você não tem permissão para visualizá-lo."}),e.jsx(F,{onClick:()=>t("/support"),children:"Voltar ao Suporte"})]})});const C=a.status==="open"||a.status==="in_progress";return a.status==="resolved"||a.status,e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(F,{variant:"outline",onClick:()=>t("/support"),children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Voltar ao Suporte"]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:N,disabled:n,children:[e.jsx(We,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Atualizar"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-3",children:a.subject||"Sem assunto"}),e.jsxs("div",{className:"flex items-center flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[k(a.status),e.jsx(K,{variant:f(a.status||"open"),children:m(a.status||"open")})]}),e.jsxs(K,{variant:v(a.priority||"medium"),size:"sm",children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),b(a.priority||"medium")]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[A(a.category),e.jsx("span",{className:"ml-1",children:y(a.category||"general")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Criado em ",R(a.created_at),a.created_at&&e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",x(a.created_at),")"]})]})]}),a.protocol_number&&e.jsxs("div",{className:"flex items-center font-mono",children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium",children:a.protocol_number})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Gs,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["ID: #",a._id?a._id.slice(-8):"N/A"]})]}),a.updated_at&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Atualizado ",x(a.updated_at)]})]})]})]}),e.jsx("div",{className:"flex flex-col space-y-2 ml-4",children:C&&e.jsxs(F,{size:"sm",onClick:()=>g(!u),className:u?"bg-gray-600":"",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),u?"Cancelar":"Adicionar Info"]})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 mr-2 text-blue-600"}),"Descrição do Problema"]}),e.jsx("div",{className:"bg-gray-50 border-l-4 border-blue-500 p-4 rounded-r-lg",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed",children:a.message||"Nenhuma descrição fornecida."})})]}),a.admin_response&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Ie,{className:"w-5 h-5 mr-2 text-blue-600"}),"Resposta da Equipe de Suporte"]}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 rounded-r-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Ie,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-blue-700 font-medium mb-2",children:["Equipe de Suporte",a.resolved_at&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-100 px-2 py-1 rounded",children:["Respondido em ",R(a.resolved_at)]})]}),e.jsx("p",{className:"text-gray-800 leading-relaxed",children:a.admin_response})]})]})})]}),a.additional_info&&a.additional_info.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(ys,{className:"w-5 h-5 mr-2 text-green-600"}),"Informações Adicionais",e.jsxs("span",{className:"ml-2 text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:[a.additional_info.length," mensagem(ns)"]})]}),e.jsx("div",{className:"space-y-4",children:a.additional_info.map((E,$)=>e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 rounded-r-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-green-700 font-medium mb-1",children:["Você • ",R(E.created_at),e.jsxs("span",{className:"text-green-600 ml-2",children:["(",x(E.created_at),")"]})]}),e.jsx("p",{className:"text-gray-800 leading-relaxed",children:E.message})]})]})},$))})]}),u&&C&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Je,{className:"w-5 h-5 mr-2 text-blue-600"}),"Adicionar Informação"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descreva informações adicionais sobre seu problema:"}),e.jsx("textarea",{value:c,onChange:E=>h(E.target.value),placeholder:"Forneça mais detalhes, capturas de tela que podem ajudar, ou atualizações sobre o problema...",className:"w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-vertical",rows:"5",maxLength:"1000"}),e.jsxs("div",{className:"text-right text-xs text-gray-500 mt-1",children:[c.length,"/1000 caracteres"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(F,{onClick:w,disabled:o||!c.trim()||c.trim().length<5,children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),o?"Enviando...":"Enviar Informação"]}),e.jsx(F,{variant:"outline",onClick:()=>{g(!1),h("")},disabled:o,children:"Cancelar"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(gt,{className:"w-5 h-5 mr-2 text-purple-600"}),"Informações do Ticket"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Status atual:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[k(a.status),e.jsx("span",{className:`font-medium ${a.status==="open"?"text-orange-600":a.status==="in_progress"?"text-blue-600":a.status==="resolved"?"text-green-600":"text-gray-600"}`,children:m(a.status)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Prioridade:"}),e.jsx(K,{variant:v(a.priority),children:b(a.priority)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Categoria:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[A(a.category),e.jsx("span",{className:"text-gray-800",children:y(a.category)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Criado em:"}),e.jsx("span",{className:"text-gray-800 text-sm",children:R(a.created_at)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Última atualização:"}),e.jsx("span",{className:"text-gray-800 text-sm",children:R(a.updated_at)})]}),a.resolved_at&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Resolvido em:"}),e.jsx("span",{className:"text-green-800 text-sm",children:R(a.resolved_at)})]})]})]}),e.jsx("div",{className:`mt-6 p-4 rounded-lg border-l-4 ${a.status==="open"?"bg-orange-50 border-orange-500":a.status==="in_progress"?"bg-blue-50 border-blue-500":a.status==="resolved"?"bg-green-50 border-green-500":"bg-gray-50 border-gray-500"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${a.status==="open"?"bg-orange-500":a.status==="in_progress"?"bg-blue-500":a.status==="resolved"?"bg-green-500":"bg-gray-500"}`,children:k(a.status)}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:`text-sm ${a.status==="open"?"text-orange-800":a.status==="in_progress"?"text-blue-800":a.status==="resolved"?"text-green-800":"text-gray-800"}`,children:[a.status==="open"&&"Seu ticket foi recebido e está aguardando análise da nossa equipe de suporte. Você será notificado quando houver atualizações.",a.status==="in_progress"&&"Nossa equipe está analisando seu problema e trabalhando em uma solução. Mantenha-se atento para atualizações.",a.status==="resolved"&&"Seu ticket foi resolvido pela nossa equipe. Se o problema persistir, você pode adicionar mais informações ou criar um novo ticket.",a.status==="closed"&&"Este ticket foi fechado. Se você precisar de mais ajuda, crie um novo ticket de suporte."]})})]})})]})]})]})})},ml=()=>{const{user:s,isAuthenticated:t}=xe(),[a,r]=d.useState([]),[n,l]=d.useState(!0),[o,i]=d.useState("all"),[c,h]=d.useState({});d.useEffect(()=>{t&&u()},[t]);const u=async()=>{l(!0);try{const b=[{id:1,type:"question",title:"Nova pergunta no seu anúncio",message:'João perguntou: "O jogo está funcionando perfeitamente?"',timestamp:new Date(Date.now()-3e5),read:!1,data:{ad_id:"123",ad_title:"Counter-Strike 2",user_name:"João"}},{id:2,type:"order",title:"Pedido entregue",message:'Seu pedido "Valorant" foi marcado como entregue',timestamp:new Date(Date.now()-72e5),read:!1,data:{order_id:"456",product_title:"Valorant"}},{id:3,type:"favorite",title:"Anúncio favoritado",message:'Maria favoritou seu anúncio "League of Legends"',timestamp:new Date(Date.now()-864e5),read:!0,data:{ad_id:"789",ad_title:"League of Legends",user_name:"Maria"}},{id:4,type:"system",title:"Anúncio aprovado",message:'Seu anúncio "Minecraft" foi aprovado e está visível',timestamp:new Date(Date.now()-1728e5),read:!0,data:{ad_id:"101",ad_title:"Minecraft"}}];r(b)}catch(b){console.error("Erro ao carregar notificações:",b),S.error("Erro ao carregar notificações")}l(!1)},g=b=>{const A=new Date-b,w=Math.floor(A/6e4),N=Math.floor(w/60),C=Math.floor(N/24);return C>0?`${C} dia${C>1?"s":""} atrás`:N>0?`${N} hora${N>1?"s":""} atrás`:w>0?`${w} minuto${w>1?"s":""} atrás`:"Agora mesmo"},p=b=>{switch(b){case"question":return"💬";case"order":return"📦";case"favorite":return"❤️";case"system":return"🔔";default:return"📢"}},R=b=>{switch(b){case"question":return"bg-blue-100 text-blue-600";case"order":return"bg-green-100 text-green-600";case"favorite":return"bg-red-100 text-red-600";case"system":return"bg-gray-100 text-gray-600";default:return"bg-blue-100 text-blue-600"}},x=async b=>{h(y=>({...y,[b]:!0}));try{await new Promise(y=>setTimeout(y,500)),r(y=>y.map(A=>A.id===b?{...A,read:!0}:A)),S.success("Notificação marcada como lida")}catch{S.error("Erro ao marcar como lida")}h(y=>({...y,[b]:!1}))},f=async()=>{l(!0);try{await new Promise(b=>setTimeout(b,1e3)),r(b=>b.map(y=>({...y,read:!0}))),S.success("Todas as notificações foram marcadas como lidas")}catch{S.error("Erro ao marcar todas como lidas")}l(!1)},m=async b=>{h(y=>({...y,[b]:!0}));try{await new Promise(y=>setTimeout(y,500)),r(y=>y.filter(A=>A.id!==b)),S.success("Notificação removida")}catch{S.error("Erro ao remover notificação")}h(y=>({...y,[b]:!1}))},k=a.filter(b=>o==="unread"?!b.read:o==="read"?b.read:!0),v=a.filter(b=>!b.read).length;return t?n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ye,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Notificações"}),e.jsx("p",{className:"text-gray-600",children:v>0?`${v} não lida${v>1?"s":""}`:"Todas lidas"})]})]}),v>0&&e.jsxs(F,{onClick:f,disabled:n,children:[e.jsx(ur,{className:"w-4 h-4 mr-2"}),"Marcar todas como lidas"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="all"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:["Todas (",a.length,")"]}),e.jsxs("button",{onClick:()=>i("unread"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="unread"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:["Não lidas (",v,")"]}),e.jsxs("button",{onClick:()=>i("read"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="read"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:["Lidas (",a.length-v,")"]})]})]}),e.jsx("div",{className:"space-y-4",children:k.length>0?k.map(b=>e.jsx("div",{className:`bg-white rounded-lg shadow-md p-6 transition-all hover:shadow-lg ${b.read?"":"border-l-4 border-blue-500"}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${R(b.type)}`,children:e.jsx("span",{className:"text-lg",children:p(b.type)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:b.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!b.read&&e.jsx("button",{onClick:()=>x(b.id),disabled:c[b.id],className:"p-1 text-blue-600 hover:text-blue-800 transition-colors",title:"Marcar como lida",children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(b.id),disabled:c[b.id],className:"p-1 text-red-600 hover:text-red-800 transition-colors",title:"Remover notificação",children:e.jsx(Re,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:b.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:g(b.timestamp)}),!b.read&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Nova"})]})]})]})},b.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ye,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:o==="unread"?"Nenhuma notificação não lida":o==="read"?"Nenhuma notificação lida":"Nenhuma notificação"}),e.jsx("p",{className:"text-gray-600",children:o==="all"?"Você não tem notificações ainda":"Altere o filtro para ver outras notificações"})]})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Acesso Restrito"}),e.jsx("p",{className:"text-gray-600",children:"Faça login para ver suas notificações"})]})})},fe=({children:s,requireAdmin:t=!1})=>{const{isAuthenticated:a,loading:r,user:n}=xe();return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):a?t&&(!n||!["admin","support"].includes(n.role))?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Você não tem permissão para acessar esta página."}),e.jsx(zt,{to:"/",replace:!0})]})}):s:e.jsx(zt,{to:"/login",replace:!0})};function ul(){return e.jsx(ao,{children:e.jsx(ro,{children:e.jsxs(no,{children:[" ",e.jsx(Za,{children:e.jsxs("div",{className:"App",children:[e.jsxs(Ya,{children:[e.jsx(ae,{path:"/",element:e.jsx(ne,{children:e.jsx(co,{})})}),e.jsx(ae,{path:"/games",element:e.jsx(ne,{children:e.jsx(mo,{})})}),e.jsx(ae,{path:"/games/:gameId",element:e.jsx(ne,{children:e.jsx(uo,{})})}),e.jsx(ae,{path:"/ads/:adId",element:e.jsx(ne,{children:e.jsx(_o,{})})}),e.jsx(ae,{path:"/users/:userId",element:e.jsx(ne,{children:e.jsx(So,{})})}),e.jsx(ae,{path:"/login",element:e.jsx(xo,{})}),e.jsx(ae,{path:"/register",element:e.jsx(ho,{})}),e.jsx(ae,{path:"/dashboard",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(po,{})})})}),e.jsx(ae,{path:"/profile",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(jo,{})})})}),e.jsx(ae,{path:"/favorites",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(Co,{})})})}),e.jsx(ae,{path:"/cart",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(ko,{})})})}),e.jsx(ae,{path:"/checkout",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(Eo,{})})})}),e.jsx(ae,{path:"/orders",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(Ao,{})})})}),e.jsx(ae,{path:"/orders/:orderId",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(Do,{})})})}),e.jsx(ae,{path:"/create-ad",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(bo,{})})})}),e.jsx(ae,{path:"/ads/:adId/edit",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(yo,{})})})}),e.jsx(ae,{path:"/support",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(cl,{})})})}),e.jsx(ae,{path:"/support/ticket/:ticketId",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(dl,{})})})}),e.jsx(ae,{path:"/notifications",element:e.jsx(fe,{children:e.jsx(ne,{children:e.jsx(ml,{})})})}),e.jsx(ae,{path:"/admin",element:e.jsx(fe,{requireAdmin:!0,children:e.jsx(ne,{children:e.jsx(Yo,{})})})}),e.jsx(ae,{path:"/admin/support",element:e.jsx(fe,{requireAdmin:!0,children:e.jsx(ne,{children:e.jsx(il,{})})})}),e.jsx(ae,{path:"*",element:e.jsx(ne,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"404"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Página não encontrada"}),e.jsx("a",{href:"/",className:"text-blue-600 hover:text-blue-800",children:"Voltar para o início"})]})})})})]}),e.jsx(er,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})]})})})}ft.createRoot(document.getElementById("root")).render(e.jsx(ul,{}));
//# sourceMappingURL=index-b685fa53.js.map
